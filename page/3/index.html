<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Yancy&#39;s blog</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="Yancy&#39;s blog" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link">Home</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/archives" class="header__link">ARCHIVES</a>
			
				<a href="/about/About" class="header__link">ABOUT</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Yancy&#39;s blog</a></h1>
		<h2 class="header__subtitle">SIMPLICITY IS PREREQUISITE FOR  RELIABILITY</h2>
	</header>

	<main>
		
	<span class="different-posts different-posts_earlier">ğŸ“– <a href="/page/2">earlier posts</a> ğŸ“–</span>




	<article>
	
		<h1><a href="/2017/04/27/Bigdata-hadoop/zookeeper/Bigdata-Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜ /">Bigdata-Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-04-27</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata/">Bigdata</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/ZooKeeper/">ZooKeeper</a>
			</span>
		
	</div>

	

	
		<h4 id="Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜"><a href="#Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜" class="headerlink" title="Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜"></a>Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜</h4><h3 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h3><p>æ­å»ºzookeeperå’Œkafkaé›†ç¾¤è¿è¡Œå¤§æ•°æ®å¤„ç†æ•°æ®æ¶ˆè´¹ï¼Œå…¬å¸dubboä½¿ç”¨zookeeperåšæœåŠ¡ç«¯çš„æœåŠ¡å‘ç°ç®¡ç†åŠé…ç½®ä¸­å¿ƒï¼Œåœ¨ä½¿ç”¨æ—¶éƒ½å‡ºç°è¿‡ç”±äºzkçš„æ—¥å¿—å¤§å°è¿‡å¤§å¡æ»¡ç£ç›˜çš„æƒ…å†µ ï¼Œé‡åˆ°äº†Zookeeperæ—¥å¿—é—®é¢˜è¾“å‡ºè·¯å¾„çš„é—®é¢˜, å‘ç°zookeeperè®¾ç½®log4j.propertiesä¸èƒ½è§£å†³æ—¥å¿—è·¯å¾„é—®é¢˜, å‘ç°è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ã€‚</p>
<h3 id="zookeeperæ—¥å¿—è¯´æ˜"><a href="#zookeeperæ—¥å¿—è¯´æ˜" class="headerlink" title="zookeeperæ—¥å¿—è¯´æ˜"></a>zookeeperæ—¥å¿—è¯´æ˜</h3><p>ZooKeeperä½¿ç”¨<code>SLF4J(the Simple Logging Facade for Java)</code>ä½œä¸ºæ—¥å¿—çš„æŠ½è±¡å±‚ï¼Œé»˜è®¤ä½¿ç”¨<code>Log4J</code>æ¥åšå®é™…çš„æ—¥å¿—å·¥ä½œã€‚ä½¿ç”¨2å±‚æ—¥å¿—æŠ½è±¡çœ‹èµ·æ¥çœŸæ˜¯å¤Ÿå‘›ï¼Œè¿™é‡Œç®€è¦çš„è¯´æ˜å¦‚ä½•æ¥é…ç½®<code>Log4J</code>ã€‚å°½ç®¡Log4Jéå¸¸çµæ´»ä¸”å¼ºå¤§ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›å¤æ‚ï¼Œå¯ä»¥ç”¨ä¸€æ•´æœ¬ä¹¦æ¥æè¿°å®ƒï¼Œè¿™é‡Œåªæ˜¯ç®€è¦çš„ä»‹ç»ä¸€ä¸‹åŸºæœ¬çš„ç”¨æ³•ã€‚</p>
<p>Log4Jçš„é…ç½®æ–‡ä»¶åä¸º<code>log4j.properties</code>ï¼Œä»classpathä¸­æŸ¥æ‰¾ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°log4j.propertiesæ–‡ä»¶ï¼Œä¼šè¾“å‡ºå¦‚ä¸‹è­¦å‘Šä¿¡æ¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">log</span>4j:WARN No appenders could be found <span class="keyword">for</span> logger (org.apache.zookeeper.serv ...  </div><div class="line"><span class="built_in">log</span>4j:WARN Please initialize the <span class="built_in">log</span>4j system properly.</div></pre></td></tr></table></figure>
<p>å®ƒè¯´çš„æ˜¯æ‰€æœ‰åç»­çš„æ—¥å¿—æ¶ˆæ¯ä¼šè¢«ä¸¢å¼ƒï¼Œé€šå¸¸<code>log4j.properties</code>æ–‡ä»¶ä¼šæ”¾åœ¨<code>conf</code>æ–‡ä»¶å¤¹ï¼Œå¹¶æ”¾åœ¨<code>classpath</code>ä¸‹ã€‚<br>æ¥çœ‹çœ‹<code>ZooKeeper</code>ä½¿ç”¨çš„<code>log4j.properties</code>çš„ä¸»è¦éƒ¨åˆ†ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">[jollybi@kafka2 conf]$ cat <span class="built_in">log</span>4j.properties | grep -Pv <span class="string">"^$|^#"</span></div><div class="line">zookeeper.root.logger=INFO, CONSOLE  <span class="comment">#ï¼ˆ1ï¼‰</span></div><div class="line">zookeeper.console.threshold=INFO</div><div class="line">zookeeper.log.dir=.</div><div class="line">zookeeper.log.file=zookeeper.log</div><div class="line">zookeeper.log.threshold=DEBUG</div><div class="line">zookeeper.tracelog.dir=.                                                                     </div><div class="line">zookeeper.tracelog.file=zookeeper_trace.log</div><div class="line"><span class="built_in">log</span>4j.rootLogger=<span class="variable">$&#123;zookeeper.root.logger&#125;</span> <span class="comment">#ï¼ˆ2ï¼‰</span></div><div class="line"><span class="built_in">log</span>4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender  <span class="comment">#ï¼ˆ3ï¼‰</span></div><div class="line"><span class="built_in">log</span>4j.appender.CONSOLE.Threshold=<span class="variable">$&#123;zookeeper.console.threshold&#125;</span> <span class="comment">#ï¼ˆ4ï¼‰</span></div><div class="line"><span class="built_in">log</span>4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout <span class="comment">#ï¼ˆ5ï¼‰</span></div><div class="line"><span class="built_in">log</span>4j.appender.CONSOLE.layout.ConversionPattern=%d&#123;ISO8601&#125; [myid:%X&#123;myid&#125;] - %-5p [%t:%C&#123;1&#125;@%L] - %m%n</div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE=org.apache.log4j.RollingFileAppender <span class="comment">#ï¼ˆ6ï¼‰</span></div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE.Threshold=<span class="variable">$&#123;zookeeper.log.threshold&#125;</span> <span class="comment">#ï¼ˆ7ï¼‰</span></div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE.File=<span class="variable">$&#123;zookeeper.log.dir&#125;</span>/<span class="variable">$&#123;zookeeper.log.file&#125;</span></div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE.MaxFileSize=10MB</div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE.layout=org.apache.log4j.PatternLayout</div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE.layout.ConversionPattern=%d&#123;ISO8601&#125; [myid:%X&#123;myid&#125;] - %-5p [%t:%C&#123;1&#125;@%L] - %m%n</div><div class="line"><span class="built_in">log</span>4j.appender.TRACEFILE=org.apache.log4j.FileAppender</div><div class="line"><span class="built_in">log</span>4j.appender.TRACEFILE.Threshold=TRACE</div><div class="line"><span class="built_in">log</span>4j.appender.TRACEFILE.File=<span class="variable">$&#123;zookeeper.tracelog.dir&#125;</span>/<span class="variable">$&#123;zookeeper.tracelog.file&#125;</span></div><div class="line"><span class="built_in">log</span>4j.appender.TRACEFILE.layout=org.apache.log4j.PatternLayout</div><div class="line"><span class="built_in">log</span>4j.appender.TRACEFILE.layout.ConversionPattern=%d&#123;ISO8601&#125; [myid:%X&#123;myid&#125;] - %-5p [%t:%C&#123;1&#125;@%L][%x] - %m%n</div></pre></td></tr></table></figure>
<ul>
<li><p>(1) <code>zookeeper.root.logger=INFO, CONSOLE</code><br>ç¬¬ä¸€ç»„è®¾ç½®ä»¥<code>zookeeper</code>å¼€å¤´ï¼Œå®ƒä»¬å®é™…ä¸Šæ˜¯<code>Java system property</code>ï¼Œå¯ä»¥è¢«<code>-D</code>å½¢å¼çš„å‘½ä»¤è¡Œå‚æ•°è¦†ç›–ã€‚<br>ç¬¬ä¸€è¡Œé…ç½®äº†æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤çš„è®¾ç½®æ˜¯è¯´åœ¨INFOçº§åˆ«ä»¥ä¸‹çš„æ—¥å¿—ä¼šè¢«ä¸¢å¼ƒï¼Œå¹¶ä¸”æ—¥å¿—ä¼šä½¿ç”¨<code>CONSOLE appender</code>è¾“å‡ºã€‚ä½ å¯ä»¥æŒ‡å®šå¤šä¸ª<code>appender</code>ï¼Œä¾‹å¦‚å¦‚æœä½ æƒ³ä½¿ç”¨<code>CONSOLE appender</code>å’Œ<code>ROLLINGFILE appender</code>è¾“å‡ºæ—¥å¿—ï¼Œé‚£ä¹ˆå¯ä»¥é…ç½®<code>zookeeper.logger</code>ä¸º<code>INFO,CONSOLE,ROLLINGFILE</code>ã€‚</p>
</li>
<li><p>(2) <code>rootLogger</code>å¤„ç†æ‰€æœ‰æ—¥å¿—çš„<code>logger</code>ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å®šä¹‰å…¶ä»–<code>logger</code>ã€‚</p>
</li>
<li><p>(3) <code>log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</code>è¿™ä¸€è¡ŒæŠŠCONSOLE appenderå’Œå®é™…ä¸Šå¤„ç†æ—¥å¿—è¾“å‡ºçš„ç±»ç»‘å®šåœ¨ä¸€èµ·ï¼Œè¿™é‡Œæ˜¯ConsoleAppenderç±»ã€‚</p>
</li>
<li><p>(4) <code>appender</code>ä¹Ÿå¯ä»¥è¿‡æ»¤æ—¥å¿—ã€‚è¿™ä¸€è¡Œå°†è¿‡æ»¤ä»»ä½•åœ¨INFOçº§åˆ«ä¹‹ä¸‹çš„æ—¥å¿—ï¼Œå› ä¸ºè¿™æ˜¯åœ¨<code>zookeeper.root.loggerè®¾ç½®çš„threshold</code>ã€‚</p>
</li>
<li><p>(5) <code>appender</code>ä½¿ç”¨ä¸€ä¸ªå¸ƒå±€(layout)ç±»åœ¨è¾“å‡ºå‰å¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ–ã€‚æˆ‘ä»¬ä½¿ç”¨pattern layoutæ¥è®°å½•æ—¥å¿—çš„çº§åˆ«ï¼Œæ—¥æœŸï¼Œçº¿ç¨‹ä¿¡æ¯å’Œè°ƒç”¨ä½ç½®ä¿¡æ¯ä»¥åŠæ¶ˆæ¯æœ¬èº«ã€‚</p>
</li>
<li><p>(6) RollingFileAppenderå®ç°äº†rollingæ—¥å¿—æ–‡ä»¶çš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯æŒç»­çš„å†™åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶æˆ–è€…æ§åˆ¶å°ã€‚å¦‚æœrootLoggeræ²¡æœ‰å…³è”ROLLINGFILEï¼Œåˆ™æ­¤appenderä¼šè¢«å¿½ç•¥ã€‚</p>
</li>
<li><p>(7) <code>ROLLINGFILE</code>çš„thresholdè®¾ç½®æˆ<code>DEBUG</code>ã€‚å› ä¸º<code>rootLogger</code>è¿‡æ»¤äº†æ‰€æœ‰åœ¨<code>INFO</code>çº§åˆ«ä¹‹ä¸‹çš„æ—¥å¿—ï¼Œæ²¡æœ‰DEBUGæ—¥å¿—ä¼šè¾“å‡ºåˆ°<code>ROLLINGFILE</code>ã€‚å¦‚æœä½ æƒ³è¦çœ‹åˆ°<code>DEBUG</code>æ—¥å¿—ï¼Œä½ å¿…é¡»æŠŠ<code>zookeeper.root.logger</code>ä»<code>INFOæ”¹æˆDEBUG</code>ã€‚</p>
</li>
</ul>
<p>æ‰“æ—¥å¿—ä¼šå½±å“åˆ°è¿›ç¨‹çš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨DEBUGçº§åˆ«ä¸‹ã€‚åŒæ—¶æ—¥å¿—ä¼šæä¾›æœ‰ä»·å€¼çš„ä¿¡æ¯ä¸ºè¯Šæ–­é”™è¯¯æä¾›çº¿ç´¢ã€‚ä¸€ä¸ªå¹³è¡¡æ€§èƒ½å¼€é”€çš„æœ‰æ•ˆæ–¹å¼æ˜¯æŠŠappenderçš„thresholdè®¾æˆDEBUGï¼Œå¹¶æŠŠrootLoggerè®¾æˆWARNçº§åˆ«ï¼Œè¿™åœ¨ä¸€èˆ¬çš„æƒ…å†µéƒ½é€‚ç”¨ï¼Œä¸€èˆ¬åªéœ€è¦å…³æ³¨WARNINGå’Œå®ƒä¹‹ä¸Šçš„æ—¥å¿—ã€‚å½“ä½ éœ€è¦è¯Šæ–­é—®é¢˜æ—¶å¯ä»¥ä½¿ç”¨JMXåŠ¨æ€è®¾ç½®ä¸ºINFOæˆ–DEBUGçº§åˆ«ï¼Œè¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿å®šä½é—®é¢˜ã€‚</p>
<h3 id="ä¿®æ”¹æ—¥å¿—è¾“å‡ºç›®å½•"><a href="#ä¿®æ”¹æ—¥å¿—è¾“å‡ºç›®å½•" class="headerlink" title="ä¿®æ”¹æ—¥å¿—è¾“å‡ºç›®å½•"></a>ä¿®æ”¹æ—¥å¿—è¾“å‡ºç›®å½•</h3><p>ä¹‹å‰å‡ºç°<code>zookeeper</code>åœ¨binç›®å½•ä¸‹å‡ºç°äº†<code>zookeeper.out</code>çš„æ—¥å¿—æ–‡ä»¶ï¼Œç»åˆ†æå‘ç°æ­¤æ–‡ä»¶æ˜¯ç”±äº<code>nohup</code>å‘½ä»¤æ‰“å°çš„æ§åˆ¶å°æ—¥å¿—ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨<code>zoo.cfg</code>é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯¹æ—¥å¿—æ–‡ä»¶è¿›è¡Œäº†é…ç½®ï¼ˆæˆªå–éƒ¨åˆ†ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">dataDir=/data/tools/zookeeper-3.4.5/tmp</div><div class="line">dataLogDir=/data/tools/zookeeper-3.4.5/tmp/logs</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>dataDirå’ŒdataLogDir</code>æ˜¯é’ˆå¯¹æ•°æ®ä¿¡æ¯åŠæ•°æ®ä¿¡æ¯æ—¥å¿—çš„ä½ç½®é…ç½®ã€‚ä½†æ˜¯åœ¨zookeeperå†…éƒ¨é›†æˆäº†<code>log4j.properties</code>ï¼ˆå¯¹åº”é…ç½®æ–‡ä»¶åœ¨confè·¯å¾„ä¸‹ï¼‰ã€‚</p>
<h3 id="å‚è€ƒlog4jé…ç½®è¯´æ˜"><a href="#å‚è€ƒlog4jé…ç½®è¯´æ˜" class="headerlink" title="å‚è€ƒlog4jé…ç½®è¯´æ˜"></a>å‚è€ƒlog4jé…ç½®è¯´æ˜</h3><p>æ‰“å¼€<code>log4j.properties</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°æœ‰è¿™æ ·çš„é…ç½®ï¼Œå®ƒåœ¨è¯´æ˜å…³äº<code>zookeeper</code>æœ¬èº«çš„ä¸€äº›é»˜è®¤è®¾ç½®ï¼Œä½†æ˜¯å¯ä»¥è¢«ç³»ç»Ÿé…ç½®æ–‡ä»¶æ‰€è¦†ç›–ã€‚é‚£ä¹ˆï¼Œåœ¨<code>log4j</code>ä¸­ï¼Œ<code>rootæ˜¯log4j</code>è®°å½•çš„åŸå§‹èµ·ç‚¹ï¼Œè€Œè¿™éƒ¨åˆ†å‚æ•°åˆå¯ä»¥è¢«ç³»ç»Ÿä¿®æ”¹ï¼Œé‚£ä¹ˆç³»ç»Ÿé…ç½®åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Define some default values that can be overridden by system properties</span></div><div class="line">zookeeper.root.logger=INFO, CONSOLE</div><div class="line">zookeeper.console.threshold=INFO</div><div class="line">zookeeper.log.dir=.</div><div class="line">zookeeper.log.file=zookeeper.log</div><div class="line">zookeeper.log.threshold=DEBUG</div><div class="line">zookeeper.tracelog.dir=.</div><div class="line">zookeeper.tracelog.file=zookeeper_trace.log</div></pre></td></tr></table></figure>
<p>zkæ—¥å¿—.outåŠlog4jæ—¥å¿—è·¯å¾„é…ç½® ï¼šé¦–å…ˆä¿®æ”¹<code>bin/zkEnv.sh</code>ï¼Œé…ç½®<code>ZOO_LOG_DIR</code>çš„ç¯å¢ƒå˜é‡ï¼Œ<code>ZOO_LOG_DIR</code>æ˜¯zookeeperæ—¥å¿—è¾“å‡ºç›®å½•ï¼Œ<code>ZOO_LOG4J_PROP</code>æ˜¯log4jæ—¥å¿—è¾“å‡ºçš„é…ç½®ï¼š</p>
<ul>
<li>é»˜è®¤é…ç½®ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> [ <span class="string">"x<span class="variable">$&#123;ZOO_LOG_DIR&#125;</span>"</span> = <span class="string">"x"</span> ]</div><div class="line"><span class="keyword">then</span></div><div class="line">    ZOO_LOG_DIR=<span class="string">"."</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="string">"x<span class="variable">$&#123;ZOO_LOG4J_PROP&#125;</span>"</span> = <span class="string">"x"</span> ]</div><div class="line"><span class="keyword">then</span></div><div class="line">    ZOO_LOG4J_PROP=<span class="string">"INFO,CONSOLE"</span></div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
<ul>
<li>ç”Ÿäº§ç¯å¢ƒä¿®æ”¹ï¼š</li>
</ul>
<p>åœ¨zkç›®å½•ä¸‹é¢åˆ›å»ºlogsç›®å½• ç»™äºˆbiç»„æ“ä½œæƒé™ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mkdir /data/tools/zookeeper-3.4.5/logs/</div><div class="line">sudo chown -R jollybi:jollybi /data/tools/zookeeper-3.4.5/logs/</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> [ <span class="string">"x<span class="variable">$&#123;ZOO_LOG_DIR&#125;</span>"</span> = <span class="string">"x"</span> ]</div><div class="line"><span class="keyword">then</span></div><div class="line">    ZOO_LOG_DIR=<span class="string">"<span class="variable">$ZOOBINDIR</span>/../logs"</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [ <span class="string">"x<span class="variable">$&#123;ZOO_LOG4J_PROP&#125;</span>"</span> = <span class="string">"x"</span> ]</div><div class="line"><span class="keyword">then</span></div><div class="line">    ZOO_LOG4J_PROP=<span class="string">"INFO,ROLLINGFILE"</span>  //ROLLINGFILE â€”â€” æ—¥å¿—è½®è½¬ï¼Œé¿å…å•ä¸€æ–‡ä»¶è¿‡å¤§</div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
<h3 id="Zookeeperç‰ˆæœ¬3-4-0ä»¥ä¸Šçš„zkå¯ä»¥è®¾ç½®å®šæœŸè‡ªåŠ¨æ¸…ç†-å‚è€ƒé“¾æ¥"><a href="#Zookeeperç‰ˆæœ¬3-4-0ä»¥ä¸Šçš„zkå¯ä»¥è®¾ç½®å®šæœŸè‡ªåŠ¨æ¸…ç†-å‚è€ƒé“¾æ¥" class="headerlink" title="Zookeeperç‰ˆæœ¬3.4.0ä»¥ä¸Šçš„zkå¯ä»¥è®¾ç½®å®šæœŸè‡ªåŠ¨æ¸…ç†.å‚è€ƒé“¾æ¥"></a>Zookeeperç‰ˆæœ¬3.4.0ä»¥ä¸Šçš„zkå¯ä»¥è®¾ç½®å®šæœŸè‡ªåŠ¨æ¸…ç†.<a href="http://nileader.blog.51cto.com/1381108/932156" target="_blank" rel="external">å‚è€ƒé“¾æ¥</a></h3><ul>
<li>åœ¨zoo.cfgä¸­é…ç½®ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">autopurge.purgeInterval: 24*2     <span class="comment">##è¿™ä¸ªå‚æ•°æŒ‡å®šäº†æ¸…ç†é¢‘ç‡ï¼Œå•ä½æ˜¯å°æ—¶ã€‚é»˜è®¤æ˜¯0ï¼Œè¡¨ç¤ºä¸å¼€å¯è‡ªå·±æ¸…ç†åŠŸèƒ½ã€‚</span></div><div class="line">autopurge.snapRetainCount:  2	    <span class="comment">##è¿™ä¸ªå‚æ•°å’Œä¸Šé¢çš„å‚æ•°æ­é…ä½¿ç”¨ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šäº†éœ€è¦ä¿ç•™çš„æ–‡ä»¶æ•°ç›®ã€‚é»˜è®¤æ˜¯ä¿ç•™3ä¸ªã€‚</span></div></pre></td></tr></table></figure>
<h3 id="é…ç½®zookeeper-outçš„ä½ç½®åŠlog4jæ—¥å¿—è¾“å‡º"><a href="#é…ç½®zookeeper-outçš„ä½ç½®åŠlog4jæ—¥å¿—è¾“å‡º" class="headerlink" title="é…ç½®zookeeper.outçš„ä½ç½®åŠlog4jæ—¥å¿—è¾“å‡º"></a>é…ç½®zookeeper.outçš„ä½ç½®åŠlog4jæ—¥å¿—è¾“å‡º</h3><p>(1)<code>zookeeper.out</code>ç”±nohupçš„è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯<code>zookeeper</code>çš„<code>stdoutå’Œstdeer</code>è¾“å‡ºã€‚</p>
<p>åœ¨zkServer.shä¸­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> [ ! -w <span class="string">"<span class="variable">$ZOO_LOG_DIR</span>"</span> ] ; <span class="keyword">then</span>  </div><div class="line">mkdir -p <span class="string">"<span class="variable">$ZOO_LOG_DIR</span>"</span>  </div><div class="line"><span class="keyword">fi</span>  </div><div class="line">  </div><div class="line">_ZOO_DAEMON_OUT=<span class="string">"<span class="variable">$ZOO_LOG_DIR</span>/zookeeper.out"</span>  <span class="comment">#æ—¥å¿—è¾“å‡ºæ–‡ä»¶è·¯å¾„</span></div><div class="line"></div><div class="line"><span class="comment">#nohupæ—¥å¿—è¾“å‡º</span></div><div class="line">nohup <span class="variable">$JAVA</span> <span class="string">"-Dzookeeper.log.dir=<span class="variable">$&#123;ZOO_LOG_DIR&#125;</span>"</span> <span class="string">"-Dzookeeper.root.logger=<span class="variable">$&#123;ZOO_LOG4J_PROP&#125;</span>"</span> \  </div><div class="line">-cp <span class="string">"<span class="variable">$CLASSPATH</span>"</span> <span class="variable">$JVMFLAGS</span> <span class="variable">$ZOOMAIN</span> <span class="string">"<span class="variable">$ZOOCFG</span>"</span> &gt; <span class="string">"<span class="variable">$_ZOO_DAEMON_OUT</span>"</span> 2&gt;&amp;1 &lt; /dev/null &amp;</div></pre></td></tr></table></figure>
<p>(2)log4jæ—¥å¿—è¾“å‡ºé…ç½® conf/log4j.propertiesä¸­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Add ROLLINGFILE to rootLogger to get log file output  </span></div><div class="line"><span class="comment">#    Log DEBUG level and above messages to a log file  </span></div><div class="line"></div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE=org.apache.log4j.RollingFileAppender  //æ—¥å¿—è½®è½¬ï¼ŒDaliyRollingFileAppender â€”â€” æŒ‰å¤©è½®è½¬</div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE.Threshold=<span class="variable">$&#123;zookeeper.log.threshold&#125;</span>  </div><div class="line"><span class="built_in">log</span>4j.appender.ROLLINGFILE.File=<span class="variable">$&#123;zookeeper.log.dir&#125;</span>/<span class="variable">$&#123;zookeeper.log.file&#125;</span></div></pre></td></tr></table></figure>
<p>è½®è½¬å‰æéœ€è¦å°†(1)é‡Œbin/zkEnv.shä¸­çš„è½®è½¬é…ç½®å¥½</p>
<p>4.zkäº‹åŠ¡æ—¥å¿—æŸ¥çœ‹</p>
<p>zookeeperçš„äº‹åŠ¡æ—¥å¿—é€šè¿‡zoo.cfgæ–‡ä»¶ä¸­çš„dataLogDiré…ç½®é¡¹é…ç½®ï¼š</p>
<pre><code># the directory where the snapshot is stored.
# do not use /tmp for storage, /tmp here is just
# example sakes.
dataDir=/tmp/zookeeper    
</code></pre><p>æŸ¥çœ‹äº‹åŠ¡æ—¥å¿—æ–¹æ³•ï¼š<br>(éœ€è¦ä¸‹è½½slf4j-api-1.6.1.jaråŒ…) </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -classpath .:slf4j-api-1.6.1.jar:zookeeper-3.4.5.jar org.apache.zookeeper.server.LogFormatter /tmp/zookeeper/version-2/xxx.xxx</div></pre></td></tr></table></figure>
<h3 id="æ€ä¹ˆè‡ªå®šä¹‰zookeeperçš„å¯åŠ¨å†…å­˜"><a href="#æ€ä¹ˆè‡ªå®šä¹‰zookeeperçš„å¯åŠ¨å†…å­˜" class="headerlink" title="æ€ä¹ˆè‡ªå®šä¹‰zookeeperçš„å¯åŠ¨å†…å­˜"></a>æ€ä¹ˆè‡ªå®šä¹‰zookeeperçš„å¯åŠ¨å†…å­˜</h3><p>è¿è¡Œzookeeperæ—¶ï¼Œä½¿ç”¨jmap -heap <pid> å‘½ä»¤æŸ¥çœ‹å†…å­˜æƒ…å†µå¦‚ä¸‹:</pid></p>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/zookeeper_01.png" alt=""></figure></p>
<p>è§£å†³ï¼šåˆ†é…å†…å­˜æ–‡ä»¶è·¯å¾„ï¼š<code>zookeeper/bin/zkEnv.sh</code></p>
<p>è¯¥æ–‡ä»¶å·²ç»æ˜ç¡®è¯´æ˜æœ‰ç‹¬ç«‹JVMå†…å­˜çš„è®¾ç½®æ–‡ä»¶ï¼Œè·¯å¾„æ˜¯<code>zookeeper/conf/java.env</code><br>å®‰è£…çš„æ—¶å€™è¿™ä¸ªè·¯å¾„ä¸‹æ²¡æœ‰æœ‰<code>java.env</code>æ–‡ä»¶ï¼Œéœ€è¦è‡ªå·±æ–°å»ºä¸€ä¸ªï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># vim java.env</span></div><div class="line"></div><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk</div><div class="line"><span class="comment"># heap size MUST be modified according to cluster environment</span></div><div class="line"><span class="built_in">export</span> JVMFLAGS=<span class="string">"-Xms4g -Xmx4g <span class="variable">$JVMFLAGS</span>"</span></div><div class="line"></div><div class="line">å¯¹äºå†…å­˜çš„åˆ†é…ï¼Œè¿˜æ˜¯æ ¹æ®é¡¹ç›®å’Œæœºå™¨æƒ…å†µè€Œå®šã€‚å¦‚æœå†…å­˜å¤Ÿç”¨ï¼Œé€‚å½“çš„å¤§ç‚¹å¯ä»¥æå‡zkæ€§èƒ½ã€‚</div></pre></td></tr></table></figure>

	

	

</article>




	<article>
	
		<h1><a href="/2017/04/05/è¿ç»´ç¬”è®°/ã€ç¿»è¯‘ã€‘ç›‘æ§ä¸åªæ˜¯ä¸ºäº†å¤„ç†æ•…éšœ/">ã€ç¿»è¯‘ã€‘ç›‘æ§ä¸åªæ˜¯ä¸ºäº†å¤„ç†æ•…éšœ</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-04-05</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/è¿ç»´ç¬”è®°/">è¿ç»´ç¬”è®°</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Performance-monitoring/">Performance monitoring</a>
			</span>
		
	</div>

	

	
		<h3 id="ã€ç¿»è¯‘ã€‘ç›‘æ§ä¸åªæ˜¯ä¸ºäº†å¤„ç†æ•…éšœ"><a href="#ã€ç¿»è¯‘ã€‘ç›‘æ§ä¸åªæ˜¯ä¸ºäº†å¤„ç†æ•…éšœ" class="headerlink" title="ã€ç¿»è¯‘ã€‘ç›‘æ§ä¸åªæ˜¯ä¸ºäº†å¤„ç†æ•…éšœ"></a>ã€ç¿»è¯‘ã€‘ç›‘æ§ä¸åªæ˜¯ä¸ºäº†å¤„ç†æ•…éšœ</h3><p>æœ‰ä¸€ç§æ™®éçš„æƒ³æ³•è®¤ä¸ºç›‘æ§åªæ˜¯åœ¨ç³»ç»Ÿå‡ºé”™çš„æ—¶å€™èƒ½å¤Ÿå‘å‡ºæŠ¥è­¦ï¼Œæˆ‘ä»¬ä¸€ç›´ç›¸ä¿¡ï¼Œç›‘æ§ç³»ç»Ÿçš„æ–¹æ–¹é¢é¢ç»™äºˆæˆ‘ä»¬æ´å¯Ÿä¸šåŠ¡å†…éƒ¨æœºåˆ¶çš„èƒ½åŠ›ï¼Œå¹¶é©±åŠ¨æˆ‘ä»¬åšå‡ºå†³ç­–ã€‚<br>ä¸åŒçš„äººæœ‰ä¸åŒçš„ç›‘æ§æ–¹å¼ï¼Œæ‰‹åŠ¨æŸ¥çœ‹æ—¥å¿—ï¼Œæ¥å—æŠ¥è­¦æˆ–è€…24x7å€¼å®ˆæŸ¥çœ‹å„ç§å›¾è¡¨ã€‚ä¸ç®¡ä½ ç”¨é‚£ç§æ–¹å¼ï¼Œæœ€é‡è¦çš„æ˜¯åŠæ—¶æ”¶åˆ°æŠ¥é”™å’Œè­¦å‘Šã€‚<br>ä½†æ˜¯ç›‘æ§å…¶å®èƒ½åšçš„æ›´å¤šã€‚</p>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/Prometheus-Overview.png" alt=""></figure></p>
<p>ç›‘æ§ä¸æ­¢ç”¨äºæ•…éšœæ—¶å€™å‘æŠ¥è­¦</p>
<p>ç›‘æ§ç³»ç»Ÿä¸åº”è¯¥åªæ˜¯å‘Šè¯‰ä½ â€œè¿™æœ‰ä¸€ä¸ªé—®é¢˜â€ï¼Œå®ƒä¹Ÿè¦å¸®åŠ©ä½ æ’æŸ¥é—®é¢˜å‡ºç°çš„åŸå› ,ä½ ä¸åªæ˜¯æƒ³åœ¨æœåŠ¡å˜æ…¢çš„æ—¶å€™æ”¶åˆ°æŠ¥è­¦ï¼Œä½ å…¶å®æƒ³çŸ¥é“è¿‡å»å‡ å°æ—¶æµé‡æ˜¯å¦å¢åŠ äº†ï¼Œæœºå™¨æ˜¯ä¸æ˜¯å®•æœºäº†ï¼Œåç«¯æœåŠ¡å™¨æ˜¯ä¸æ˜¯å˜æ…¢äº†æˆ–è€…å†…éƒ¨æ‰§è¡Œæ—¶é—´å˜é•¿äº†ã€‚</p>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/Prometheus-Overview-1.png" alt=""></figure><br>åœ¨ä½ çš„åº”ç”¨ä¸­é›†æˆç›‘æ§æ¨¡å—</p>
<p>åšä¸ºæŠ¥è­¦å’Œæ’é”™é‡è¦æ‰‹æ®µï¼Œç›‘æ§è¦åœ¨ä½ çš„æ¶æ„ä½“ç³»ä¸­æ‹¥æœ‰æ ¸å¿ƒä½ç½®ã€‚è¦é›†æˆç›‘æ§å·¥å…·åœ¨ä½ çš„æ‰€æœ‰ä»£ç é€»è¾‘ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨è¾¹ç¼˜åŒºåŸŸæ·»åŠ ä¸€ç‚¹ã€‚è·Ÿè¸ªæ¯ä¸ªè¯·æ±‚æäº¤apiéœ€è¦å¤šå°‘ç»„ä»¶ï¼Œä»¥ä¾¿ä½ åœ¨è®¾è®¡æ–°çš„å­˜å‚¨ç³»ç»Ÿæ˜¯å¦èƒ½å¤ŸçŸ¥é“è¦å¤„ç†å¤šå°‘æ•°æ®ï¼Œè·Ÿè¸ªå†…å­˜çš„å‘½ä¸­ç‡ï¼Œä»¥ä¾¿ä½ èƒ½åº¦é‡å®ƒä»¬éšç€æµé‡æ¨¡å¼å˜åŒ–çš„è§„å¾‹ï¼Œç”šè‡³åˆ†è§£åˆ°memcachedä¸­æ¥èŠ‚çœå†…å­˜å’Œæé«˜å‘½ä¸­ç‡ã€‚è·Ÿè¸ªç”¨æˆ·å‘½ä¸­ä½ çš„ä¸šåŠ¡é€»è¾‘çš„â€æ…¢è·¯å¾„â€œï¼Œä»¥ä¾¿ä½ çŸ¥é“å®ƒä»€ä¹ˆæ—¶å€™å¯ä»¥æ›´å¿«ï¼Œå¹¶ä¸”å½“æ–°çš„åŠŸèƒ½ä½¿ç”¨â€æ…¢è·¯å¾„â€œçš„æ—¶å€™ï¼Œä½ å·²ç»å‡†å¤‡å¥½äº†è®©å®ƒâ€å»¶è¿Ÿå‘½ä¸­â€œã€‚<br>åœ¨ä½ çš„ä»£ç å†…éƒ¨ï¼Œåšè¿™æ ·å¤§é‡çš„ç»†èŠ‚å·¥ä½œï¼Œå¯ä»¥è®©ä½ å‰è¿›çš„æ›´å¿«ï¼ŒæŠ€æœ¯å’Œäº§å“å†³ç­–ä¼šå—ç›Šè‰¯å¤šï¼Œæ ¹æœ¬ä¸Šæå‡äº†ä½ çš„æ•ˆç‡ã€‚è¿™å°±æ˜¯ç›‘æ§çš„æ„ä¹‰æ‰€åœ¨ï¼Œç›‘æ§ä¸åªæ˜¯ä¸ºäº†å¤„ç†æ•…éšœã€‚</p>
<blockquote>
<p>åŸæ–‡ <a href="https://www.robustperception.io/monitoring-not-just-for-outages/" target="_blank" rel="external">https://www.robustperception.io/monitoring-not-just-for-outages/</a></p>
</blockquote>
<h3 id="äº¤æµå­¦ä¹ ï¼š"><a href="#äº¤æµå­¦ä¹ ï¼š" class="headerlink" title="äº¤æµå­¦ä¹ ï¼š"></a>äº¤æµå­¦ä¹ ï¼š</h3><p>ğŸ§  Linux shell_é«˜çº§è¿ç»´æ´¾: <code>459096184</code>    åœˆå­ (ç³»ç»Ÿè¿ç»´-åº”ç”¨è¿ç»´-è‡ªåŠ¨åŒ–è¿ç»´-è™šæ‹ŸåŒ–æŠ€æœ¯ç ”ç©¶æ¬¢è¿åŠ å…¥)<br>ğŸ§  BigData-Exchange School : <code>521621407</code>  åœˆå­ï¼ˆå¤§æ•°æ®è¿ç»´)ï¼ˆHadoopå¼€å‘äººå‘˜)ï¼ˆå¤§æ•°æ®ç ”ç©¶çˆ±å¥½è€…) æ¬¢è¿åŠ å…¥</p>
<p>ç›¸åº”Bidataæœ‰å†…éƒ¨å¾®ä¿¡äº¤æµç¾¤äº’ç›¸å­¦ä¹ ï¼ŒåŠ å…¥QQç¾¤æœ‰é“¾æ¥ã€‚</p>

	

	

</article>




	<article>
	
		<h1><a href="/2017/03/30/æ—¥å¿—åˆ†æå¹³å°/Elasticsearch/ç ”ç©¶å­¦ä¹  Elasticsearch 5.0.0 åŠŸèƒ½æå‡å“ªäº›,ESå¦‚ä½•å¼¹æ€§è¿ç§»æ—¥å¿—æ•°æ®ï¼Œå®‰è£…éœ€è¦ä»€ä¹ˆç¯å¢ƒï¼Ÿ/">ç ”ç©¶å­¦ä¹  Elasticsearch 5.0.0 åŠŸèƒ½æå‡å“ªäº›,ESå¦‚ä½•å¼¹æ€§è¿ç§»æ—¥å¿—æ•°æ®ï¼Œå®‰è£…éœ€è¦ä»€ä¹ˆç¯å¢ƒï¼Ÿ</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-03-30</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Log-Analysis-Platform/">Log Analysis Platform</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Elasticsearch/">Elasticsearch</a>
			</span>
		
	</div>

	

	
		<p><img src="http://img13.deviantart.net/1fb9/i/2013/051/6/1/ella_vs__elastic_yoko_by_gamepal-d5vmtjm.png" alt=""></p>
<p>ES ç°åœ¨æ™®éå¤§å…¬å¸éƒ½å·²ç»åœ¨ä½¿ç”¨ï¼Œæœ‰çš„ç”¨æ¥åšæ•°æ®å­˜å‚¨ï¼Œä¹Ÿæœ‰åšæ€§èƒ½ç›‘æ§ï¼Œä¹Ÿæœ‰åšæ—¥å¿—æ”¶é›†ï¼Œè·Ÿå¤§æ•°æ®ç»“åˆåšæ—¥å¿—åˆ†æã€‚<br>ä»Šå¤©åœ¨å®¶æ— èŠç ”ç©¶å®˜ç½‘å­¦ä¹ äº†ä¸‹Elasticsearch5.0.0 åŠŸèƒ½æ–°å¢å“ªäº›ï¼Œä¸ªäººè§‰å¾—ESä¹Ÿæ˜¯ç°åœ¨å¼€æºæ—¥å¿—åˆ†æå¹³å°æ¯”è¾ƒç«çš„ï¼Œä»14å¹´å¼€å§‹é™†ç»­ä½¿ç”¨é¢‘ç‡ä¸æ–­æå‡ã€‚<br>ä¹‹å‰ä¹Ÿæœ‰äº†è§£è¿‡Graylog  ç°åœ¨æ¯”ES åšæ•°æ®å­˜å‚¨åˆ†æ ä¸é”™çš„æ˜¯Graylog æ¯”ESæ€§èƒ½å¥½ã€‚<br>åºŸè¯ä¸å¤šè¯´äº†å“ˆå“ˆ</p>
		<p><a class="article__read-more-link" href="/2017/03/30/æ—¥å¿—åˆ†æå¹³å°/Elasticsearch/ç ”ç©¶å­¦ä¹  Elasticsearch 5.0.0 åŠŸèƒ½æå‡å“ªäº›,ESå¦‚ä½•å¼¹æ€§è¿ç§»æ—¥å¿—æ•°æ®ï¼Œå®‰è£…éœ€è¦ä»€ä¹ˆç¯å¢ƒï¼Ÿ/">...read more</a></p>
	

	

</article>




	<article>
	
		<h1><a href="/2017/03/30/Bigdata-hadoop/Kafka/Kafkaæ—¥å¿—å­˜å‚¨è§£æä¸å®è·µæ•°æ®å­˜å‚¨ä¼˜åŒ–/">Kafkaæ—¥å¿—å­˜å‚¨è§£æä¸å®è·µæ•°æ®å­˜å‚¨ä¼˜åŒ–</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-03-30</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata-Hadoop/">Bigdata Hadoop</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Kafka/">Kafka</a>
			</span>
		
	</div>

	

	
		<p><img src="https://cdn-images-1.medium.com/max/640/1*kV768OHeCILNIYVCNPUyuQ.jpeg" alt=""></p>
<h4 id="Kafkaçš„åè¯è§£é‡Š"><a href="#Kafkaçš„åè¯è§£é‡Š" class="headerlink" title="Kafkaçš„åè¯è§£é‡Š"></a>Kafkaçš„åè¯è§£é‡Š</h4><p>kafkaæ˜¯ä¸€æ¬¾åˆ†å¸ƒå¼æ¶ˆæ¯å‘å¸ƒå’Œè®¢é˜…çš„ç³»ç»Ÿï¼Œå…·æœ‰é«˜æ€§èƒ½å’Œé«˜ååç‡ã€‚ </p>
<ul>
<li>1ï¼Œ<code>Broker</code>ï¼š ä¸€ä¸ªå•ç‹¬çš„kafkaæœºå™¨èŠ‚ç‚¹å°±ç§°ä¸ºä¸€ä¸ªbrokerï¼Œå¤šä¸ªbrokerç»„æˆçš„é›†ç¾¤ï¼Œç§°ä¸ºkafkaé›†ç¾¤</li>
<li>2ï¼Œ<code>Topic</code>ï¼šç±»ä¼¼æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè¡¨ï¼Œæˆ‘ä»¬å°†æ•°æ®å­˜å‚¨åœ¨Topicé‡Œé¢ï¼Œå½“ç„¶è¿™åªæ˜¯é€»è¾‘ä¸Šçš„ï¼Œåœ¨ç‰©ç†ä¸Šï¼Œä¸€ä¸ªTopic å¯èƒ½è¢«å¤šä¸ªBrokeråˆ†åŒºå­˜å‚¨ï¼Œè¿™å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ï¼Œç”¨æˆ·åªéœ€å…³æ³¨æ¶ˆæ¯çš„äº§ç”Ÿäºæ¶ˆè´¹å³å¯.</li>
<li>3ï¼Œ<code>Partition</code>ï¼šç±»ä¼¼åˆ†åŒºè¡¨ï¼Œæ¯ä¸ªTopicå¯æ ¹æ®è®¾ç½®å°†æ•°æ®å­˜å‚¨åœ¨å¤šä¸ªæ•´ä½“æœ‰åºçš„Partitionä¸­ï¼Œæ¯ä¸ªé¡ºåºåŒ–partitionä¼šç”Ÿæˆ2ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯indexæ–‡ä»¶ä¸€ä¸ªæ˜¯logæ–‡ä»¶ï¼Œindexæ–‡ä»¶å­˜å‚¨ç´¢å¼•å’Œåç§»é‡ï¼Œlogæ–‡ä»¶å­˜å‚¨å…·ä½“çš„æ•°æ®.</li>
<li>4ï¼Œ<code>Producer</code>ï¼šç”Ÿäº§è€…ï¼Œå‘Topicé‡Œé¢å‘é€æ¶ˆæ¯çš„è§’è‰² </li>
<li>5ï¼Œ<code>Consumer</code>ï¼šæ¶ˆè´¹è€…ï¼Œä»Topicé‡Œé¢è¯»å–æ¶ˆæ¯çš„è§’è‰² </li>
<li>6ï¼Œ<code>Consumer Group</code>ï¼šæ¯ä¸ªConsumerå±äºä¸€ä¸ªç‰¹å®šçš„æ¶ˆè´¹è€…ç»„ï¼Œå¯ä¸ºConsumeræŒ‡å®šgroup nameï¼Œå¦‚æœä¸æŒ‡å®šé»˜è®¤å±äºgroup </li>
</ul>
		<p><a class="article__read-more-link" href="/2017/03/30/Bigdata-hadoop/Kafka/Kafkaæ—¥å¿—å­˜å‚¨è§£æä¸å®è·µæ•°æ®å­˜å‚¨ä¼˜åŒ–/">...read more</a></p>
	

	

</article>




	<article>
	
		<h1><a href="/2017/03/29/Bigdata-hadoop/countly/Bigdata-countlyéœ€è¦è¿ç§»/">Bigdata-countlyéœ€è¦è¿ç§»</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-03-29</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata-Hadoop/">Bigdata Hadoop</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Bigdata-Hadoop/">Bigdata Hadoop</a> <a class="article__tag-link" href="/tags/Countly/">Countly</a>
			</span>
		
	</div>

	

	
		<h4 id="å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼šhttp-resources-count-ly-docs-installing-countly-server"><a href="#å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼šhttp-resources-count-ly-docs-installing-countly-server" class="headerlink" title="å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼šhttp://resources.count.ly/docs/installing-countly-server"></a>å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼š<a href="http://resources.count.ly/docs/installing-countly-server" target="_blank" rel="external">http://resources.count.ly/docs/installing-countly-server</a></h4><p>ç›®å‰<code>countly</code>éœ€è¦è¿ç§»ï¼Œæ‰€éœ€<code>countly</code>ç‰ˆæœ¬äºå®˜æ–¹æä¾›çš„å®‰è£…æ–¹æ¡ˆæœ‰å†²çªï¼Œæ‰€ä»¥å¦‚ä¸‹å®‰è£…ï¼š</p>
<p>å®‰è£…å®˜æ–¹<code>countly</code>è®©å…¶è®¾ç½®æ‰€éœ€ç¯å¢ƒå˜é‡åŠå…¶å¯åŠ¨è„šæœ¬ï¼Œæ‰‹åŠ¨æŒ‡å®šå®‰è£…nojsç‰ˆæœ¬ï¼Œæ‹·è´åŸcountlyæ–‡ä»¶ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1ã€<span class="built_in">cd</span> /data <span class="comment">#countlyå®‰è£…åœ¨dataç›®å½• æˆ‘çœ‹äº†å®‰è£…è„šæœ¬ï¼Œæ˜¯å½“å‰åœ¨å“ªä¸ªç›®å½•ï¼Œå®‰è£…æ–‡ä»¶å°±åœ¨å“ªä¸ªç›®å½•</span></div><div class="line">wget -qO- http://c.ly/install | bash</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">2ã€rpm -qa | grep -i nodejs | xargs -I&#123;&#125;  yum remove &#123;&#125; -y</div><div class="line">å¸è½½æ‰å®˜ç½‘å®‰è£…çš„æœ€æ–°nodejs ç„¶åæ–°å»ºå¦‚ä¸‹yumæºï¼Œç”¨äºå®‰è£…æ—§ç‰ˆæ‰€éœ€nodejsï¼Œä¹Ÿå¯ä»¥åˆ°nodejså®˜ç½‘ä¸‹è½½æ‰€éœ€nodejs</div><div class="line">cat /etc/yum.repos.d/nodesource-el.repo </div><div class="line">[nodesource]</div><div class="line">name=Node.js Packages <span class="keyword">for</span> Enterprise Linux 7 - <span class="variable">$basearch</span></div><div class="line">baseurl=https://rpm.nodesource.com/pub_5.x/el/7/<span class="variable">$basearch</span></div><div class="line">failovermethod=priority</div><div class="line">enabled=1</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/NODESOURCE-GPG-SIGNING-KEY-EL</div><div class="line">[nodesource-source]</div><div class="line">name=Node.js <span class="keyword">for</span> Enterprise Linux 7 - <span class="variable">$basearch</span> - Source</div><div class="line">baseurl=https://rpm.nodesource.com/pub_5.x/el/7/SRPMS</div><div class="line">failovermethod=priority</div><div class="line">enabled=0</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/NODESOURCE-GPG-SIGNING-KEY-EL</div><div class="line">gpgcheck=1</div></pre></td></tr></table></figure>
<h3 id="å®‰è£…è€ç‰ˆæœ¬æ‰€éœ€nodejs"><a href="#å®‰è£…è€ç‰ˆæœ¬æ‰€éœ€nodejs" class="headerlink" title="å®‰è£…è€ç‰ˆæœ¬æ‰€éœ€nodejs"></a>å®‰è£…è€ç‰ˆæœ¬æ‰€éœ€nodejs</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum <span class="keyword">install</span> nodejs</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">3ã€æ‹·è´æºcountlyæ–‡ä»¶åˆ°/data/countlyç›®å½•</div><div class="line">ä¿®æ”¹ /data/countly/api/config.js å’Œ /data/countly/frontend/express/config.js      </div><div class="line">3001ç«¯å£å’Œ 6001ç«¯å£ç›‘å¬åœ°å€æ¢æˆ æœ¬åœ°ç§æœ‰åœ°å€   <span class="comment">#æºæ–‡ä»¶æ˜¯ç›‘å¬çš„åŸæ¥æœºå™¨çš„å†…ç½‘åœ°å€ï¼Œä¸ä¿®æ”¹çš„è¯ï¼ŒæœåŠ¡å¯åŠ¨ä¸äº†ã€‚</span></div></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="number">4</span><span class="string">ã€æ‹·è´mongoæ•°æ®ç›®å½•åˆ°/data/mongoç›®å½•ï¼Œä¿®æ”¹mongoé…ç½®æ–‡ä»¶.</span></div><div class="line"></div><div class="line"><span class="string">cat</span> <span class="string">/etc/mongod.conf</span></div><div class="line"><span class="attr">systemLog:</span></div><div class="line"><span class="attr">       destination:</span> <span class="string">file</span></div><div class="line"><span class="attr">       logAppend:</span> <span class="literal">true</span></div><div class="line"><span class="attr">       path:</span> <span class="string">/data/mongodb/mongod.log</span></div><div class="line"><span class="attr">storage:</span></div><div class="line"><span class="attr">       dbPath:</span> <span class="string">/data/mongo</span></div><div class="line"><span class="attr">       journal:</span></div><div class="line"><span class="attr">             enabled:</span> <span class="literal">true</span></div><div class="line"><span class="attr">       engine:</span> <span class="string">mmapv1</span></div><div class="line"><span class="attr">processManagement:</span></div><div class="line"><span class="attr">       fork:</span> <span class="literal">true</span></div><div class="line"><span class="attr">       pidFilePath:</span> <span class="string">/data/mongodb/mongod.pid</span></div><div class="line"><span class="attr">net:</span></div><div class="line"><span class="attr">       port:</span> <span class="number">27017</span></div><div class="line"><span class="attr">       bindIp:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></div><div class="line"><span class="attr">security:</span></div><div class="line"><span class="attr">       authorization:</span> <span class="string">enabled</span></div><div class="line"><span class="attr">operationProfiling:</span></div><div class="line"><span class="attr">       slowOpThresholdMs:</span> <span class="number">40960</span></div></pre></td></tr></table></figure>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/Bigdatacountly01.jpeg" alt=""></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">5ã€ä¿®æ”¹ç¡¬ç›˜blockï¼š</div><div class="line">     blockdev --setra 256 /dev/mapper/xvdc--vg-xvdcâ€“lv    <span class="comment">##æŒ‰ç…§mongoæç¤ºæ“ä½œ</span></div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">6ã€ä¿®æ”¹nginxé…ç½®æ–‡ä»¶  conf.d/default.conf</div><div class="line">      å°†127.0.0.1ä¿®æ”¹ä¸ºæœ¬åœ°ç§æœ‰åœ°å€</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">7ã€é‡å¯countly   mongodb  nginx</div><div class="line"></div><div class="line">countly restart</div><div class="line"></div><div class="line">/etc/init.d/mongod restart</div><div class="line"></div><div class="line">service nginx restart</div><div class="line">è¿ç§»å®Œæ¯•</div></pre></td></tr></table></figure>
<h3 id="äº¤æµå­¦ä¹ ï¼š"><a href="#äº¤æµå­¦ä¹ ï¼š" class="headerlink" title="äº¤æµå­¦ä¹ ï¼š"></a>äº¤æµå­¦ä¹ ï¼š</h3><p>ğŸ§  Linux shell_é«˜çº§è¿ç»´æ´¾: <code>459096184</code>    åœˆå­ (ç³»ç»Ÿè¿ç»´-åº”ç”¨è¿ç»´-è‡ªåŠ¨åŒ–è¿ç»´-è™šæ‹ŸåŒ–æŠ€æœ¯ç ”ç©¶æ¬¢è¿åŠ å…¥)<br>ğŸ§  BigData-Exchange School : <code>521621407</code>  åœˆå­ï¼ˆå¤§æ•°æ®è¿ç»´)ï¼ˆHadoopå¼€å‘äººå‘˜)ï¼ˆå¤§æ•°æ®ç ”ç©¶çˆ±å¥½è€…) æ¬¢è¿åŠ å…¥</p>
<p>ç›¸åº”Bidataæœ‰å†…éƒ¨å¾®ä¿¡äº¤æµç¾¤äº’ç›¸å­¦ä¹ ï¼ŒåŠ å…¥QQç¾¤æœ‰é“¾æ¥ã€‚</p>

	

	

</article>




	<article>
	
		<h1><a href="/2017/03/28/Bigdata-hadoop/Kafka/Bigdata-Kafkaé›†ç¾¤å¿«é€Ÿæ­å»ºä¸å¢åˆ æ”¹æŸ¥å‘½ä»¤è®²è§£/">Bigdata-Kafkaé›†ç¾¤å¿«é€Ÿæ­å»ºä¸å‘½ä»¤è®²è§£</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-03-28</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/å¤§æ•°æ®/">å¤§æ•°æ®</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Bigdata-Hadoop/">Bigdata Hadoop</a> <a class="article__tag-link" href="/tags/Kafka/">Kafka</a>
			</span>
		
	</div>

	

	
		<h1 id="Bigdata-Kafkaé›†ç¾¤å¿«é€Ÿæ­å»ºä¸å‘½ä»¤è®²è§£"><a href="#Bigdata-Kafkaé›†ç¾¤å¿«é€Ÿæ­å»ºä¸å‘½ä»¤è®²è§£" class="headerlink" title="Bigdata-Kafkaé›†ç¾¤å¿«é€Ÿæ­å»ºä¸å‘½ä»¤è®²è§£"></a>Bigdata-Kafkaé›†ç¾¤å¿«é€Ÿæ­å»ºä¸å‘½ä»¤è®²è§£</h1><h3 id="kafkaé›†ç¾¤å’Œzookeeperé›†ç¾¤è§„èŒƒ"><a href="#kafkaé›†ç¾¤å’Œzookeeperé›†ç¾¤è§„èŒƒ" class="headerlink" title="kafkaé›†ç¾¤å’Œzookeeperé›†ç¾¤è§„èŒƒ"></a>kafkaé›†ç¾¤å’Œzookeeperé›†ç¾¤è§„èŒƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">kafkaé›†ç¾¤å’Œzookeeperé›†ç¾¤è§„èŒƒ</div><div class="line">kafkaç‰ˆæœ¬ï¼škafka_2.10-0.8.2.1</div><div class="line">zookeeperç‰ˆæœ¬ï¼šzookeeper-3.4.5</div><div class="line"></div><div class="line">å¯åŠ¨ç”¨æˆ·ï¼šjollybi</div><div class="line">kafkaå®‰è£…ç›®å½•ï¼š/data/tools/</div><div class="line">kafkaæ–°å»ºæ¶ˆæ¯ç›®å½•ï¼š/data/tools/kafka_2.10-0.8.2.1/kafka-logs</div><div class="line"></div><div class="line">å¯åŠ¨ç”¨æˆ·ï¼šjollybi</div><div class="line">zookeeperå®‰è£…ç›®å½•ï¼š/data/tools/</div><div class="line">zookeeperæ–°å»ºæ—¥å¿—ç›®å½•ï¼š/data/tools/zookeeper-3.4.5/tmp/logs</div><div class="line"></div><div class="line">ç»Ÿä¸€é…ç½®hosts</div><div class="line"></div><div class="line"></div><div class="line">10.155.90.153 kafka1.jollychic.com kafka1</div><div class="line">10.155.90.155 kafka2.jollychic.com kafka2</div><div class="line">10.155.90.138 kafka3.jollychic.com kafka3</div></pre></td></tr></table></figure>
<p>æœ¬æ–‡ä½¿ç”¨äº†3å°æœºå™¨éƒ¨ç½²Kafkaé›†ç¾¤ï¼ŒIPå’Œä¸»æœºåå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">10.155.90.153 kafka1.jollychic.com kafka1</div><div class="line">10.155.90.155 kafka2.jollychic.com kafka2</div><div class="line">10.155.90.138 kafka3.jollychic.com kafka3</div></pre></td></tr></table></figure>
<h3 id="Step1-é…ç½®-etc-hosts-ï¼ˆ3å°ä¸€è‡´ï¼‰"><a href="#Step1-é…ç½®-etc-hosts-ï¼ˆ3å°ä¸€è‡´ï¼‰" class="headerlink" title="Step1: é…ç½®/etc/hosts ï¼ˆ3å°ä¸€è‡´ï¼‰"></a>Step1: é…ç½®/etc/hosts ï¼ˆ3å°ä¸€è‡´ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">127.0.0.1 localhost.localdomain localhost</div><div class="line">10.155.90.153 kafka1.jollychic.com kafka1</div><div class="line">10.155.90.155 kafka2.jollychic.com kafka2</div><div class="line">10.155.90.138 kafka3.jollychic.com kafka3</div></pre></td></tr></table></figure>
<h3 id="Step2-ç¯å¢ƒKafKaé›†ç¾¤ç¯å¢ƒ"><a href="#Step2-ç¯å¢ƒKafKaé›†ç¾¤ç¯å¢ƒ" class="headerlink" title="Step2: ç¯å¢ƒKafKaé›†ç¾¤ç¯å¢ƒ"></a>Step2: ç¯å¢ƒKafKaé›†ç¾¤ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ä¸‹è½½åœ°å€ï¼šhttp://mirrors.hust.edu.cn/apache/kafka/0.9.0.0/kafka_2.10-0.8.2.1.tgz</div><div class="line">[jollybi@kafka1 ]<span class="comment"># tar -xvf kafka_2.10-0.8.2.1.tgz -C /data/tools/</span></div><div class="line"><span class="built_in">cd</span> /data/tools/kafka_2.10-0.8.2.1/config</div></pre></td></tr></table></figure>
<h3 id="è®¾ç½®dataç›®å½•ï¼Œæœ€å¥½ä¸è¦ç”¨é»˜è®¤çš„-tmp-kafka-logs"><a href="#è®¾ç½®dataç›®å½•ï¼Œæœ€å¥½ä¸è¦ç”¨é»˜è®¤çš„-tmp-kafka-logs" class="headerlink" title="è®¾ç½®dataç›®å½•ï¼Œæœ€å¥½ä¸è¦ç”¨é»˜è®¤çš„/tmp/kafka-logs"></a>è®¾ç½®dataç›®å½•ï¼Œæœ€å¥½ä¸è¦ç”¨é»˜è®¤çš„/tmp/kafka-logs</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir -p /data/tools/kafka_2.10-0.8.2.1/kafka-logs/</div></pre></td></tr></table></figure>
<p><em>ä¿®æ”¹kafkaé…ç½®æ–‡ä»¶</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">[root@kafka_01 config]<span class="comment"># vim server.properties</span></div><div class="line"></div><div class="line"></div><div class="line"> è®¾ç½®brokeridï¼ˆä»0å¼€å§‹ï¼Œ3ä¸ªèŠ‚ç‚¹åˆ†åˆ«è®¾ä¸º1,2,3ï¼Œä¸èƒ½é‡å¤ï¼‰åœ¨è¿™é‡Œid=0è·Ÿzookeeper idè®¾ç½®ä¸€æ ·å°±è¡Œã€‚ é›†ç¾¤æœºå™¨ï¼šæŒ‰é¡ºåºå†™1</div><div class="line">broker.id=1  </div><div class="line"></div><div class="line">auto.leader.rebalance.enable=<span class="literal">true</span> </div><div class="line"></div><div class="line"><span class="comment">#ä¿®æ”¹æœ¬åœ°IPåœ°å€ï¼š</span></div><div class="line">listeners=PLAINTEXT://10.46.72.172:9092</div><div class="line">port=9292 //è®¾ç½®è®¿é—®ç«¯å£</div><div class="line">host.name=10.155.90.153   kafkaæœ¬æœºIP</div><div class="line">log.dirs=/data/tools/kafka_2.10-0.8.2.1/kafka-logs</div><div class="line"></div><div class="line"><span class="comment">#è®¾ç½®æ³¨å†Œåœ°å€ï¼ˆé‡è¦ï¼Œé»˜è®¤ä¼šæŠŠæœ¬æœºçš„hostanmeæ³¨å†Œåˆ°zkä¸­ï¼Œå®¢æˆ·ç«¯è¿æ¥æ—¶éœ€è¦è§£æè¯¥hostanmeï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æ³¨å†Œæœ¬æœºçš„IPåœ°å€ï¼Œé¿å…hostnameè§£æå¤±è´¥ï¼ŒæŠ¥é”™java.nio.channels.UnresolvedAddressExceptionæˆ–java.io.IOException: Can not resolve addressï¼‰</span></div><div class="line"><span class="comment">#è®¾ç½®zookeeperåœ°å€</span></div><div class="line"><span class="comment">#zookeeper.connect=10.46.72.172:2181,10.47.88.103:2181,10.47.102.137:2181</span></div><div class="line">zookeeper.connect=kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281</div><div class="line"></div><div class="line">//è¿™é‡Œæˆ‘è®¾ç½®hostsä»£æ›¿IP</div></pre></td></tr></table></figure>
<p><em>é…ç½®zookeeperåœ°å€</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">vim zookeeper.properties </div><div class="line">dataDir=/data/tools/zookeeper-3.4.5/tmp</div><div class="line"><span class="comment"># the port at which the clients will connect</span></div><div class="line">clientPort=2281</div><div class="line"><span class="comment"># disable the per-ip limit on the number of connections since this is a non-production config</span></div><div class="line">maxClientCnxns=0</div><div class="line">~</div></pre></td></tr></table></figure>
<p><em>é…ç½®kafkaè®¿é—®åœ°å€</em></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">vim</span> producer.properties </div><div class="line">metadata.broker.list=<span class="number">169.44.62.139:9292</span>,<span class="number">169.44.59.138:9292</span>,<span class="number">169.44.62.137:9292</span>   </div><div class="line"><span class="comment"># name of the partitioner class for partitioning events; default partition spreads data randomly</span></div><div class="line"><span class="comment">#partitioner.class=</span></div><div class="line"></div><div class="line"><span class="comment"># specifies whether the messages are sent asynchronously (async) or synchronously (sync)</span></div><div class="line">producer.type=sync</div><div class="line"></div><div class="line"><span class="comment"># specify the compression codec for all data generated: none, gzip, snappy, lz4.</span></div><div class="line"><span class="comment"># the old config values work as well: 0, 1, 2, 3 for none, gzip, snappy, lz4, respectively</span></div><div class="line">compression.codec=<span class="literal">none</span></div><div class="line"></div><div class="line"><span class="comment"># message encoder</span></div><div class="line">serializer.class=kafka.serializer.DefaultEncoder</div></pre></td></tr></table></figure>
<h3 id="Step3-é›†ç¾¤æœºå™¨å¿«é€Ÿæ‹·è´é…ç½®"><a href="#Step3-é›†ç¾¤æœºå™¨å¿«é€Ÿæ‹·è´é…ç½®" class="headerlink" title="Step3: é›†ç¾¤æœºå™¨å¿«é€Ÿæ‹·è´é…ç½®:"></a>Step3: é›†ç¾¤æœºå™¨å¿«é€Ÿæ‹·è´é…ç½®:</h3><p>è¿œç¨‹å¤åˆ¶åˆ†å‘å®‰è£…æ–‡ä»¶<br>æœ€å¥½æ˜¯æŠŠæ–‡ä»¶æ‰“åŒ…scpè¿‡å»<br>æ¥ä¸‹æ¥å°†ä¸Šé¢çš„å®‰è£…æ–‡ä»¶æ‹·è´åˆ°é›†ç¾¤ä¸­çš„å…¶ä»–æœºå™¨ä¸Šå¯¹åº”çš„ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scp -P58958 -r kafka_2.10-0.8.2.1 jollybi@169.44.62.137:/home/jollybi/tools/. </div><div class="line">scp -P58958 -r kafka_2.10-0.8.2.1 jollybi@169.44.62.138:/home/jollybi/tools/.</div></pre></td></tr></table></figure>
<p>ç»Ÿä¸€ä¿®æ”¹åˆ†åˆ«å…¶ä»–ä¸¤å°kafka <code>server.properties</code></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">broker.id=<span class="number">2</span>  </div><div class="line">host.name=<span class="number">169.44</span><span class="number">.62</span><span class="number">.137</span>   kafka2æœ¬æœºIP</div><div class="line"></div><div class="line">broker.id=<span class="number">3</span> </div><div class="line">host.name=<span class="number">169.44</span><span class="number">.62</span><span class="number">.138</span>   kafka3æœ¬æœºIP</div></pre></td></tr></table></figure>
<h3 id="Step4-å¯åŠ¨-kafkaé›†ç¾¤"><a href="#Step4-å¯åŠ¨-kafkaé›†ç¾¤" class="headerlink" title="Step4:å¯åŠ¨ kafkaé›†ç¾¤"></a>Step4:å¯åŠ¨ kafkaé›†ç¾¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">./kafka-server-start.sh -daemon ../config/server.properties</div><div class="line"></div><div class="line">[jollybi@kafka1 config]$ jps</div><div class="line">3443 QuorumPeerMain</div><div class="line">16280 Jps</div><div class="line">3628 Kafka</div><div class="line">Step5: Kafkaå¸¸ç”¨å‘½ä»¤(æ™®åŠ)</div></pre></td></tr></table></figure>
<h4 id="Step5-æµ‹è¯•é›†ç¾¤åŸºæœ¬å‘½ä»¤"><a href="#Step5-æµ‹è¯•é›†ç¾¤åŸºæœ¬å‘½ä»¤" class="headerlink" title="Step5:æµ‹è¯•é›†ç¾¤åŸºæœ¬å‘½ä»¤"></a>Step5:æµ‹è¯•é›†ç¾¤åŸºæœ¬å‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="comment">### é»˜è®¤åˆ›å»ºkafka Topic:  1ä¸ªå‰¯æœ¬å¤‡ä»½ 1ä¸ªåˆ†åŒºæ¶ˆè´¹</span></div><div class="line"></div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh --create --zookeeper  kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281 --replication-factor 1 --partitions 1 --topic mongotail_lz4</div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh --create --zookeeper  kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281 --replication-factor 1 --partitions 1 --topic mongotail_lz4_imp</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">### å¤§æ•°æ®è¿™è¾¹éœ€è¦12ä¸ªåˆ†åŒºè¿™é‡Œæˆ‘åˆ é™¤Topicé‡æ–°åˆ›å»ºTopicï¼š</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">### åˆ é™¤kafka Topic:</span></div><div class="line"></div><div class="line"></div><div class="line">ç¬¬ä¸€æ­¥ï¼šåˆ é™¤kafka topic</div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh --zookeeper  kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281 --delete --topic  mongotail_lz4 </div><div class="line"></div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh --zookeeper  kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281 --delete --topic  mongotail_lz4_imp</div><div class="line"></div><div class="line"><span class="comment">### è¿™æ˜¯ç”±äºåˆ é™¤topicæ²¡åˆ å¹²å‡€ä¼šæŠ¥é”™ï¼š</span></div><div class="line"></div><div class="line">org.apache.kafka.common.errors.UnknownTopicOrPartitionException: This server does not host this topic-partition.</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">### åˆ é™¤çº¿ç¨‹æ‰§è¡Œåˆ é™¤æ“ä½œçš„çœŸæ­£é€»è¾‘æ˜¯ï¼š</span></div><div class="line">1. å®ƒé¦–å…ˆä¼šç»™å½“å‰æ‰€æœ‰brokerå‘é€æ›´æ–°å…ƒæ•°æ®ä¿¡æ¯çš„è¯·æ±‚ï¼Œå‘Šè¯‰è¿™äº›brokerè¯´è¿™ä¸ªtopicè¦åˆ é™¤äº†ï¼Œä½ ä»¬å¯ä»¥æŠŠå®ƒçš„ä¿¡æ¯ä»ç¼“å­˜ä¸­åˆ æ‰äº†</div><div class="line">2. å¼€å§‹åˆ é™¤è¿™ä¸ªtopicçš„æ‰€æœ‰åˆ†åŒº</div><div class="line">2.1 ç»™æ‰€æœ‰brokerå‘è¯·æ±‚ï¼Œå‘Šè¯‰å®ƒä»¬è¿™äº›åˆ†åŒºè¦è¢«åˆ é™¤ã€‚brokeræ”¶åˆ°åå°±ä¸å†æ¥å—ä»»ä½•åœ¨è¿™äº›åˆ†åŒºä¸Šçš„å®¢æˆ·ç«¯è¯·æ±‚äº†</div><div class="line">2.2 æŠŠæ¯ä¸ªåˆ†åŒºä¸‹çš„æ‰€æœ‰å‰¯æœ¬éƒ½ç½®äºOfflineReplicaçŠ¶æ€ï¼Œè¿™æ ·ISRå°±ä¸æ–­ç¼©å°ï¼Œå½“leaderå‰¯æœ¬æœ€åä¹Ÿè¢«ç½®äºOfflineReplicaçŠ¶æ€æ—¶leaderä¿¡æ¯å°†è¢«æ›´æ–°ä¸º-1</div><div class="line">2.3 å°†æ‰€æœ‰å‰¯æœ¬ç½®äºReplicaDeletionStartedçŠ¶æ€</div><div class="line">2.4 å‰¯æœ¬çŠ¶æ€æœºæ•è·çŠ¶æ€å˜æ›´ï¼Œç„¶åå‘èµ·StopReplicaRequestç»™brokerï¼Œbrokeræ¥åˆ°è¯·æ±‚ååœæ­¢æ‰€æœ‰fetcherçº¿ç¨‹ã€ç§»é™¤ç¼“å­˜ï¼Œç„¶ååˆ é™¤åº•å±‚<span class="built_in">log</span>æ–‡ä»¶</div><div class="line">2.5 å…³é—­æ‰€æœ‰ç©ºé—²çš„Fetcherçº¿ç¨‹</div><div class="line">    </div><div class="line"><span class="comment">### ç¬¬äºŒæ­¥ï¼šåˆ é™¤zookeeperç›¸å…³çš„è·¯å¾„ï¼š</span></div><div class="line">[jollybi@kafka1 zookeeper-3.4.5]$ ./bin/zkCli.sh -server 127.0.0.1:2281 </div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 1] rmr /brokers/topics/mongotail_lz4</div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 0] rmr /consumers/group_ml_general/offsets/mongotail_lz4</div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 1] rmr /consumers/group_ml_general/owners/mongotail_lz4</div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 3] rmr  /config/topics/mongotail_lz4</div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 4] rmr /admin/delete_topics/mongotail_lz4</div><div class="line"></div><div class="line"><span class="comment">### åˆ é™¤topicä¸Šé¢æ¶ˆè´¹ç»„ </span></div><div class="line"></div><div class="line">åˆ é™¤ ZooKeeper ä¸‹é¢çš„ /consumers/[group_id] è·¯å¾„å°±å¯ä»¥äº†ã€‚ZooKeeper åŸç”ŸAPIåªæ”¯æŒåˆ é™¤ç©ºçš„è·¯å¾„ï¼Œæ‰€ä»¥å»ºè®®ä½ ä½¿ç”¨ curator framework è¿›è¡Œè¿™ä¸ªåˆ é™¤æ“ä½œï¼ŒZkPaths.deleteChildren ä¼šé€’å½’å¼åœ°åˆ é™¤æ•´ä¸ªè·¯å¾„ï¼ˆåŒ…æ‹¬å­è·¯å¾„ï¼‰ã€‚</div><div class="line"></div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 0] rmr /consumers/kafka-node1-imp-group</div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 1] rmr /consumers/kafka-node1-group</div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 2] rmr /consumers/console-consumer-59053</div><div class="line">[zk: 127.0.0.1:2281(CONNECTED) 3] rmr /consumers/</div><div class="line"></div><div class="line"></div><div class="line">1ã€è®¾ç½®é…ç½®æ–‡ä»¶å…è®¸åˆ é™¤</div><div class="line">delete.topic.enable=<span class="literal">true</span> é…ç½®æ·»åŠ åˆ° config/server.properties</div><div class="line">2ã€æ‰§è¡Œåˆ é™¤å‘½ä»¤</div><div class="line">./bin/kafka-topics.sh --zookeeper localhost:2181 --delete --topic <span class="built_in">test</span>-topic</div><div class="line"></div><div class="line">åœ¨zookeeperä¸­ç¡®è®¤ï¼š</div><div class="line"></div><div class="line"> åˆ é™¤zookeeperä¸‹/brokers/topics/<span class="built_in">test</span>-topicèŠ‚ç‚¹</div><div class="line"> åˆ é™¤zookeeperä¸‹/config/topics/<span class="built_in">test</span>-topicèŠ‚ç‚¹</div><div class="line"> åˆ é™¤zookeeperä¸‹/admin/delete_topics/<span class="built_in">test</span>-topicèŠ‚ç‚¹</div><div class="line"> </div><div class="line">consumer çš„è¯ åˆ é™¤groupid</div><div class="line"> </div><div class="line"></div><div class="line"><span class="comment">### é‡å¯kafkaé›†ç¾¤</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">### å¤§æ•°æ®kafkaå»ºtopicï¼Œä¸èƒ½å»ºä¸€ä¸ªåˆ†åŒºï¼Œé‚£æ ·ååé‡ä¸Šä¸å»ï¼Œä¸å¤Ÿç”¨ï¼Œæˆ‘ä»¬ä»¥å‰å»ºäº†12ä¸ªåˆ†åŒºçš„</span></div><div class="line"><span class="comment">### åˆ›å»ºæ–° kafka Topic: 3ä¸ªå‰¯æœ¬ï¼Œ12ä¸ªåˆ†åŒº</span></div><div class="line"></div><div class="line"> ./kafka_2.10-0.8.2.1/bin/kafka-topics.sh --create --zookeeper  kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281 --replication-factor 3 --partitions 12  --topic mongotail_lz4</div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh --create --zookeeper  kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281 --replication-factor 3 --partitions 12  --topic mongotail_lz4_imp</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">### æŸ¥çœ‹åˆ›å»ºçš„Topic:</span></div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh  --describe --zookeeper kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281  --topic mongotail_lz4</div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh  --describe --zookeeper kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281  --topic mongotail_lz4_imp</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">### æŸ¥çœ‹é›†ç¾¤æƒ…å†µï¼š</span></div><div class="line">./kafka_2.10-0.8.2.1/bin/kafka-topics.sh  --describe --zookeeper kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281  --topic mongotail_lz4</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">### æ¨¡æ‹Ÿç”Ÿäº§è€…ï¼ˆproducerï¼‰kafkaç”Ÿäº§å®¢æˆ·ç«¯ç”Ÿäº§æ•°æ®å‘½ä»¤ï¼š</span></div><div class="line"></div><div class="line">./bin/kafka-console-producer.sh --broker-list 75.126.39.124:9292,75.126.5.162:9292,75.126.5.178:9292 --topic mongotail_lz4_imp                      </div><div class="line">......</div><div class="line">my <span class="built_in">test</span> message 1</div><div class="line">my <span class="built_in">test</span> message 2</div><div class="line">^C</div><div class="line"><span class="comment">### æ¨¡æ‹Ÿæ¶ˆè´¹è€…ï¼ˆconsumerï¼‰kafkaæ¶ˆè´¹å®¢æˆ·ç«¯æ•°æ®å‘½ä»¤ ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹æ¶ˆæ¯ï¼š</span></div><div class="line"></div><div class="line"> ./bin/kafka-console-consumer.sh --zookeeper  75.126.39.124:2281,75.126.5.162:2281,75.126.5.178:2281  --fm-beginning --topic mongotail_lz4_imp</div><div class="line">......</div><div class="line">my <span class="built_in">test</span> message 1</div><div class="line">my <span class="built_in">test</span> message 2</div><div class="line"></div><div class="line">^C</div></pre></td></tr></table></figure>
<h3 id="Kafkaå¸¸ç”¨å‘½ä»¤"><a href="#Kafkaå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Kafkaå¸¸ç”¨å‘½ä»¤"></a>Kafkaå¸¸ç”¨å‘½ä»¤</h3><p>ä»¥ä¸‹æ˜¯kafkaå¸¸ç”¨å‘½ä»¤è¡Œæ€»ç»“ï¼š  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">1ã€ list topic æ˜¾ç¤ºæ‰€æœ‰topic</div><div class="line">./bin/kafka-topics.sh --list --zookeeper kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281</div><div class="line"></div><div class="line">2ã€ æŸ¥çœ‹topicçš„è¯¦ç»†ä¿¡æ¯  </div><div class="line"> ./bin/kafka-topics.sh --zookeeper  75.126.39.124:2281,75.126.5.162:2281,75.126.5.178:2281  -describe -topic mongotail_lz4_imp</div><div class="line"></div><div class="line">3ã€ä¸ºtopicå¢åŠ partitionåˆ†åŒº å‚æ•°ï¼š--alter --partitions</div><div class="line">./bin/kafka-topics.sh  --alter --zookeeper  75.126.39.124:2281,75.126.5.162:2281,75.126.5.178:2281  --partitions 20 --topic mongotail_lz4_imp</div><div class="line"></div><div class="line">4ã€kafkaç”Ÿäº§è€…å®¢æˆ·ç«¯å‘½ä»¤  </div><div class="line">./bin/kafka-console-producer.sh --broker-list 75.126.39.124:9292,75.126.5.162:9292,75.126.5.178:9292 --topic mongotail_lz4_imp                        </div><div class="line"></div><div class="line">5ã€kafkaæ¶ˆè´¹è€…å®¢æˆ·ç«¯å‘½ä»¤  </div><div class="line">./bin/kafka-console-consumer.sh --zookeeper  75.126.39.124:2281,75.126.5.162:2281,75.126.5.178:2281  --fm-beginning --topic </div><div class="line"></div><div class="line">6ã€kafkaæœåŠ¡å¯åŠ¨  </div><div class="line">./kafka-server-start.sh -daemon ../config/server.properties   </div><div class="line"></div><div class="line">7ã€ä¸‹çº¿broker  </div><div class="line">./kafka-run-class.sh kafka.admin.ShutdownBroker --zookeeper 127.0.0.1:2181 --broker <span class="comment">#brokerId# --num.retries 3 --retry.interval.ms 60  </span></div><div class="line">shutdown broker  </div><div class="line"></div><div class="line">8ã€åˆ é™¤topic  </div><div class="line">./kafka-run-class.sh kafka.admin.DeleteTopicCommand --topic <span class="built_in">test</span>KJ1 --zookeeper 127.0.0.1:2181  </div><div class="line">./kafka-topics.sh --zookeeper localhost:2181 --delete --topic <span class="built_in">test</span>KJ1  </div><div class="line"></div><div class="line">9ã€æŸ¥çœ‹consumerç»„å†…æ¶ˆè´¹çš„offset  </div><div class="line">./kafka-run-class.sh kafka.tools.ConsumerOffsetChecker --zookeeper localhost:2181 --group <span class="built_in">test</span> --topic <span class="built_in">test</span>KJ1</div></pre></td></tr></table></figure>
<h4 id="Step6-Kafkaå­˜å‚¨"><a href="#Step6-Kafkaå­˜å‚¨" class="headerlink" title="Step6:Kafkaå­˜å‚¨"></a>Step6:Kafkaå­˜å‚¨</h4><p>æ¯ä¸ªreplicaä¸€ä¸ªç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[jollybi@kafka1 kafka_2.10-0.8.2.0]<span class="comment"># cd /data/tools/kafka_2.10-0.8.2.0/kafka-logs/</span></div><div class="line">[root@master kafka-logs]<span class="comment"># ls</span></div><div class="line">__consumer_offsets-0   __consumer_offsets-20  __consumer_offsets-32  __consumer_offsets-44   my-replicatedtopic1-0</div><div class="line">__consumer_offsets-1   __consumer_offsets-21  __consumer_offsets-33  __consumer_offsets-45   my-replicated-topic1-1</div></pre></td></tr></table></figure>
<p>äºŒçº§ç»“æ„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[jollybi@kafka1 kafka-logs]<span class="comment"># cd my-replicated-topic1-0/</span></div><div class="line">[jollybi@kafka1  my-replicated-topic1-0]<span class="comment"># ls</span></div><div class="line">00000000000000000000.index  00000000000000000000.log</div></pre></td></tr></table></figure>
<p><figure class="figure"><img src="http://static.zybuluo.com/sasaki/f71rtngyz2y8n3m6uxq1z2ec/%E5%9B%BE%E7%89%871.png" alt=""></figure></p>
<h3 id="äº¤æµå­¦ä¹ ï¼š"><a href="#äº¤æµå­¦ä¹ ï¼š" class="headerlink" title="äº¤æµå­¦ä¹ ï¼š"></a>äº¤æµå­¦ä¹ ï¼š</h3><p>ğŸ§  Linux shell_é«˜çº§è¿ç»´æ´¾: <code>459096184</code>    åœˆå­ (ç³»ç»Ÿè¿ç»´-åº”ç”¨è¿ç»´-è‡ªåŠ¨åŒ–è¿ç»´-è™šæ‹ŸåŒ–æŠ€æœ¯ç ”ç©¶æ¬¢è¿åŠ å…¥)<br>ğŸ§  BigData-Exchange School : <code>521621407</code>  åœˆå­ï¼ˆå¤§æ•°æ®è¿ç»´)ï¼ˆHadoopå¼€å‘äººå‘˜)ï¼ˆå¤§æ•°æ®ç ”ç©¶çˆ±å¥½è€…) æ¬¢è¿åŠ å…¥</p>
<p>ç›¸åº”Bidataæœ‰å†…éƒ¨å¾®ä¿¡äº¤æµç¾¤äº’ç›¸å­¦ä¹ ï¼ŒåŠ å…¥QQç¾¤æœ‰é“¾æ¥ã€‚</p>

	

	

</article>




	<article>
	
		<h1><a href="/2017/03/15/è¿ç»´ç¬”è®°/APPè‡ªåŠ¨åŒ–éƒ¨ç½²:å¼€å‘éƒ¨ç½²-æµ‹è¯•éƒ¨ç½²-ç°åº¦å‘å¸ƒ:è“ç»¿éƒ¨ç½²-ç”Ÿäº§ç¯å¢ƒç­‰éƒ¨ç½²æµç¨‹æ–¹æ¡ˆæ€»ç»“/">APPè‡ªåŠ¨åŒ–éƒ¨ç½²:å¼€å‘éƒ¨ç½²-æµ‹è¯•éƒ¨ç½²-ç°åº¦å‘å¸ƒ/è“ç»¿éƒ¨ç½²-ç”Ÿäº§ç¯å¢ƒç­‰éƒ¨ç½²æµç¨‹æ–¹æ¡ˆæ€»ç»“</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-03-15</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/è¿ç»´ç¬”è®°/">è¿ç»´ç¬”è®°</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Automation-Deploy/">Automation Deploy</a>
			</span>
		
	</div>

	

	
		<h1 id="APPè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šå¼€å‘éƒ¨ç½²ã€æµ‹è¯•éƒ¨ç½²ã€ç°åº¦å‘å¸ƒç­‰éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”ä¸æ€»ç»“"><a href="#APPè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šå¼€å‘éƒ¨ç½²ã€æµ‹è¯•éƒ¨ç½²ã€ç°åº¦å‘å¸ƒç­‰éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”ä¸æ€»ç»“" class="headerlink" title="APPè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šå¼€å‘éƒ¨ç½²ã€æµ‹è¯•éƒ¨ç½²ã€ç°åº¦å‘å¸ƒç­‰éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”ä¸æ€»ç»“"></a>APPè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šå¼€å‘éƒ¨ç½²ã€æµ‹è¯•éƒ¨ç½²ã€ç°åº¦å‘å¸ƒç­‰éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”ä¸æ€»ç»“</h1><h4 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h4><p>ä¸ªäººç°åœ¨åœ¨ä¸€ä¸ªåŒ»ç–—è¡Œä¸šå…¬å¸ï¼šç¾å¹´å¤§è¿™è¾¹è´Ÿè´£ä½“æ£€APPçš„è¿ç»´ç›¸å…³å·¥ä½œï¼Œä»Šå¤©ä¸»è¦æ˜¯æ•´ç†äº†ä¸‹ç°åœ¨å›¢é˜ŸAPPå‘å¸ƒæµç¨‹<br>æ–¹æ¡ˆï¼š</p>
<p>å› ä¸ºåœ¨é¡¹ç›®è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œä¸å¯é¿å…éœ€è¦â€ä¸Šçº¿â€ã€‚ä¸Šçº¿å¯¹åº”ç€éƒ¨ç½²ï¼Œæˆ–è€…é‡æ–°éƒ¨ç½²ï¼›éƒ¨ç½²å¯¹åº”ç€ä¿®æ”¹ï¼›ä¿®æ”¹åˆ™æ„å‘³ç€é£é™©ã€‚<br>ç›®å‰æœ‰å¾ˆå¤šç”¨äºéƒ¨ç½²çš„æŠ€æœ¯ï¼Œæœ‰çš„ç®€å•ï¼Œæœ‰çš„å¤æ‚ï¼›æœ‰çš„å¾—åœæœºï¼Œæœ‰çš„ä¸éœ€è¦åœæœºå³å¯å®Œæˆéƒ¨ç½²ã€‚</p>
<p>ä¸ªäººæ•´ç†ä¸‹éƒ¨ç½²æµç¨‹è¯´æ˜å…¶å®ç°åœ¨å¾ˆå¤šéƒ¨ç½²æ–¹æ³•ï¼Œç°åœ¨æˆ‘ä»¬ç”¨ç›®å‰æ¯”è¾ƒæµè¡Œçš„å‡ ç§éƒ¨ç½²æ–¹æ¡ˆï¼Œæˆ–è€…è¯´ç­–ç•¥æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“ç®€å•è®¨è®ºä¸€ä¸‹ç›®å‰æ¯”è¾ƒæµè¡Œçš„å‡ ç§éƒ¨ç½²æ–¹æ¡ˆï¼Œæˆ–è€…è¯´ç­–ç•¥ã€‚å¦‚æœ‰ä¸è¶³ä¹‹å¤„è¯·æŒ‡å‡ºï¼Œå¦‚æœ‰è°¬è¯¯ï¼Œè¯·æŒ‡æ­£^_^ã€‚</p>
<p>æˆ‘ä»¬æœ‰è‡ªå·±å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒ ï¼š</p>
<h4 id="å¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼š"><a href="#å¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼š" class="headerlink" title="å¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼š"></a>å¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼š</h4><ul>
<li>é—®é¢˜ï¼š</li>
</ul>
<p>å¼€å‘äººå‘˜æ¯ä¸ªäººåœ¨è‡ªå·±ç”µè„‘ç¯å¢ƒå†™ä»£ç è‡ªå·±ç”µè„‘æœ¬æœºæµ‹è¯•ä»£ç æ˜¯å¦runæˆåŠŸï¼Œæ¯ä¸ªå¼€å‘äººå‘˜éƒ½åœ¨è‡ªå·±æœ¬åœ°å†™å®Œæµ‹è¯•å‡ºç°é—®é¢˜æ˜¯å„è‡ªç¯å¢ƒä¸ç»Ÿä¸€å¯¼è‡´é‡åˆ°å‘é˜»ç¢åˆ°æµ‹è¯•äººå‘˜æµ‹è¯•ï¼ŒåŸºç¡€çš„bugä¹Ÿä¼šæµªè´¹å¤ªå¤šæ—¶é—´ã€‚</p>
<ul>
<li>è§£å†³åï¼š</li>
</ul>
<p>ä¸»è¦æ˜¯è§£å†³äº†ç»™äºˆå¼€å‘å›¢é˜Ÿåœ¨å†™ä»£ç æˆ–è€…ä¿®æ”¹bugå¯ä»¥ç¬¬ä¸€æ—¶é—´æ›´æ–°éƒ¨ç½²ã€‚å¤§å®¶ç»Ÿä¸€ä¸€ä¸ªå¼€å‘ç¯å¢ƒè¿™ä¸ªæ˜¯ä¸ºäº†åœ¨å¼€å‘é˜¶æ®µèƒ½ç«‹é©¬å‘ˆç°æ•ˆæœã€‚</p>
<h4 id="æµ‹è¯•ç¯å¢ƒéƒ¨ç½²ï¼š"><a href="#æµ‹è¯•ç¯å¢ƒéƒ¨ç½²ï¼š" class="headerlink" title="æµ‹è¯•ç¯å¢ƒéƒ¨ç½²ï¼š"></a>æµ‹è¯•ç¯å¢ƒéƒ¨ç½²ï¼š</h4><ul>
<li>é—®é¢˜ï¼š</li>
</ul>
<p>ä¸€å¼€å§‹æ²¡æœ‰æµ‹è¯•ç¯å¢ƒï¼Œç›´æ¥å¼€å‘ç¯å¢ƒå½“ä½œæµ‹è¯•ç¯å¢ƒå»è·‘ï¼Œå‘ç°å¾ˆå¤šé—®é¢˜ï¼Œå°±æ˜¯æµ‹è¯•ç¯å¢ƒæ•°æ®è·Ÿç”Ÿäº§ä¸ä¸€æ ·ï¼Œå¯¼è‡´å¾ˆå¤šbugé—®é¢˜ï¼Œæµ‹è¯•å‘ç°æµ‹è¯•çš„æ—¶å€™ï¼Œå¼€å‘åœ¨æ›´æ–°ä»£ç å‘å¸ƒï¼Œè€½è¯¯äº†æµ‹è¯•äººå‘˜çš„æµ‹è¯•è¿‡ç¨‹ï¼Œç¯å¢ƒä¸èƒ½ç‹¬ç«‹éƒ½äº’ç›¸å ç”¨ï¼Œåˆ€å­æ•ˆç‡æ²¡æœ‰æé«˜ï¼Œbugæ¯ä¸ªæ˜ŸæœŸéƒ½ä¸æ–­æå‡ã€‚</p>
<ul>
<li>è§£å†³åï¼š</li>
</ul>
<p>ä¸»è¦è§£å†³äº†å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒç‹¬ç«‹ï¼Œä¸ä¼šäº’ç›¸å½±å“ï¼Œæµ‹è¯•äººå‘˜æœ‰å•ç‹¬ç¯å¢ƒå»æµ‹è¯•ç”Ÿäº§èƒ½å‡†ç¡®çš„æ•°æ®å¯¹æ¯”ã€‚</p>
<h4 id="é€‰æ‹©ç°åº¦ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š"><a href="#é€‰æ‹©ç°åº¦ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š" class="headerlink" title="é€‰æ‹©ç°åº¦ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š"></a>é€‰æ‹©ç°åº¦ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š</h4><p>å…ˆè´´ä¸ªç™¾åº¦ç™¾ç§‘ï¼š</p>
<p>ç°åº¦å‘å¸ƒæ˜¯æŒ‡åœ¨é»‘ä¸ç™½ä¹‹é—´ï¼Œèƒ½å¤Ÿå¹³æ»‘è¿‡æ¸¡çš„ä¸€ç§å‘å¸ƒæ–¹å¼ã€‚AB testå°±æ˜¯ä¸€ç§ç°åº¦å‘å¸ƒæ–¹å¼ï¼Œè®©ä¸€éƒ¨åˆ†ç”¨æˆ·ç»§ç»­ç”¨Aï¼Œä¸€éƒ¨åˆ†ç”¨æˆ·å¼€å§‹ç”¨Bï¼Œå¦‚æœç”¨æˆ·å¯¹Bæ²¡æœ‰ä»€ä¹ˆåå¯¹æ„è§ï¼Œé‚£ä¹ˆé€æ­¥æ‰©å¤§èŒƒå›´ï¼ŒæŠŠæ‰€æœ‰ç”¨æˆ·éƒ½è¿ç§»åˆ°Bä¸Šé¢æ¥ã€‚ç°åº¦å‘å¸ƒå¯ä»¥ä¿è¯æ•´ä½“ç³»ç»Ÿçš„ç¨³å®šï¼Œåœ¨åˆå§‹ç°åº¦çš„æ—¶å€™å°±å¯ä»¥å‘ç°ã€è°ƒæ•´é—®é¢˜ï¼Œä»¥ä¿è¯å…¶å½±å“åº¦ã€‚</p>
<p>ç°åº¦ç¯å¢ƒéƒ¨ç½²:</p>
<p>ä¸ªäººç†è§£ç°åº¦éƒ¨ç½²æ˜¯å¢é‡å‘å¸ƒçš„ä¸€ç§ç±»å‹ï¼Œå®ƒçš„æ‰§è¡Œæ–¹å¼æ˜¯åœ¨åŸæœ‰è½¯ä»¶ç”Ÿäº§ç‰ˆæœ¬å¯ç”¨çš„æƒ…å†µä¸‹ï¼ŒåŒæ—¶éƒ¨ç½²ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ã€‚åŒæ—¶è¿è¡ŒåŒä¸€ä¸ªè½¯ä»¶äº§å“çš„å¤šä¸ªç‰ˆæœ¬éœ€è¦è½¯ä»¶é’ˆå¯¹é…ç½®å’Œå®Œç¾è‡ªåŠ¨åŒ–éƒ¨ç½²è¿›è¡Œç‰¹åˆ«è®¾è®¡ã€‚</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">(1)</span> å‡†å¤‡å¥½éƒ¨ç½²å„ä¸ªé˜¶æ®µçš„å·¥ä»¶ï¼ŒåŒ…æ‹¬ï¼šæ„å»ºå·¥ä»¶ï¼Œæµ‹è¯•è„šæœ¬ï¼Œé…ç½®æ–‡ä»¶å’Œéƒ¨ç½²æ¸…å•æ–‡ä»¶ã€‚</div><div class="line"><span class="comment">(2)</span> ä»è´Ÿè½½å‡è¡¡åˆ—è¡¨ä¸­ç§»é™¤æ‰â€œéƒ¨ç½²ç°åº¦ç¯å¢ƒâ€æœåŠ¡å™¨ã€‚</div><div class="line"><span class="comment">(3)</span> å‡çº§â€œç°åº¦éƒ¨ç½²â€åº”ç”¨ï¼ˆæ’æ‰åŸæœ‰æµé‡å¹¶è¿›è¡Œéƒ¨ç½²ï¼‰ã€‚</div><div class="line"><span class="comment">(4)</span> å¯¹åº”ç”¨è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚</div><div class="line"><span class="comment">(5)</span> å°†â€œç°åº¦ç¯å¢ƒâ€æœåŠ¡å™¨é‡æ–°æ·»åŠ åˆ°è´Ÿè½½å‡è¡¡åˆ—è¡¨ä¸­ï¼ˆè¿é€šæ€§å’Œå¥åº·æ£€æŸ¥ï¼‰ã€‚</div><div class="line"><span class="comment">(6)</span> å¦‚æœâ€œç°åº¦ç¯å¢ƒâ€åœ¨çº¿ä½¿ç”¨æµ‹è¯•æˆåŠŸï¼Œå‡çº§å‰©ä½™çš„å…¶ä»–æœåŠ¡å™¨ã€‚ï¼ˆå¦åˆ™å°±å›æ»šï¼‰</div><div class="line">ç°åº¦å‘å¸ƒä¸­ï¼Œå¸¸å¸¸æŒ‰ç…§ç”¨æˆ·è®¾ç½®è·¯ç”±æƒé‡ï¼Œä¾‹å¦‚<span class="number">90</span><span class="meta">%</span>çš„ç”¨æˆ·ç»´æŒä½¿ç”¨è€ç‰ˆæœ¬ï¼Œ<span class="number">10</span><span class="meta">%</span>çš„ç”¨æˆ·å°é²œæ–°ç‰ˆæœ¬ã€‚ä¸åŒç‰ˆæœ¬åº”ç”¨å…±å­˜ï¼Œç»å¸¸ä¸A/Bæµ‹è¯•ä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºæµ‹è¯•é€‰æ‹©å¤šç§æ–¹æ¡ˆã€‚ç°åº¦å‘å¸ƒæ¯”è¾ƒå…¸å‹çš„ä¾‹å­</div></pre></td></tr></table></figure>
<p>ç¬¬1æ­¥: æŠŠç»¿è‰²é›†ç¾¤çš„çŠ¶æ€æ”¹ä¸ºâ€™å¤‡ç”¨â€™. ä»è´Ÿè½½å‡è¡¡çš„æ± é‡ŒæŠŠè¿™äº›åœ°å€å»æ‰,è¿™æ ·,ç»¿è‰²çš„é›†ç¾¤å°±ä¸å†å›æ¥æ”¶åˆ°æ¥è‡ªç”¨æˆ·çš„è¯·æ±‚äº†.è½¬è€Œè¿›å…¥å¤‡ç”¨è´Ÿè½½å‡è¡¡çš„æ± é‡Œ.</p>
<h3 id="é€‰æ‹©è“ç»¿ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š"><a href="#é€‰æ‹©è“ç»¿ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š" class="headerlink" title="é€‰æ‹©è“ç»¿ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š"></a>é€‰æ‹©è“ç»¿ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆï¼š</h3><h5 id="è“ç»¿å‘å¸ƒçš„æ„ä¹‰"><a href="#è“ç»¿å‘å¸ƒçš„æ„ä¹‰" class="headerlink" title="è“ç»¿å‘å¸ƒçš„æ„ä¹‰"></a>è“ç»¿å‘å¸ƒçš„æ„ä¹‰</h5><p>æ•´ä¸ªå‘å¸ƒè¿‡ç¨‹ï¼Œç”¨æˆ·æ²¡æœ‰æ„Ÿå—åˆ°ä»»ä½•å®•æœºæˆ–è€…æœåŠ¡é‡å¯ã€‚</p>
<h5 id="è“ç»¿å‘å¸ƒçš„è¿‡ç¨‹"><a href="#è“ç»¿å‘å¸ƒçš„è¿‡ç¨‹" class="headerlink" title="è“ç»¿å‘å¸ƒçš„è¿‡ç¨‹"></a>è“ç»¿å‘å¸ƒçš„è¿‡ç¨‹</h5><ul>
<li>ç¬¬0æ­¥:éƒ¨ç½²ä»¥å‰çš„é…ç½®<br><figure class="figure"><img src="http://1.bp.blogspot.com/-K8gbbN7S_xo/UmbijDyvS4I/AAAAAAAAE5M/3DCOJRrrbIY/s1600/Blue+Green+Deployment+for+Zero+Downtime+(8" alt=""></figure>.png)</li>
<li>ç¬¬1æ­¥: æŠŠç»¿è‰²é›†ç¾¤çš„çŠ¶æ€æ”¹ä¸ºâ€™å¤‡ç”¨â€™. ä»è´Ÿè½½å‡è¡¡çš„æ± é‡ŒæŠŠè¿™äº›åœ°å€å»æ‰,è¿™æ ·,ç»¿è‰²çš„é›†ç¾¤å°±ä¸å†å›æ¥æ”¶åˆ°æ¥è‡ªç”¨æˆ·çš„è¯·æ±‚äº†.è½¬è€Œè¿›å…¥å¤‡ç”¨è´Ÿè½½å‡è¡¡çš„æ± é‡Œ.<br><figure class="figure"><img src="http://1.bp.blogspot.com/-nITj_nPp5IY/UmbiuMblJNI/AAAAAAAAE5U/ovn4sSMcFco/s1600/Blue+Green+Deployment+for+Zero+Downtime+(9" alt=""></figure>.png)</li>
<li>ç¬¬2æ­¥:åœ¨ç»¿è‰²é›†ç¾¤é‡Œéƒ¨ç½²æ–°çš„ä»£ç ,ç›´åˆ°åº”ç”¨å¯åŠ¨æˆåŠŸ<br><figure class="figure"><img src="http://3.bp.blogspot.com/-2F2dB-vux4g/UmbheBwtcAI/AAAAAAAAE5E/1l9il1igplQ/s1600/Blue+Green+Deployment+for+Zero+Downtime+(4" alt=""></figure>.png)</li>
<li>ç¬¬3æ­¥:ä½¿ç”¨å¤‡ç”¨è´Ÿè½½å‡è¡¡ç®€å•æµ‹è¯•ä¸€ä¸‹å¤‡ç”¨é›†ç¾¤çš„éƒ¨ç½²æƒ…å†µ.ç†æƒ³çŠ¶æ€ä¸‹æ˜¯å…¨è‡ªåŠ¨çš„.</li>
<li>ç¬¬4æ­¥:æŠŠç»¿è‰²å¤‡ç”¨é›†ç¾¤çš„çŠ¶æ€æ”¹æˆå­˜è´§,äºæ˜¯è¿›å…¥äº†å­˜æ´»è´Ÿè½½å‡è¡¡çš„æ± é‡Œ<br><figure class="figure"><img src="http://3.bp.blogspot.com/-2F2dB-vux4g/UmbheBwtcAI/AAAAAAAAE5E/1l9il1igplQ/s1600/Blue+Green+Deployment+for+Zero+Downtime+(4" alt=""></figure>.png)<br>çœ‹åˆ° è“è‰²è¿è¡Œv1ç‰ˆæœ¬,ç»¿è‰²è¿è¡Œv2ç‰ˆæœ¬,éƒ½è¿æ¥çš„æ˜¯ç›¸åŒçš„æ•°æ®åº“.è¿™æ„å‘³ç€v2ç‰ˆæœ¬ä¹Ÿè¦åœ¨è€çš„æ•°æ®æ¨¡å‹ä¸Šè¿è¡Œ.å¦‚æœæ•°æ®åº“æœ‰å˜æ›´,è¦ç­‰åˆ°æ‰€æœ‰çš„é›†ç¾¤å‡çº§åˆ°æ–°çš„ä»£ç ä¸Š.</li>
<li><p>ç¬¬5æ­¥: å¯¹è“è‰²é›†ç¾¤ä¹Ÿè¿›è¡ŒåŒæ ·çš„æ“ä½œ.<br><figure class="figure"><img src="http://4.bp.blogspot.com/-aTz1EdP6pb0/UmbjAx46vrI/AAAAAAAAE5c/qqxolMnae44/s640/Blue+Green+Deployment+for+Zero+Downtime+(5" alt=""></figure>.png)<br><figure class="figure"><img src="http://3.bp.blogspot.com/-95YNOBeYoUU/UmbjFq711dI/AAAAAAAAE5k/Q5Naa80xk64/s640/Blue+Green+Deployment+for+Zero+Downtime+(6" alt=""></figure>.png)</p>
</li>
<li><p>æœ€ç»ˆv2ä»£ç å®Œæˆéƒ¨ç½².<br><figure class="figure"><img src="http://2.bp.blogspot.com/-eh1gR1sBPNc/UmbjMkDCixI/AAAAAAAAE5s/vJOeYjV03vI/s640/Blue+Green+Deployment+for+Zero+Downtime+(7" alt=""></figure>.png)</p>
</li>
<li><p>ç¬¬6æ­¥:æ ¹æ®æƒ…å†µ.è¿è¡Œæ•°æ®åº“è¿ç§»</p>
</li>
</ul>
<p>å‚è€ƒï¼štks   <a href="http://sunitspace.blogspot.jp/2013/10/blue-green-deployment.html" target="_blank" rel="external">green-deployment</a></p>
<h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p>1) è“ç»¿éƒ¨ç½²ï¼šä¸åœæ­¢è€ç‰ˆæœ¬ï¼Œé¢å¤–æä¸€å¥—æ–°ç‰ˆæœ¬ï¼Œç­‰æµ‹è¯•å‘ç°æ–°ç‰ˆæœ¬OKåï¼Œåˆ é™¤è€ç‰ˆæœ¬ã€‚å…¶å®è¿™é‡Œåˆ é™¤è€ç‰ˆæœ¬ä¹Ÿå°±æ˜¯é‡æ–°éƒ¨ç½²äº†è€ç‰ˆæœ¬æˆä¸ºæ–°ç‰ˆæœ¬ä¸€èµ·æ”¾ä¸Šå»ï¼Œç­‰éœ€è¦æ›´æ–°å‘å¸ƒè¿ä¸‹æœŸä¸­ä¸€ä¸ªç‰ˆæœ¬ç¯å¢ƒéƒ¨ç½²ï¼šç°åœ¨æˆ‘ä»¬å…¬å¸ä½¿ç”¨è“ç»¿éƒ¨ç½²æ–¹æ¡ˆã€‚</p>
<p>3) ç°åº¦å‘å¸ƒï¼šä¸åœæ­¢è€ç‰ˆæœ¬ï¼Œé¢å¤–æä¸€å¥—æ–°ç‰ˆæœ¬ï¼Œå¸¸å¸¸æŒ‰ç…§ç”¨æˆ·è®¾ç½®è·¯ç”±æƒé‡ï¼Œä¾‹å¦‚90%çš„ç”¨æˆ·ç»´æŒä½¿ç”¨è€ç‰ˆæœ¬ï¼Œ10%çš„ç”¨æˆ·å°é²œæ–°ç‰ˆæœ¬ã€‚ä¸åŒç‰ˆæœ¬åº”ç”¨å…±å­˜ï¼Œç»å¸¸ä¸A/Bæµ‹è¯•ä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºæµ‹è¯•é€‰æ‹©å¤šç§æ–¹æ¡ˆã€‚</p>
<h3 id="å…¶å®ä¸¤ç§å«ä¹‰ä¸ªäººè®¤ä¸ºç›¸å·®ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œéƒ½ç‰¹åˆ«é€‚åˆç°åœ¨å‘å¸ƒéƒ¨ç½²æµç¨‹æ–¹æ¡ˆã€‚"><a href="#å…¶å®ä¸¤ç§å«ä¹‰ä¸ªäººè®¤ä¸ºç›¸å·®ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œéƒ½ç‰¹åˆ«é€‚åˆç°åœ¨å‘å¸ƒéƒ¨ç½²æµç¨‹æ–¹æ¡ˆã€‚" class="headerlink" title="å…¶å®ä¸¤ç§å«ä¹‰ä¸ªäººè®¤ä¸ºç›¸å·®ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œéƒ½ç‰¹åˆ«é€‚åˆç°åœ¨å‘å¸ƒéƒ¨ç½²æµç¨‹æ–¹æ¡ˆã€‚"></a>å…¶å®ä¸¤ç§å«ä¹‰ä¸ªäººè®¤ä¸ºç›¸å·®ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œéƒ½ç‰¹åˆ«é€‚åˆç°åœ¨å‘å¸ƒéƒ¨ç½²æµç¨‹æ–¹æ¡ˆã€‚</h3><h3 id="äº¤æµå­¦ä¹ ï¼š"><a href="#äº¤æµå­¦ä¹ ï¼š" class="headerlink" title="äº¤æµå­¦ä¹ ï¼š"></a>äº¤æµå­¦ä¹ ï¼š</h3><p>ğŸ§  Linux shell_é«˜çº§è¿ç»´æ´¾: <code>459096184</code>    åœˆå­ (ç³»ç»Ÿè¿ç»´-åº”ç”¨è¿ç»´-è‡ªåŠ¨åŒ–è¿ç»´-è™šæ‹ŸåŒ–æŠ€æœ¯ç ”ç©¶æ¬¢è¿åŠ å…¥)<br>ğŸ§  BigData-Exchange School : <code>521621407</code>  åœˆå­ï¼ˆå¤§æ•°æ®è¿ç»´)ï¼ˆHadoopå¼€å‘äººå‘˜)ï¼ˆå¤§æ•°æ®ç ”ç©¶çˆ±å¥½è€…) æ¬¢è¿åŠ å…¥</p>
<p>ç›¸åº”Bidataæœ‰å†…éƒ¨å¾®ä¿¡äº¤æµç¾¤äº’ç›¸å­¦ä¹ ï¼ŒåŠ å…¥QQç¾¤æœ‰é“¾æ¥ã€‚</p>

	

	

</article>





	<span class="different-posts">ğŸ“– <a href="/page/4">more posts</a> ğŸ“–</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<h5>Hi there,</h5>
	<p style="text-align:justify;">my name is Yancy, they know me as RadiantğŸ‘ğŸ‘. This blog is about Bi-data and my live.<br> I like ğŸŒ³ğŸŒ³ğŸŒ³</p>
</div>


	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>Â© 2017 Yancy | Powered by <a href="http://blog.yancy.cc/">Yancy</a> | Theme <a href="https://github.com/yangcvo">Yancy_GitHub</a></span>
		</div>

	</div>


</footer>



</body>

</html>
