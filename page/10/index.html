<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Yancy&#39;s blog</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="Yancy&#39;s blog" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link">Home</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/archives" class="header__link">ARCHIVES</a>
			
				<a href="/about/About" class="header__link">ABOUT</a>
			
				<a href="http://weibo.com/yangcvo" class="header__link">Weibo</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Yancy&#39;s blog</a></h1>
		<h2 class="header__subtitle">SIMPLICITY IS PREREQUISITE FOR  RELIABILITY</h2>
	</header>

	<main>
		
	<span class="different-posts different-posts_earlier">📖 <a href="/page/9">earlier posts</a> 📖</span>




	<article>
	
		<h1><a href="/2015/12/10/自动化+Jenkins/saltstack/服务自动化部署平台之Saltstack总结/">自动化运维工具-服务自动化部署平台之Saltstack总结</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-12-10</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Automation/">Automation</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Saltstack/">Saltstack</a>
			</span>
		
	</div>

	

	
		<h1 id="服务自动化部署平台之Saltstack总结"><a href="#服务自动化部署平台之Saltstack总结" class="headerlink" title="服务自动化部署平台之Saltstack总结"></a>服务自动化部署平台之Saltstack总结</h1><p>Saltstack是一个新的基础设施管理工具。目前处于快速发展阶段，可以看做是强化的Func+弱化的Puppet的组合。间接的反映出了saltstack的两大功能：远程执行和配置管理。</p>
<p>SaltStack 保持了输入、输出、配置文件的一致性，所有文件均使用YAML格式。主要负责配置管理和远程执行（在远程主机运行预定义或任意的命令，也叫远程执行，这是 Salt的核心功能。接下来的链接展示了模块（module）和返回器（returner），这是远程执行的关键所在。）</p>
<p>Salt是基于python写的经典C/S框架的自动化部署平台。由Master和Minion构成，通过ZeroMQ进行通信。</p>
<p>Master与Minion认证</p>
<p>1.minion 在第一次启动时，会在/etc/salt/pki/minion/（该路径在/etc/salt/minion里面设置）下自动生成 minion.pem(private key)和minion.pub(public key)，然后将minion.pub发送给master。</p>
<p>2.master 在接收到minion的public key后，通过salt-key命令accept minion public key，这样在master的/etc/salt/pki/master/minions下的将会存放以minion id命名的public key, 然后master就能对minion发送指令了。</p>
<p>Master与Minion的连接</p>
<p>Saltstack master启动后默认监听4505和4506两个端口。4505(publish_port)为salt的消息发布系统，4506(ret_port) 为salt客户端与服务端通信的端口。如果使用lsof查看4505端口，会发现所有的Minion在4505端口持续保持在ESTABLISHED</p>
<p>参考文档:</p>
<p><a href="http://blog.javachen.com/2013/11/18/study-note-of-saltstack/" target="_blank" rel="external">http://blog.javachen.com/2013/11/18/study-note-of-saltstack/</a>   经典搭建框架<br><a href="http://www.linuxyw.com/179.html" target="_blank" rel="external">http://www.linuxyw.com/179.html</a>                                                  salt搭建参考</p>
<p><a href="http://blog.halfss.com/blog/2013/05/22/yun-wei-zi-dong-hua-zhi-saltxue-xi-bi-ji/" target="_blank" rel="external">http://blog.halfss.com/blog/2013/05/22/yun-wei-zi-dong-hua-zhi-saltxue-xi-bi-ji/</a></p>
<h3 id="salt的安装："><a href="#salt的安装：" class="headerlink" title="salt的安装："></a>salt的安装：</h3><blockquote>
<p>master端：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#yum install salt-master -y                         salt主控端安装</span></div><div class="line"><span class="comment">#vim /etc/salt/master                                salt主配置文件修改</span></div><div class="line">interface: 服务监听IP</div><div class="line">auto_accept: True（可选，key通过‘salt-key <span class="_">-a</span> keyname’命令手动进行认证）</div><div class="line">注意：keyname 就是客户端中设置的id标识(可以查看salt-minion端的配置)</div><div class="line"></div><div class="line"><span class="comment">#salt-master -l debug                                   debug模式，查看salt都进行哪些操作</span></div><div class="line"><span class="comment">#/etc/init.d/salt-master restart                     重启salt服务</span></div><div class="line"><span class="comment">#/etc/init.d/salt-master status                      查看状态</span></div><div class="line"></div><div class="line"><span class="comment">#netstat -antlp | grep 4505                            确保消息发布端口正常</span></div><div class="line"><span class="comment">#netstat -antlp | grep 4506                            确保客户端与服务端通信端口正常</span></div><div class="line"></div><div class="line"><span class="comment">#/etc/init.d/salt-master restart</span></div><div class="line"><span class="comment"># /etc/init.d/salt-master status</span></div><div class="line"></div><div class="line"><span class="comment"># salt-key                                                      查看认证相关信息</span></div><div class="line"><span class="comment"># salt-key -a wy-pe2                                     手动添加认证key(给wy-pe2主机添加认证)</span></div><div class="line"></div><div class="line"><span class="comment">#iptables -F                                                   关闭防火墙以免影响认证</span></div><div class="line"><span class="comment">#salt-key -a wy-pe2</span></div><div class="line"><span class="comment">#salt-key -L                                                   查看认证信息(会有显示已经认证和未认证的相关信息)</span></div><div class="line">[root@wy-pe1 ~]<span class="comment"># salt-key -L</span></div><div class="line">Accepted Keys:</div><div class="line">wy-pe2                                                                已经允许的key(表示wy-pe2已经允许认证了)</div><div class="line">Unaccepted Keys:</div><div class="line">Rejected Keys:</div><div class="line"></div><div class="line"><span class="comment">#cd /etc/salt/pki/master/minions                            在master中的minions目录中生成认证的key</span></div><div class="line"><span class="comment">#setenforce 0                                                            暂时关闭selinux</span></div><div class="line"><span class="comment">#/etc/init.d/salt-master restart</span></div><div class="line"></div><div class="line">执行远程命令(使用salt内建的模块):</div><div class="line"><span class="comment">#salt ‘wy-pe2′ test.ping                                            测试master和minion进行通信(在master端进行ping响应测试)</span></div><div class="line">[root@wy-pe1 ~]<span class="comment"># salt ‘wy-pe2′ test.ping                如果能ping通，则为True</span></div><div class="line">wy-pe2:</div><div class="line">True</div><div class="line"></div><div class="line"><span class="comment">#lsof -i:4505                                                               查看到minion端都和4505保持建立</span></div><div class="line">[root@wy-pe1 ~]<span class="comment"># lsof -i:4505</span></div><div class="line">COMMAND    PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</div><div class="line">salt-mast 8568 root   12u  IPv4  63217      0t0  TCP *:4505 (LISTEN)</div><div class="line">salt-mast 8568 root   14u  IPv4  65101      0t0  TCP wy-pe1:4505-&gt;wy-pe2:51237 (ESTABLISHED)(表示建立连接了)</div><div class="line">注意:如果认证那块没做好，就会影响相关的链接</div></pre></td></tr></table></figure>
<h2 id="Salt客户端安装："><a href="#Salt客户端安装：" class="headerlink" title="Salt客户端安装："></a>Salt客户端安装：</h2><blockquote>
<p>minion端安装配置：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#yum install salt-minion -y</span></div><div class="line"><span class="comment">#vim /etc/salt/minion                                                修改minion客户端主配置</span></div><div class="line">master: 服务端主机名</div><div class="line">id: 客户端主机名(其实也就是认证key的名字)                用来和master进行认证</div><div class="line"><span class="comment">#/etc/init.d/salt-minion restart                             重启服务</span></div><div class="line"><span class="comment">#cd /etc/salt/pki/minion/                                    在这个目录底下会生成两个认证文件(minion.pub minion.pem)</span></div><div class="line"></div><div class="line">salt-minion端不能正常启动的解决步骤:（一般就是iptables和selinux的影响）</div><div class="line"><span class="comment">#/etc/init.d/salt-minion restart</span></div><div class="line"><span class="comment"># tail -f /var/log/messages</span></div><div class="line"><span class="comment">#/etc/init.d/salt-minion restart</span></div><div class="line"><span class="comment">#iptables -F</span></div><div class="line"><span class="comment">#tail -f /var/log/salt/minion</span></div><div class="line"><span class="comment">#salt-minion -l debug</span></div><div class="line"><span class="comment">#setenforce 0</span></div><div class="line"><span class="comment">#/etc/init.d/salt-minion restart</span></div><div class="line"></div><div class="line"></div><div class="line">安装完毕，在master和minion认证完毕之后会在minion主机上的/etc/salt/pki/minion/目录底下生成新的minion_master.pub</div><div class="line"></div><div class="line">问题1：档master和minion进行认证的时候，master没有接收到public key(minion)</div><div class="line">(这个在后来的链接过程中会造成master和minion不能链接)</div><div class="line"></div><div class="line">问题2：辅机salt-minion总是在查看服务状态的时候显示失败(but pid exits！)</div><div class="line"><span class="comment"># salt-minion -l debug 查看salt客户端详细信息</span></div></pre></td></tr></table></figure>
<h2 id="salt的简单使用："><a href="#salt的简单使用：" class="headerlink" title="salt的简单使用："></a>salt的简单使用：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">salt可以直接让minion执行模块命令，也可以直接执行shell命令</div><div class="line">1.salt -C ‘wy-pe1 and wy-pe2 or wy-peN’ test.ping        -C表示多参数(表示在测试多台主机的存活状态)</div><div class="line"><span class="comment"># salt ‘*’ disk.usage                                                                查看磁盘使用情况(使用内建模块查看所有minion端的磁盘使用情况)</span></div><div class="line"><span class="comment">#salt ‘*’ cmd.run ‘df -h’                                                          使用cmd.run直接调用远程shell命令(功能同上)</span></div><div class="line"><span class="comment"># salt ‘*’ cmd.run “cat /root/lall”                                            查看客户端主机的/root/lall文件</span></div></pre></td></tr></table></figure>
<h3 id="2-nodegroup对minion进行分组："><a href="#2-nodegroup对minion进行分组：" class="headerlink" title="2.nodegroup对minion进行分组："></a>2.nodegroup对minion进行分组：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">nodegroups:</div><div class="line">group1: ‘L@foo.domain.com,bar.domain.com,baz.domain.com or bl*.domain.com’</div><div class="line">group2: ‘G@os :Debian and foo.domain.com’</div><div class="line"></div><div class="line">group3:’wy-pe2′</div><div class="line">进行分组测试：</div><div class="line"><span class="comment"># salt -N group3 test.ping</span></div><div class="line">wy-pe2:</div><div class="line">True</div></pre></td></tr></table></figure>
<h3 id="3-grains对minion基本信息的管理："><a href="#3-grains对minion基本信息的管理：" class="headerlink" title="3.grains对minion基本信息的管理："></a>3.grains对minion基本信息的管理：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">salt ‘wy-pe2′ grins.ls                                                            查看grains分类</div><div class="line">salt ‘wy-pe2′ grins.items                                                      查看minnon基本信息(硬件参数)</div></pre></td></tr></table></figure>
<p>###4.pillar对敏感信息的管理，只有匹配到的节点才能获取和使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">默认pillar数据定义文件存储路径:/srv/pillar</div><div class="line"></div><div class="line">状态管理：</div><div class="line">1.salt基于minion进行状态的管理(state)</div><div class="line">类似于pupet的pp文件功能，salt的state文件扩展文件名为.sls,采用的是和puppet一样的设计思路。即以master</div><div class="line">端的文件状态来确定minion端的一些状态信息设置。(安装的软件包，服务的运行状态以及需要同步的文件配置)</div><div class="line">注意：salt默认的根目录在/srv/salt中，如果没有需要进行建立。</div><div class="line"></div><div class="line">top.sls：这个文件类似于puppet的site.pp文件，作为“最高同步”操作的入口文件，执行“最高同步”操作时，将从此sls文件中获取状态对minion进行同步</div><div class="line"></div><div class="line">示例：(注意，salt文件完全采用ymal格式，对代码的缩进有着严格的要求)</div><div class="line"><span class="comment">#vim /srv/salt/servers_package.sls</span></div><div class="line">httpd:                            项目名</div><div class="line">pkg:                              类型</div><div class="line">– installed                    动作(表示安装httpd包)</div><div class="line">service:</div><div class="line">– running</div><div class="line">– <span class="built_in">enable</span>:True</div><div class="line">vim-enhanced:</div><div class="line">pkg:</div><div class="line">– installed</div><div class="line">tomcat环境</div><div class="line">openjdk-7-jdk:</div><div class="line">pkg:</div><div class="line">– installed</div><div class="line">tomcat7:</div><div class="line">pkg:</div><div class="line">– installed</div><div class="line">– require:</div><div class="line">– pkg: openjdk-7-jdk</div><div class="line"></div><div class="line"><span class="comment"># salt ‘wy-pe2′ state.sls servers_package              按照sls文件中的配置对wy-pe2进行服务配置</span></div></pre></td></tr></table></figure>
<h4 id="管理配置文件"><a href="#管理配置文件" class="headerlink" title="管理配置文件"></a>管理配置文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">httpd:</div><div class="line">pkg:</div><div class="line">– installed</div><div class="line">file.managed:                                文件管理(文件同步操作)</div><div class="line">– name: /etc/httpd/conf/httpd.conf</div><div class="line">– <span class="built_in">source</span>: salt://httpd/httpd.conf</div><div class="line"></div><div class="line"><span class="comment"># salt ‘wy-pe2′ state.highstate                                应用修改(给minion永久添加状态)</span></div><div class="line"></div><div class="line">3.使用salt schedule对minion进行实时更新，让minion自觉的保持某个状态</div><div class="line"></div><div class="line">4.实时管理</div><div class="line">有时候我们需要临时的查看某个机器上的某个文件，或者执行某个命令</div><div class="line"></div><div class="line">cmd.run方式：(salt ‘<span class="variable">$targeting</span>’ cmd.run ‘<span class="variable">$cmd</span>’)用来远程执行shell命令</div><div class="line"><span class="comment"># salt ‘wy-pe2′ cmd.run ‘ifconfig eth0′           查看某台主机的网络接口</span></div><div class="line"></div><div class="line">cmd.script方式：可以向远程主机执行脚本</div><div class="line"><span class="comment">#salt ‘*’ cmd.script salt://useradd.sh               向minion主机上执行useradd.sh脚本(salt://是salt的默认发布目录，即/srv/salt)</span></div><div class="line"></div><div class="line">pkg.install方式：制定主机安装软件</div><div class="line"><span class="comment">#salt ‘wy-pe2′ pkg.install vsftpd                     指定主机安装软件</span></div><div class="line"></div><div class="line"><span class="comment"># salt ‘*’ network.interfaces                            查看远程主机接口</span></div><div class="line"></div><div class="line"><span class="comment"># salt-cp ‘wy-pe2′ salt-cmd /home/xxb2        复制文件到指定的系统上(当前目录的salt-cmd)</span></div><div class="line">salt是主命令，一般用来执行命令模块。</div><div class="line">salt-cp用来复制文件到制定的系统上去</div><div class="line">salt-key用来和minion之间进行身份验证</div><div class="line">salt-master为服务端的主守护进程用于控制minion</div><div class="line">salt-run为前端命令执行</div><div class="line"></div><div class="line">module方式：(模块查看方式<span class="comment">#salt ‘*’ sys.doc)</span></div><div class="line"></div><div class="line"><span class="comment">#salt ‘*’ disk.usage                                    查看磁盘使用情况</span></div><div class="line"><span class="comment"># salt ‘*’ grains.item os/osrelease/oscodename</span></div><div class="line"><span class="comment"># salt ‘*’ user(group).info xxb2</span></div><div class="line"><span class="comment"># salt ‘*’ ip.get_interface eth0</span></div><div class="line"><span class="comment">#salt ‘*’ lvm.vgdisplay</span></div></pre></td></tr></table></figure>
<h4 id="salt相关管理命令："><a href="#salt相关管理命令：" class="headerlink" title="salt相关管理命令："></a>salt相关管理命令：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">salt-run manage.up                 查看存活的minion</div><div class="line">salt-run manage.down            查看死掉的minion</div><div class="line">salt-run manage.down removekeys=True    查看down掉的minion，并将其删除</div><div class="line">salt-run manage.status            查看minion的相关状态</div><div class="line">salt-run manage.versions        查看slat的所有master和minion的版本信息</div></pre></td></tr></table></figure>
<h2 id="附录："><a href="#附录：" class="headerlink" title="附录："></a>附录：</h2><h4 id="salt详细使用命令"><a href="#salt详细使用命令" class="headerlink" title="salt详细使用命令"></a>salt详细使用命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div><div class="line">915</div><div class="line">916</div><div class="line">917</div><div class="line">918</div><div class="line">919</div><div class="line">920</div><div class="line">921</div><div class="line">922</div><div class="line">923</div><div class="line">924</div><div class="line">925</div><div class="line">926</div><div class="line">927</div><div class="line">928</div><div class="line">929</div><div class="line">930</div><div class="line">931</div><div class="line">932</div><div class="line">933</div><div class="line">934</div><div class="line">935</div><div class="line">936</div><div class="line">937</div><div class="line">938</div><div class="line">939</div><div class="line">940</div><div class="line">941</div><div class="line">942</div><div class="line">943</div><div class="line">944</div><div class="line">945</div><div class="line">946</div><div class="line">947</div><div class="line">948</div><div class="line">949</div><div class="line">950</div><div class="line">951</div><div class="line">952</div><div class="line">953</div><div class="line">954</div><div class="line">955</div><div class="line">956</div><div class="line">957</div><div class="line">958</div><div class="line">959</div><div class="line">960</div><div class="line">961</div><div class="line">962</div><div class="line">963</div><div class="line">964</div><div class="line">965</div><div class="line">966</div><div class="line">967</div><div class="line">968</div><div class="line">969</div><div class="line">970</div><div class="line">971</div><div class="line">972</div><div class="line">973</div><div class="line">974</div><div class="line">975</div><div class="line">976</div><div class="line">977</div><div class="line">978</div><div class="line">979</div><div class="line">980</div><div class="line">981</div><div class="line">982</div><div class="line">983</div><div class="line">984</div><div class="line">985</div><div class="line">986</div><div class="line">987</div><div class="line">988</div><div class="line">989</div><div class="line">990</div><div class="line">991</div><div class="line">992</div><div class="line">993</div><div class="line">994</div><div class="line">995</div><div class="line">996</div><div class="line">997</div><div class="line">998</div><div class="line">999</div><div class="line">1000</div><div class="line">1001</div><div class="line">1002</div><div class="line">1003</div><div class="line">1004</div><div class="line">1005</div><div class="line">1006</div><div class="line">1007</div><div class="line">1008</div><div class="line">1009</div><div class="line">1010</div><div class="line">1011</div><div class="line">1012</div><div class="line">1013</div><div class="line">1014</div><div class="line">1015</div><div class="line">1016</div><div class="line">1017</div><div class="line">1018</div><div class="line">1019</div><div class="line">1020</div><div class="line">1021</div><div class="line">1022</div><div class="line">1023</div><div class="line">1024</div><div class="line">1025</div><div class="line">1026</div><div class="line">1027</div><div class="line">1028</div><div class="line">1029</div><div class="line">1030</div><div class="line">1031</div><div class="line">1032</div><div class="line">1033</div><div class="line">1034</div></pre></td><td class="code"><pre><div class="line">salt ‘*’ acl.delfacl user myuser /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.delfacl default:group mygroup /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.delfacl d:u myuser /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.delfacl g myuser /tmp/house/kitchen /tmp/house/livingroom</div><div class="line">salt ‘*’ acl.getfacl /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.getfacl /tmp/house/kitchen /tmp/house/livingroom</div><div class="line">salt ‘*’ acl.addfacl user myuser rwx /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.addfacl default:group mygroup rx /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.addfacl d:u myuser 7 /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.addfacl g mygroup 0 /tmp/house/kitchen /tmp/house/livingroom</div><div class="line">salt ‘*’ acl.version</div><div class="line">salt ‘*’ acl.wipefacls /tmp/house/kitchen</div><div class="line">salt ‘*’ acl.wipefacls /tmp/house/kitchen /tmp/house/livingroom</div><div class="line">salt ‘*’ aliases.get_target <span class="built_in">alias</span></div><div class="line">salt ‘*’ aliases.has_target <span class="built_in">alias</span> target</div><div class="line">salt ‘*’ aliases.list_aliases</div><div class="line">salt ‘*’ aliases.rm_alias <span class="built_in">alias</span></div><div class="line">salt ‘*’ aliases.set_target <span class="built_in">alias</span> target</div><div class="line">salt ‘*’ alternatives.auto name</div><div class="line">salt ‘*’ alternatives.check_installed name path</div><div class="line">salt ‘*’ alternatives.display editor</div><div class="line">salt ‘*’ alternatives.install editor /usr/bin/editor /usr/bin/emacs23 50</div><div class="line">salt ‘*’ alternatives.remove name path</div><div class="line">salt ‘*’ alternatives.set name path</div><div class="line">salt ‘*’ alternatives.show_current editor</div><div class="line">salt ‘*’ apache.config /etc/httpd/conf.d/ports.conf                 config=”[&#123;‘Listen<span class="string">': ’22’&#125;]”</span></div><div class="line">salt ‘*’ apache.directives</div><div class="line">salt ‘*’ apache.fullversion</div><div class="line">salt ‘*’ apache.modules</div><div class="line">salt ‘*’ apache.server_status</div><div class="line">salt ‘*’ apache.server_status other-profile</div><div class="line">salt ‘*’ apache.servermods</div><div class="line">salt ‘*’ apache.signal restart</div><div class="line">salt ‘*’ apache.useradd /etc/httpd/htpasswd larry badpassword</div><div class="line">salt ‘*’ apache.useradd /etc/httpd/htpasswd larry badpass opts=ns</div><div class="line">salt ‘*’ apache.userdel /etc/httpd/htpasswd larry</div><div class="line">salt ‘*’ apache.version</div><div class="line">salt ‘*’ archive.gunzip template=jinja /tmp/&#123;&#123;grains.id&#125;&#125;.txt.gz</div><div class="line">salt ‘*’ archive.gunzip /tmp/sourcefile.txt.gz</div><div class="line">salt ‘*’ archive.gzip template=jinja /tmp/&#123;&#123;grains.id&#125;&#125;.txt</div><div class="line">salt ‘*’ archive.gzip /tmp/sourcefile.txt</div><div class="line">salt ‘*’ archive.rar template=jinja /tmp/rarfile.rar ‘/tmp/sourcefile1,/tmp/&#123;&#123;grains.id&#125;&#125;.txt’</div><div class="line">salt ‘*’ archive.rar /tmp/rarfile.rar /tmp/sourcefile1,/tmp/sourcefile2</div><div class="line">salt ‘*’ archive.tar cjvf /tmp/salt.tar.bz2 &#123;&#123;grains.saltpath&#125;&#125; template=jinja</div><div class="line">salt ‘*’ archive.tar cjvf /tmp/tarfile.tar.bz2 /tmp/file_1,/tmp/file_2</div><div class="line">salt ‘*’ archive.tar xf foo.tar dest=/target/directory</div><div class="line">salt ‘*’ archive.unrar template=jinja /tmp/rarfile.rar /tmp/&#123;&#123;grains.id&#125;&#125;/ excludes=file_1,file_2</div><div class="line">salt ‘*’ archive.unrar /tmp/rarfile.rar /home/strongbad/ excludes=file_1,file_2</div><div class="line">salt ‘*’ archive.unzip template=jinja /tmp/zipfile.zip /tmp/&#123;&#123;grains.id&#125;&#125;/ excludes=file_1,file_2</div><div class="line">salt ‘*’ archive.unzip /tmp/zipfile.zip /home/strongbad/ excludes=file_1,file_2</div><div class="line">salt ‘*’ archive.zip template=jinja /tmp/zipfile.zip /tmp/sourcefile1,/tmp/&#123;&#123;grains.id&#125;&#125;.txt</div><div class="line">salt ‘*’ archive.zip /tmp/zipfile.zip /tmp/sourcefile1,/tmp/sourcefile2</div><div class="line">salt ‘*’ extfs.dump /dev/sda1</div><div class="line">salt ‘*’ blockdev.tune /dev/sda1 read-ahead=1024 read-write=True</div><div class="line">salt ‘*’ blockdev.wipe /dev/sda1</div><div class="line">salt ‘*’ bridge.add br0</div><div class="line">salt ‘*’ bridge.addif br0 eth0</div><div class="line">salt ‘*’ bridge.delete br0</div><div class="line">salt ‘*’ bridge.delif br0 eth0</div><div class="line">salt ‘*’ bridge.find_interfaces eth0 [eth1…]</div><div class="line">salt ‘*’ bridge.interfaces br0</div><div class="line">salt ‘*’ bridge.list</div><div class="line">salt ‘*’ bridge.show</div><div class="line">salt ‘*’ bridge.show br0</div><div class="line">salt ‘*’ bridge.stp br0 enable</div><div class="line">salt ‘*’ bridge.stp br0 disable</div><div class="line">salt ‘*’ bridge.stp bridge0 enable fxp0</div><div class="line">salt ‘*’ bridge.stp bridge0 disable fxp0</div><div class="line">salt ‘*’ buildout.bootstrap /srv/mybuildout</div><div class="line">salt ‘*’ buildout.buildout /srv/mybuildout</div><div class="line">salt ‘*’ buildout.run_buildout /srv/mybuildout</div><div class="line">salt ‘*’ buildout.upgrade_bootstrap /srv/mybuildout</div><div class="line">salt ‘*’ cloud.action start instance=myinstance</div><div class="line">salt ‘*’ cloud.action stop instance=myinstance</div><div class="line">salt ‘*’ cloud.action show_image provider=my-ec2-config             image=ami-1624987f</div><div class="line">salt ‘*’ cloud.destroy myinstance</div><div class="line">salt ‘*’ cloud.full_query</div><div class="line">salt ‘*’ cloud.list_images my-gce-config</div><div class="line">salt ‘*’ cloud.list_locations my-gce-config</div><div class="line">salt ‘*’ cloud.list_sizes my-gce-config</div><div class="line">salt ‘*’ cloud.profile my-gce-config myinstance</div><div class="line">salt ‘*’ cloud.query</div><div class="line">salt ‘*’ cloud.query list_nodes_full</div><div class="line">salt ‘*’ cloud.query list_nodes_select</div><div class="line">salt ‘*’ cloud.select_query</div><div class="line">salt ‘*’ cmd.exec_code ruby ‘puts “cheese”‘</div><div class="line">salt ‘*’ cmd.has_exec cat</div><div class="line">salt ‘*’ cmd.retcode “file /bin/bash”</div><div class="line">salt ‘*’ cmd.retcode template=jinja “file &#123;&#123;grains.pythonpath[0]&#125;&#125;/python”</div><div class="line">salt ‘*’ cmd.retcode “grep f” stdin=’one\ntwo\nthree\nfour\nfive\n’</div><div class="line">salt ‘*’ cmd.run “ls -l | awk ‘/foo/&#123;print \$2&#125;'”</div><div class="line">salt ‘*’ cmd.run template=jinja “ls <span class="_">-l</span> /tmp/&#123;&#123;grains.id&#125;&#125; | awk ‘/foo/&#123;<span class="built_in">print</span> \<span class="variable">$2</span>&#125;<span class="string">'”</span></div><div class="line">salt ‘*’ cmd.run “Get-ChildItem C:\ ” shell=’powershell’</div><div class="line">salt ‘*’ cmd.run “grep f” stdin=’one\ntwo\nthree\nfour\nfive\n’</div><div class="line">salt ‘*’ cmd.run cmd=’sed -e s/=/:/g’</div><div class="line">salt ‘*’ cmd.run_all “ls -l | awk ‘/foo/&#123;print \$2&#125;'”</div><div class="line">salt ‘*’ cmd.run_all template=jinja “ls <span class="_">-l</span> /tmp/&#123;&#123;grains.id&#125;&#125; | awk ‘/foo/&#123;<span class="built_in">print</span> \<span class="variable">$2</span>&#125;<span class="string">'”</span></div><div class="line">salt ‘*’ cmd.run_all “grep f” stdin=’one\ntwo\nthree\nfour\nfive\n’</div><div class="line">salt ‘*’ cmd.run_chroot /var/lib/lxc/container_name/rootfs ‘sh /tmp/bootstrap.sh’</div><div class="line">salt ‘*’ cmd.run_stderr “ls -l | awk ‘/foo/&#123;print \$2&#125;'”</div><div class="line">salt ‘*’ cmd.run_stderr template=jinja “ls <span class="_">-l</span> /tmp/&#123;&#123;grains.id&#125;&#125; | awk ‘/foo/&#123;<span class="built_in">print</span> \<span class="variable">$2</span>&#125;<span class="string">'”</span></div><div class="line">salt ‘*’ cmd.run_stderr “grep f” stdin=’one\ntwo\nthree\nfour\nfive\n’</div><div class="line">salt ‘*’ cmd.run_stdout “ls -l | awk ‘/foo/&#123;print \$2&#125;'”</div><div class="line">salt ‘*’ cmd.run_stdout template=jinja “ls <span class="_">-l</span> /tmp/&#123;&#123;grains.id&#125;&#125; | awk ‘/foo/&#123;<span class="built_in">print</span> \<span class="variable">$2</span>&#125;<span class="string">'”</span></div><div class="line">salt ‘*’ cmd.run_stdout “grep f” stdin=’one\ntwo\nthree\nfour\nfive\n’</div><div class="line">salt ‘*’ cmd.script salt://scripts/runme.sh</div><div class="line">salt ‘*’ cmd.script salt://scripts/runme.sh ‘arg1 arg2 “arg 3″‘</div><div class="line">salt ‘*’ cmd.script salt://scripts/windows_task.ps1 args=’ -Input c:\tmp\infile.txt’ shell=’powershell’</div><div class="line">salt ‘*’ cmd.script salt://scripts/runme.sh stdin=’one\ntwo\nthree\nfour\nfive\n’</div><div class="line">salt ‘*’ cmd.script_retcode salt://scripts/runme.sh</div><div class="line">salt ‘*’ cmd.script_retcode salt://scripts/runme.sh stdin=’one\ntwo\nthree\nfour\nfive\n’</div><div class="line">salt ‘*’ cmd.tty tty0 ‘This is a test’</div><div class="line">salt ‘*’ cmd.tty pts3 ‘This is a test’</div><div class="line">salt ‘*’ cmd.which cat</div><div class="line">salt ‘*’ cmd.which_bin ‘[pip2, pip, pip-python]’</div><div class="line">salt ‘*’ composer.install /var/www/application</div><div class="line">salt ‘*’ composer.install /var/www/application             no_dev=True optimize=True</div><div class="line">salt ‘*’ config.backup_mode</div><div class="line">salt ‘*’ config.dot_vals host</div><div class="line">salt ‘*’ config.get pkg:apache</div><div class="line">salt ‘*’ config.manage_mode</div><div class="line">salt ‘*’ config.merge schedule</div><div class="line">salt ‘*’ config.option redis.host</div><div class="line">salt ‘*’ config.valid_fileproto salt://path/to/file</div><div class="line">salt ‘*’ cp.cache_dir salt://path/to/dir</div><div class="line">salt ‘*’ cp.cache_dir salt://path/to/dir include_pat=’E@*.py$’</div><div class="line">salt ‘*’ cp.cache_file salt://path/to/file</div><div class="line">salt ‘*’ cp.cache_files salt://pathto/file1,salt://pathto/file1</div><div class="line">salt ‘*’ cp.cache_local_file /etc/hosts</div><div class="line">salt ‘*’ cp.cache_master</div><div class="line">salt ‘*’ cp.get_dir salt://path/to/dir/ /minion/dest</div><div class="line">salt ‘*’ cp.get_file salt://path/to/file /minion/dest</div><div class="line">salt ‘*’ cp.get_file “salt://&#123;&#123;grains.os&#125;&#125;/vimrc” /etc/vimrc template=jinja</div><div class="line">salt ‘*’ cp.get_file_str salt://my/file</div><div class="line">salt ‘*’ cp.get_template salt://path/to/template /minion/dest</div><div class="line">salt ‘*’ cp.get_url salt://my/file /tmp/mine</div><div class="line">salt ‘*’ cp.get_url http://www.slashdot.org /tmp/index.html</div><div class="line">salt ‘*’ cp.hash_file salt://path/to/file</div><div class="line">salt ‘*’ cp.is_cached salt://path/to/file</div><div class="line">salt ‘*’ cp.list_master</div><div class="line">salt ‘*’ cp.list_master_dirs</div><div class="line">salt ‘*’ cp.list_master_symlinks</div><div class="line">salt ‘*’ cp.list_minion</div><div class="line">salt ‘*’ cp.list_states</div><div class="line">salt ‘*’ cp.push /etc/fstab</div><div class="line">salt ‘*’ cp.push /usr/lib/mysql</div><div class="line">salt ‘*’ cp.push_dir /etc/modprobe.d/ glob=’*.conf’</div><div class="line">salt ‘*’ cron.list_tab root</div><div class="line">salt ‘*’ cron.list_tab root</div><div class="line">salt ‘*’ cron.raw_cron root</div><div class="line">salt ‘*’ cron.rm_job root /usr/local/weekly</div><div class="line">salt ‘*’ cron.rm_job root /usr/bin/foo dayweek=1</div><div class="line">salt ‘*’ cron.rm_env root MAILTO</div><div class="line">salt ‘*’ cron.rm_job root /usr/local/weekly</div><div class="line">salt ‘*’ cron.rm_job root /usr/bin/foo dayweek=1</div><div class="line">salt ‘*’ cron.set_env root MAILTO user@example.com</div><div class="line">salt ‘*’ cron.set_job root ‘*’ ‘*’ ‘*’ ‘*’ 1 /usr/local/weekly</div><div class="line">salt ‘*’ cron.set_special root @hourly ‘echo foobar’</div><div class="line">salt ‘*’ cron.write_cron_file root /tmp/new_cron</div><div class="line">salt ‘*’ cron.write_cron_file_verbose root /tmp/new_cron</div><div class="line">salt ‘*’ daemontools.available foo</div><div class="line">salt ‘*’ daemontools.full_restart &lt;service name&gt;</div><div class="line">salt ‘*’ daemontools.get_all</div><div class="line">salt ‘*’ daemontools.missing foo</div><div class="line">salt ‘*’ daemontools.reload &lt;service name&gt;</div><div class="line">salt ‘*’ daemontools.restart &lt;service name&gt;</div><div class="line">salt ‘*’ daemontools.start &lt;service name&gt;</div><div class="line">salt ‘*’ daemontools.status &lt;service name&gt;</div><div class="line">salt ‘*’ daemontools.stop &lt;service name&gt;</div><div class="line">salt ‘*’ daemontools.term &lt;service name&gt;</div><div class="line">salt ‘*’ data.cas &lt;key&gt; &lt;value&gt; &lt;old_value&gt;</div><div class="line">salt ‘*’ data.clear</div><div class="line">salt ‘*’ data.dump ‘&#123;‘eggs': ‘spam’&#125;’</div><div class="line">salt ‘*’ data.getval &lt;key&gt;</div><div class="line">salt ‘*’ data.getvals &lt;key&gt; [&lt;key&gt; …]</div><div class="line">salt ‘*’ data.load</div><div class="line">salt ‘*’ data.update &lt;key&gt; &lt;value&gt;</div><div class="line">salt ‘*’ defaults.get core:users:root</div><div class="line">salt ‘*’ disk.blkid</div><div class="line">salt ‘*’ disk.blkid /dev/sda</div><div class="line">salt ‘*’ disk.inodeusage</div><div class="line">salt ‘*’ disk.percent /var</div><div class="line">salt ‘*’ disk.usage</div><div class="line">salt ‘*’ django.collectstatic &lt;settings_module&gt;</div><div class="line">salt ‘*’ django.command &lt;settings_module&gt; &lt;<span class="built_in">command</span>&gt;</div><div class="line">salt ‘*’ django.createsuperuser &lt;settings_module&gt; user user@example.com</div><div class="line">salt ‘*’ django.loaddata &lt;settings_module&gt; &lt;comma delimited list of fixtures&gt;</div><div class="line">salt ‘*’ django.syncdb &lt;settings_module&gt;</div><div class="line">salt ‘*’ dnsmasq.version</div><div class="line">salt ‘*’ dnsmasq.get_config</div><div class="line">salt ‘*’ dnsmasq.get_config file=/etc/dnsmasq.conf</div><div class="line">salt ‘*’ dnsmasq.set_config domain=mydomain.com</div><div class="line">salt ‘*’ dnsmasq.set_config follow=False domain=mydomain.com</div><div class="line">salt ‘*’ dnsmasq.set_config file=/etc/dnsmasq.conf domain=mydomain.com</div><div class="line">salt ‘*’ dnsmasq.version</div><div class="line">salt ‘*’ dnsutil.hosts_append /etc/hosts 127.0.0.1 ad1.yuk.co,ad2.yuk.co</div><div class="line">salt ‘*’ dnsutil.hosts_remove /etc/hosts ad1.yuk.co</div><div class="line">salt ‘*’ dnsutil.hosts_remove /etc/hosts ad2.yuk.co,ad1.yuk.co</div><div class="line">salt ‘*’ dnsutil.parse_hosts</div><div class="line">salt ‘*’ environ.get foo</div><div class="line">salt ‘*’ environ.get baz default=False</div><div class="line">salt ‘*’ environ.has_value foo</div><div class="line">salt ‘*’ environ.item foo</div><div class="line">salt ‘*’ environ.item ‘[foo, baz]’ default=None</div><div class="line">salt ‘*’ environ.items</div><div class="line">salt ‘*’ environ.setenv ‘&#123;“foo”: “bar”, “baz”: “quux”&#125;’</div><div class="line">salt ‘*’ environ.setenv ‘&#123;“a”: “b”, “c”: False&#125;’ false_unsets=True</div><div class="line">salt ‘*’ environ.setval foo bar</div><div class="line">salt ‘*’ environ.setval baz val=False false_unsets=True</div><div class="line">salt ‘*’ event.fire ‘&#123;“data”:”my event data”&#125;’ ‘tag’</div><div class="line">salt ‘*’ event.fire_master ‘&#123;“data”:”my event data”&#125;’ ‘tag’</div><div class="line">salt ‘*’ extfs.attributes /dev/sda1</div><div class="line">salt ‘*’ extfs.blocks /dev/sda1</div><div class="line">salt ‘*’ extfs.dump /dev/sda1</div><div class="line">salt ‘*’ extfs.mkfs /dev/sda1 fs_type=ext4 opts=’acl,noexec’</div><div class="line">salt ‘*’ extfs.tune /dev/sda1 force=True label=wildstallyns opts=’acl,noexec’</div><div class="line">salt ‘*’ file.access /path/to/file f</div><div class="line">salt ‘*’ file.access /path/to/file x</div><div class="line">salt ‘*’ file.append /etc/motd \</div><div class="line">salt ‘*’ file.append /etc/motd args=’cheese=spam’</div><div class="line">salt ‘*’ file.append /etc/motd args=”[‘cheese=spam’,’spam=cheese’]”</div><div class="line">salt ‘*’ file.blockreplace /etc/hosts ‘<span class="comment">#– start managed zone foobar : DO NOT EDIT –‘ \</span></div><div class="line">salt ‘*’ file.check_file_meta /etc/httpd/conf.d/httpd.conf salt://http/httpd.conf ‘&#123;hash_type: ‘md5′, ‘hsum<span class="string">': &lt;md5sum&gt;&#125;’ root, root, ‘755’ base</span></div><div class="line">salt ‘*’ file.check_hash /etc/fstab md5:&lt;md5sum&gt;</div><div class="line">salt ‘*’ file.check_managed /etc/httpd/conf.d/httpd.conf salt://http/httpd.conf ‘&#123;hash_type: ‘md5′, ‘hsum': &lt;md5sum&gt;&#125;’ root, root, ‘755’ jinja True None None base</div><div class="line">salt ‘*’ file.check_managed_changes /etc/httpd/conf.d/httpd.conf salt://http/httpd.conf ‘&#123;hash_type: ‘md5′, ‘hsum<span class="string">': &lt;md5sum&gt;&#125;’ root, root, ‘755’ jinja True None None base</span></div><div class="line">salt ‘*’ file.check_perms /etc/sudoers ‘&#123;&#125;’ root root 400</div><div class="line">salt ‘*’ file.chgrp /etc/passwd root</div><div class="line">salt ‘*’ file.chown /etc/passwd root root</div><div class="line">salt ‘*’ file.comment /etc/modules pcspkr</div><div class="line">salt ‘*’ file.contains /etc/crontab ‘mymaintenance.sh’</div><div class="line">salt ‘*’ file.contains_glob /etc/foobar ‘*cheese*’</div><div class="line">salt ‘*’ file.contains_regex /etc/crontab</div><div class="line">salt ‘*’ file.contains_regex_multiline /etc/crontab ‘^maint’</div><div class="line">salt ‘*’ file.copy /path/to/src /path/to/dst</div><div class="line">salt ‘*’ file.copy /path/to/src_dir /path/to/dst_dir recurse=True</div><div class="line">salt ‘*’ file.copy /path/to/src_dir /path/to/dst_dir recurse=True remove_existing=True</div><div class="line">salt ‘*’ file.restore_backup /foo/bar/baz.txt 0</div><div class="line">salt ‘*’ file.directory_exists /etc</div><div class="line">salt ‘*’ file.extract_hash /etc/foo sha512 /path/to/hash/file</div><div class="line">salt ‘*’ file.file_exists /etc/passwd</div><div class="line">salt ‘*’ file.find / type=f name=\*.bak size=+10m</div><div class="line">salt ‘*’ file.find /var mtime=+30d size=+10m print=path,size,mtime</div><div class="line">salt ‘*’ file.find /var/log name=\*.[0-9] mtime=+30d size=+10m delete</div><div class="line">salt ‘*’ file.get_devmm /dev/chr</div><div class="line">salt ‘*’ file.get_diff /home/fred/.vimrc salt://users/fred/.vimrc</div><div class="line">salt ‘*’ file.get_gid /etc/passwd</div><div class="line">salt ‘*’ file.get_group /etc/passwd</div><div class="line">salt ‘*’ file.get_hash /etc/shadow</div><div class="line">salt ‘*’ file.get_managed /etc/httpd/conf.d/httpd.conf jinja salt://http/httpd.conf ‘&#123;hash_type: ‘md5′, ‘hsum': &lt;md5sum&gt;&#125;’ root root ‘755’ base None None</div><div class="line">salt ‘*’ file.get_mode /etc/passwd</div><div class="line">salt ‘*’ file.get_selinux_context /etc/hosts</div><div class="line">salt ‘*’ file.get_sum /etc/passwd sha512</div><div class="line">salt ‘*’ file.get_uid /etc/passwd</div><div class="line">salt ‘*’ file.get_user /etc/passwd</div><div class="line">salt ‘*’ file.gid_to_group 0</div><div class="line">salt ‘*’ file.grep /etc/passwd nobody</div><div class="line">salt ‘*’ file.grep /etc/sysconfig/network-scripts/ifcfg-eth0 ipaddr ” -i”</div><div class="line">salt ‘*’ file.grep /etc/sysconfig/network-scripts/ifcfg-eth0 ipaddr ” -i -B2″</div><div class="line">salt ‘*’ file.grep “/etc/sysconfig/network-scripts/*” ipaddr ” -i <span class="_">-l</span>”</div><div class="line">salt ‘*’ file.group_to_gid root</div><div class="line">salt ‘*’ file.is_blkdev /dev/blk</div><div class="line">salt ‘*’ file.is_chrdev /dev/chr</div><div class="line">salt ‘*’ file.is_fifo /dev/fifo</div><div class="line">salt ‘*’ file.is_link /path/to/link</div><div class="line">salt ‘*’ file.join ‘/’ ‘usr’ ‘<span class="built_in">local</span>’ ‘bin’</div><div class="line">salt ‘*’ file.chown /etc/passwd root root</div><div class="line">salt ‘*’ file.link /path/to/file /path/to/link</div><div class="line">salt ‘*’ file.list_backups /foo/bar/baz.txt</div><div class="line">salt ‘*’ file.list_backups /foo/bar/baz.txt</div><div class="line">salt ‘*’ file.lstat /path/to/file</div><div class="line">salt ‘*’ file.makedirs /opt/code/</div><div class="line">salt ‘*’ file.makedirs_perms /opt/code</div><div class="line">salt ‘*’ file.manage_file /etc/httpd/conf.d/httpd.conf ” ‘&#123;&#125;’ salt://http/httpd.conf ‘&#123;hash_type: ‘md5′, ‘hsum<span class="string">': &lt;md5sum&gt;&#125;’ root root ‘755’ base ”</span></div><div class="line">salt ‘*’ file.mkdir /opt/jetty/context</div><div class="line">salt ‘*’ file.mknod /dev/chr c 180 31</div><div class="line">salt ‘*’ file.mknod /dev/blk b 8 999</div><div class="line">salt ‘*’ file.nknod /dev/fifo p</div><div class="line">salt ‘*’ file.mknod_blkdev /dev/blk 8 999</div><div class="line">salt ‘*’ file.mknod_chrdev /dev/chr 180 31</div><div class="line">salt ‘*’ file.mknod_fifo /dev/fifo</div><div class="line">salt ‘*’ file.open_files</div><div class="line">salt ‘*’ file.open_files by_pid=True</div><div class="line">salt ‘*’ file.pardir</div><div class="line">salt ‘*’ file.patch /opt/file.txt /tmp/file.txt.patch</div><div class="line">salt ‘*’ file.path_exists_glob /etc/pam*/pass*</div><div class="line">salt ‘*’ file.prepend /etc/motd \</div><div class="line">salt ‘*’ file.prepend /etc/motd args=’cheese=spam’</div><div class="line">salt ‘*’ file.prepend /etc/motd args=”[‘cheese=spam’,’spam=cheese’]”</div><div class="line">salt ‘*’ file.sed /etc/httpd/httpd.conf ‘LogLevel warn’ ‘LogLevel info’</div><div class="line">salt ‘*’ file.readdir /path/to/dir/</div><div class="line">salt ‘*’ file.readlink /path/to/link</div><div class="line">salt ‘*’ file.remove /tmp/foo</div><div class="line">salt ‘*’ file.restore_backup /foo/bar/baz.txt 0</div><div class="line">salt ‘*’ file.rename /path/to/src /path/to/dst</div><div class="line">salt ‘*’ file.replace /path/to/file pattern=”bind-address\s*=” repl=’bind-address:’</div><div class="line">salt ‘*’ file.replace /path/to/file pattern=’=’ repl=':’</div><div class="line">salt ‘*’ file.replace /etc/httpd/httpd.conf pattern=’LogLevel warn’ repl=’LogLevel info’</div><div class="line">salt ‘*’ file.replace /some/file pattern=’before’ repl=’after’ flags=<span class="string">'[MULTILINE, IGNORECASE]’</span></div><div class="line">salt ‘*’ file.restore_backup /foo/bar/baz.txt 0</div><div class="line">salt ‘*’ file.restorecon /home/user/.ssh/authorized_keys</div><div class="line">salt ‘*’ file.rmdir /tmp/foo/</div><div class="line">salt ‘*’ file.search /etc/crontab ‘mymaintenance.sh’</div><div class="line">salt ‘*’ file.sed /etc/httpd/httpd.conf ‘LogLevel warn’ ‘LogLevel info’</div><div class="line">salt ‘*’ file.contains /etc/crontab ‘mymaintenance.sh’</div><div class="line">salt ‘*’ file.seek_read /path/to/file 4096 0</div><div class="line">salt ‘*’ file.seek_write /path/to/file ‘some data’ 4096</div><div class="line">salt ‘*’ file.set_mode /etc/passwd 0644</div><div class="line">salt ‘*’ file.set_selinux_context path &lt;role&gt; &lt;type&gt; &lt;range&gt;</div><div class="line">salt ‘*’ file.source_list salt://http/httpd.conf ‘&#123;hash_type: ‘md5′, ‘hsum': &lt;md5sum&gt;&#125;’ base</div><div class="line">salt ‘*’ file.stats /etc/passwd</div><div class="line">salt ‘*’ file.statvfs /path/to/file</div><div class="line">salt ‘*’ file.symlink /path/to/file /path/to/link</div><div class="line">salt ‘*’ file.touch /var/<span class="built_in">log</span>/emptyfile</div><div class="line">salt ‘*’ file.truncate /path/to/file 512</div><div class="line">salt ‘*’ file.uid_to_user 0</div><div class="line">salt ‘*’ file.uncomment /etc/hosts.deny ‘ALL: PARANOID’</div><div class="line">salt ‘*’ file.user_to_uid root</div><div class="line">salt ‘*’ file.write /etc/motd \</div><div class="line">salt ‘*’ file.write /etc/motd args=’cheese=spam’</div><div class="line">salt ‘*’ file.write /etc/motd args=”[‘cheese=spam’,’spam=cheese’]”</div><div class="line">salt ‘*’ gem.install vagrant</div><div class="line">salt ‘*’ gem.list</div><div class="line">salt ‘*’ gem.sources_add http://rubygems.org/</div><div class="line">salt ‘*’ gem.sources_list</div><div class="line">salt ‘*’ gem.sources_remove http://rubygems.org/</div><div class="line">salt ‘*’ gem.uninstall vagrant</div><div class="line">salt ‘*’ gem.update vagrant</div><div class="line">salt ‘*’ gem.update_system</div><div class="line">salt ‘*’ grains.append key val</div><div class="line">salt ‘*’ grains.delval key</div><div class="line">salt ‘*’ grains.filter_by ‘&#123;Debian: Debheads rule, RedHat: I love my hat&#125;’</div><div class="line">salt ‘*’ grains.filter_by ‘&#123;A: B, C: &#123;D: &#123;E: F,G: H&#125;&#125;&#125;’ ‘xxx’ ‘&#123;D: &#123;E: I&#125;,J: K&#125;’ ‘C’</div><div class="line">salt ‘*’ grains.get pkg:apache</div><div class="line">salt ‘*’ grains.get_or_set_hash ‘django:SECRET_KEY’ 50</div><div class="line">salt ‘*’ grains.has_value pkg:apache</div><div class="line">salt ‘*’ grains.item os</div><div class="line">salt ‘*’ grains.item os osrelease oscodename</div><div class="line">salt ‘*’ grains.item host sanitize=True</div><div class="line">salt ‘*’ grains.items</div><div class="line">salt ‘*’ grains.items sanitize=True</div><div class="line">salt ‘*’ grains.ls</div><div class="line">salt ‘*’ grains.remove key val</div><div class="line">salt ‘*’ grains.setval key val</div><div class="line">salt ‘*’ grains.setval key “&#123;‘sub-key<span class="string">': ‘val’, ‘sub-key2′: ‘val2′&#125;”</span></div><div class="line">salt ‘*’ grains.setvals “&#123;‘key1′: ‘val1′, ‘key2′: ‘val2′&#125;”</div><div class="line">salt ‘*’ group.add foo 3456</div><div class="line">salt ‘*’ group.adduser foo bar</div><div class="line">salt ‘*’ group.chgid foo 4376</div><div class="line">salt ‘*’ group.delete foo</div><div class="line">salt ‘*’ group.deluser foo bar</div><div class="line">salt ‘*’ group.getent</div><div class="line">salt ‘*’ group.info foo</div><div class="line">salt ‘*’ group.members foo ‘user1,user2,user3,…’</div><div class="line">salt ‘*’ grub.conf</div><div class="line">salt ‘*’ grub.version</div><div class="line">salt ‘*’ hashutil.base64_decodestring ‘Z2V0IHNhbHRlZA==</div><div class="line">salt ‘*’ hashutil.base64_encodestring ‘get salted’</div><div class="line">salt ‘*’ hashutil.hmac_signature ‘get salted’ ‘shared secret’ ‘NS2BvKxFRk+rndAlFbCYIFNVkPtI/3KiIYQw4okNKU8=’</div><div class="line">salt ‘*’ hashutil.md5_digest ‘get salted’</div><div class="line">salt ‘*’ hashutil.sha256_digest ‘get salted’</div><div class="line">salt ‘*’ hashutil.sha512_digest ‘get salted’</div><div class="line">salt ‘*’ hg.archive /path/to/repo output=/tmp/archive.tgz fmt=tgz</div><div class="line">salt ‘*’ hg.clone /path/to/repo https://bitbucket.org/birkenfeld/sphinx</div><div class="line">salt ‘*’ hg.describe /path/to/repo</div><div class="line">salt ‘*’ hg.pull /path/to/repo opts=-u</div><div class="line">salt ‘*’ hg.revision /path/to/repo mybranch</div><div class="line">salt ‘*’ hosts.add_host &lt;ip&gt; &lt;alias&gt;</div><div class="line">salt ‘*’ hosts.get_alias &lt;ip addr&gt;</div><div class="line">salt ‘*’ hosts.get_ip &lt;hostname&gt;</div><div class="line">salt ‘*’ hosts.has_pair &lt;ip&gt; &lt;alias&gt;</div><div class="line">salt ‘*’ hosts.list_hosts</div><div class="line">salt ‘*’ hosts.rm_host &lt;ip&gt; &lt;alias&gt;</div><div class="line">salt ‘*’ hosts.set_host &lt;ip&gt; &lt;alias&gt;</div><div class="line">salt ‘*’ img.bootstrap /srv/salt-images/host.qcow 4096 qcow2</div><div class="line">salt ‘*’ img.mount_image /tmp/foo</div><div class="line">salt ‘*’ img.mount_image /tmp/foo</div><div class="line">salt ‘*’ img.umount_image /mnt/foo</div><div class="line">salt ‘*’ incron.list_tab root</div><div class="line">salt ‘*’ incron.list_tab root</div><div class="line">salt ‘*’ incron.raw_cron root</div><div class="line">salt ‘*’ incron.raw_system_cron</div><div class="line">salt ‘*’ incron.rm_job root /path</div><div class="line">salt ‘*’ incron.rm_job root /path</div><div class="line">salt ‘*’ incron.set_job root ‘/root’ ‘IN_MODIFY’ ‘echo “$$ $@ $# $% $&amp;”‘</div><div class="line">salt ‘*’ incron.write_incron_file_verbose root /tmp/new_cron</div><div class="line">salt ‘*’ incron.write_cron_file root /tmp/new_cron</div><div class="line">salt ‘*’ ini.get_option /path/to/ini section_name option_name</div><div class="line">salt ‘*’ ini.get_section /path/to/ini section_name</div><div class="line">salt ‘*’ ini.remove_option /path/to/ini section_name option_name</div><div class="line">salt ‘*’ ini.remove_section /path/to/ini section_name</div><div class="line">salt ‘*’ ini.set_option /path/to/ini ‘&#123;section_foo: &#123;key: value&#125;&#125;’</div><div class="line">salt ‘*’ ip.apply_network_settings</div><div class="line">salt ‘*’ ip.build_bond bond0 mode=balance-alb</div><div class="line">salt ‘*’ ip.build_interface eth0 eth &lt;settings&gt;</div><div class="line">salt ‘*’ ip.build_network_settings &lt;settings&gt;</div><div class="line">salt ‘*’ ip.build_routes eth0 &lt;settings&gt;</div><div class="line">salt ‘*’ ip.down eth0</div><div class="line">salt ‘*’ ip.get_bond bond0</div><div class="line">salt ‘*’ ip.get_interface eth0</div><div class="line">salt ‘*’ ip.get_network_settings</div><div class="line">salt ‘*’ ip.get_routes eth0</div><div class="line">salt ‘*’ ip.up eth0</div><div class="line">salt ‘*’ iptables.append filter INPUT \</div><div class="line">salt ‘*’ iptables.append filter INPUT \</div><div class="line">salt ‘*’ iptables.build_rule match=state \</div><div class="line">salt ‘*’ iptables.build_rule filter INPUT command=I position=3 \</div><div class="line">salt ‘*’ iptables.build_rule filter INPUT command=A \</div><div class="line">salt ‘*’ iptables.build_rule filter INPUT command=A \</div><div class="line">salt ‘*’ iptables.build_rule filter INPUT command=A \</div><div class="line">salt ‘*’ iptables.build_rule match=state \</div><div class="line">salt ‘*’ iptables.build_rule filter INPUT command=I position=3 \</div><div class="line">salt ‘*’ iptables.check filter INPUT \</div><div class="line">salt ‘*’ iptables.check filter INPUT \</div><div class="line">salt ‘*’ iptables.check_chain filter INPUT</div><div class="line">salt ‘*’ iptables.check_chain filter INPUT family=ipv6</div><div class="line">salt ‘*’ iptables.delete filter INPUT position=3</div><div class="line">salt ‘*’ iptables.delete filter INPUT \</div><div class="line">salt ‘*’ iptables.delete filter INPUT position=3 family=ipv6</div><div class="line">salt ‘*’ iptables.delete filter INPUT \</div><div class="line">salt ‘*’ iptables.delete_chain filter CUSTOM_CHAIN</div><div class="line">salt ‘*’ iptables.delete_chain filter CUSTOM_CHAIN family=ipv6</div><div class="line">salt ‘*’ iptables.flush filter INPUT</div><div class="line">salt ‘*’ iptables.flush filter INPUT family=ipv6</div><div class="line">salt ‘*’ iptables.get_policy filter INPUT</div><div class="line">salt ‘*’ iptables.get_policy filter INPUT family=ipv6</div><div class="line">salt ‘*’ iptables.get_rules</div><div class="line">salt ‘*’ iptables.get_rules family=ipv6</div><div class="line">salt ‘*’ iptables.get_saved_policy filter INPUT</div><div class="line">salt ‘*’ iptables.get_saved_policy filter INPUT \</div><div class="line">salt ‘*’ iptables.get_saved_policy filter INPUT family=ipv6</div><div class="line">salt ‘*’ iptables.get_saved_policy filter INPUT \</div><div class="line">salt ‘*’ iptables.get_saved_rules</div><div class="line">salt ‘*’ iptables.get_saved_rules family=ipv6</div><div class="line">salt ‘*’ iptables.insert filter INPUT position=3 \</div><div class="line">salt ‘*’ iptables.insert filter INPUT position=3 \</div><div class="line">salt ‘*’ iptables.new_chain filter CUSTOM_CHAIN</div><div class="line">salt ‘*’ iptables.new_chain filter CUSTOM_CHAIN family=ipv6</div><div class="line">salt ‘*’ iptables.save /etc/sysconfig/iptables</div><div class="line">salt ‘*’ iptables.save /etc/sysconfig/iptables family=ipv6</div><div class="line">salt ‘*’ iptables.set_policy filter INPUT ACCEPT</div><div class="line">salt ‘*’ iptables.set_policy filter INPUT ACCEPT family=ipv6</div><div class="line">salt ‘*’ iptables.version</div><div class="line">salt ‘*’ iptables.version family=ipv6</div><div class="line">salt ‘*’ key.finger</div><div class="line">salt ‘*’ key.finger_master</div><div class="line">salt ‘*’ kmod.available</div><div class="line">salt ‘*’ kmod.check_available kvm</div><div class="line">salt ‘*’ kmod.is_loaded kvm</div><div class="line">salt ‘*’ kmod.load kvm</div><div class="line">salt ‘*’ kmod.lsmod</div><div class="line">salt ‘*’ kmod.mod_list</div><div class="line">salt ‘*’ kmod.remove kvm</div><div class="line">salt ‘*’ locale.avail ‘en_US.UTF-8′</div><div class="line">salt ‘*’ locale.gen_locale ‘en_US.UTF-8′</div><div class="line">salt ‘*’ locale.get_locale</div><div class="line">salt ‘*’ locale.list_avail</div><div class="line">salt ‘*’ locale.set_locale ‘en_US.UTF-8′</div><div class="line">salt ‘*’ locate.locate</div><div class="line">salt ‘*’ locate.stats</div><div class="line">salt ‘*’ locate.updatedb</div><div class="line">salt ‘*’ locate.version</div><div class="line">salt ‘*’ logrotate.set rotate 2</div><div class="line">salt ‘*’ logrotate.set /var/log/wtmp rotate 2</div><div class="line">salt ‘*’ logrotate.show_conf</div><div class="line">salt ‘*’ lowpkg.file_dict httpd</div><div class="line">salt ‘*’ lowpkg.file_dict httpd postfix</div><div class="line">salt ‘*’ lowpkg.file_dict</div><div class="line">salt ‘*’ lowpkg.file_list httpd</div><div class="line">salt ‘*’ lowpkg.file_list httpd postfix</div><div class="line">salt ‘*’ lowpkg.file_list</div><div class="line">salt ‘*’ lowpkg.list_pkgs</div><div class="line">salt ‘*’ lowpkg.verify</div><div class="line">salt ‘*’ lowpkg.verify httpd</div><div class="line">salt ‘*’ lowpkg.verify ‘httpd postfix’</div><div class="line">salt ‘*’ lowpkg.verify ‘httpd postfix’ ignore_types=[‘config’,’doc’]</div><div class="line">salt ‘*’ lvm.fullversion</div><div class="line">salt ‘*’ lvm.lvcreate new_volume_name vg_name size=10G</div><div class="line">salt ‘*’ lvm.lvcreate new_volume_name vg_name extents=100 /dev/sdb</div><div class="line">salt ‘*’ lvm.lvcreate new_snapshot    vg_name snapshot=volume_name size=3G</div><div class="line">salt ‘*’ lvm.lvdisplay</div><div class="line">salt ‘*’ lvm.lvdisplay /dev/vg_myserver/root</div><div class="line">salt ‘*’ lvm.lvremove lvname vgname force=True</div><div class="line">salt ‘*’ lvm.pvdisplay</div><div class="line">salt ‘*’ lvm.pvdisplay /dev/md0</div><div class="line">salt ‘*’ lvm.version</div><div class="line">salt ‘*’ lvm.vgdisplay</div><div class="line">salt ‘*’ lvm.vgdisplay nova-volumes</div><div class="line">salt ‘*’ match.compound ‘L@cheese,foo and *’</div><div class="line">salt ‘*’ match.data ‘spam:eggs’</div><div class="line">salt ‘*’ match.filter_by ‘&#123;foo*: Foo!, bar*: Bar!&#125;’ minion_id=bar03</div><div class="line">salt ‘*’ match.glob ‘*’</div><div class="line">salt ‘*’ match.grain ‘os:Ubuntu’</div><div class="line">salt ‘*’ match.grain ‘ipv6|2001:db8::ff00:42:8329′ delimiter=’|’</div><div class="line">salt ‘*’ match.grain_pcre ‘os:Fedo.*’</div><div class="line">salt ‘*’ match.grain_pcre ‘ipv6|2001:.*’ delimiter=’|’</div><div class="line">salt ‘*’ match.ipcidr ‘192.168.44.0/24′</div><div class="line">salt ‘*’ match.list ‘server1,server2′</div><div class="line">salt ‘*’ match.pcre ‘.*’</div><div class="line">salt ‘*’ match.pillar ‘cheese:foo’</div><div class="line">salt ‘*’ match.pillar ‘clone_url|https://github.com/saltstack/salt.git’ delimiter=’|’</div><div class="line">salt ‘*’ mine.delete ‘network.interfaces’</div><div class="line">salt ‘*’ mine.flush</div><div class="line">salt ‘*’ mine.get ‘*’ network.interfaces</div><div class="line">salt ‘*’ mine.get ‘os:Fedora’ network.interfaces grain</div><div class="line">salt ‘*’ mine.get ‘os:Fedora and S@192.168.5.0/24′ network.ipaddrs compound</div><div class="line">salt ‘*’ mine.get_docker</div><div class="line">salt ‘*’ mine.get_docker interfaces=’eth0′</div><div class="line">salt ‘*’ mine.get_docker interfaces='[“eth0″, “eth1″]’</div><div class="line">salt ‘*’ mine.get_docker cidrs=’107.170.147.0/24′</div><div class="line">salt ‘*’ mine.get_docker cidrs=<span class="string">'[“107.170.147.0/24″, “172.17.42.0/24″]’</span></div><div class="line">salt ‘*’ mine.get_docker interfaces='[“eth0″, “eth1″]’ cidrs=<span class="string">'[“107.170.147.0/24″, “172.17.42.0/24″]’</span></div><div class="line">salt ‘*’ mine.send network.interfaces eth0</div><div class="line">salt ‘*’ mine.update</div><div class="line">salt ‘*’ modjk.bulk_activate node1,node2,node3 loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_activate node1,node2,node3 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.bulk_activate [“node1″,”node2″,”node3″] loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_activate [“node1″,”node2″,”node3″] loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.bulk_disable node1,node2,node3 loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_disable node1,node2,node3 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.bulk_disable [“node1″,”node2″,”node3″] loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_disable [“node1″,”node2″,”node3″] loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.bulk_recover node1,node2,node3 loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_recover node1,node2,node3 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.bulk_recover [“node1″,”node2″,”node3″] loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_recover [“node1″,”node2″,”node3″] loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.bulk_stop node1,node2,node3 loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_stop node1,node2,node3 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.bulk_stop [“node1″,”node2″,”node3″] loadbalancer1</div><div class="line">salt ‘*’ modjk.bulk_stop [“node1″,”node2″,”node3″] loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.dump_config</div><div class="line">salt ‘*’ modjk.dump_config other-profile</div><div class="line">salt ‘*’ modjk.get_running</div><div class="line">salt ‘*’ modjk.get_running other-profile</div><div class="line">salt ‘*’ modjk.lb_edit loadbalancer1 “&#123;‘vlr': 1, ‘vlt<span class="string">': 60&#125;”</span></div><div class="line">salt ‘*’ modjk.lb_edit loadbalancer1 “&#123;‘vlr': 1, ‘vlt<span class="string">': 60&#125;” other-profile</span></div><div class="line">salt ‘*’ modjk.list_configured_members loadbalancer1</div><div class="line">salt ‘*’ modjk.list_configured_members loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.recover_all loadbalancer1</div><div class="line">salt ‘*’ modjk.recover_all loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.reset_stats loadbalancer1</div><div class="line">salt ‘*’ modjk.reset_stats loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.version</div><div class="line">salt ‘*’ modjk.version other-profile</div><div class="line">salt ‘*’ modjk.worker_activate node1 loadbalancer1</div><div class="line">salt ‘*’ modjk.worker_activate node1 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.worker_disable node1 loadbalancer1</div><div class="line">salt ‘*’ modjk.worker_disable node1 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.worker_edit node1 loadbalancer1 “&#123;‘vwf': 500, ‘vwd<span class="string">': 60&#125;”</span></div><div class="line">salt ‘*’ modjk.worker_edit node1 loadbalancer1 “&#123;‘vwf': 500, ‘vwd<span class="string">': 60&#125;” other-profile</span></div><div class="line">salt ‘*’ modjk.worker_recover node1 loadbalancer1</div><div class="line">salt ‘*’ modjk.worker_recover node1 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.worker_status node1</div><div class="line">salt ‘*’ modjk.worker_status node1 other-profile</div><div class="line">salt ‘*’ modjk.worker_activate node1 loadbalancer1</div><div class="line">salt ‘*’ modjk.worker_activate node1 loadbalancer1 other-profile</div><div class="line">salt ‘*’ modjk.workers</div><div class="line">salt ‘*’ modjk.workers other-profile</div><div class="line">salt ‘*’ mount.active</div><div class="line">salt ‘*’ mount.fstab</div><div class="line">salt ‘*’ mount.is_fuse_exec sshfs</div><div class="line">salt ‘*’ mount.is_mounted /mnt/share</div><div class="line">salt ‘*’ mount.mount /mnt/foo /dev/sdz1 True</div><div class="line">salt ‘*’ mount.remount /mnt/foo /dev/sdz1 True</div><div class="line">salt ‘*’ mount.rm_fstab /mnt/foo</div><div class="line">salt ‘*’ mount.set_fstab /mnt/foo /dev/sdz1 ext4</div><div class="line">salt ‘*’ mount.swapoff /root/swapfile</div><div class="line">salt ‘*’ mount.swapon /root/swapfile</div><div class="line">salt ‘*’ mount.swaps</div><div class="line">salt ‘*’ mount.umount /mnt/foo</div><div class="line">salt ‘*’ network.active_tcp</div><div class="line">salt ‘*’ network.arp</div><div class="line">salt ‘*’ network.connect archlinux.org 80</div><div class="line">salt ‘*’ network.connect archlinux.org 80 timeout=3</div><div class="line">salt ‘*’ network.connect archlinux.org 80 timeout=3 family=ipv4</div><div class="line">salt ‘*’ network.connect google-public-dns-a.google.com port=53 proto=udp timeout=3</div><div class="line">salt ‘*’ network.dig archlinux.org</div><div class="line">salt ‘*’ network.get_hostname</div><div class="line">salt ‘*’ network.hw_addr eth0</div><div class="line">salt ‘*’ network.hw_addr eth0</div><div class="line">salt ‘*’ network.in_subnet 10.0.0.0/16</div><div class="line">salt ‘*’ network.interface eth0</div><div class="line">salt ‘*’ network.interface_ip eth0</div><div class="line">salt ‘*’ network.interfaces</div><div class="line">salt ‘*’ network.ip_addrs</div><div class="line">salt ‘*’ network.ip_addrs6</div><div class="line">salt ‘*’ network.ip_addrs</div><div class="line">salt ‘*’ network.ip_addrs6</div><div class="line">salt ‘*’ network.is_loopback 127.0.0.1</div><div class="line">salt ‘*’ network.is_private 10.0.0.3</div><div class="line">salt ‘*’ network.mod_hostname   master.saltstack.com</div><div class="line">salt ‘*’ network.netstat</div><div class="line">salt ‘*’ network.ping archlinux.org</div><div class="line">salt ‘*’ network.subnets</div><div class="line">salt ‘*’ network.traceroute archlinux.org</div><div class="line">salt ‘*’ pillar.items</div><div class="line">salt ‘*’ pillar.ext ‘&#123;libvirt: _&#125;’</div><div class="line">salt ‘*’ pillar.get pkg:apache</div><div class="line">salt ‘*’ pillar.item foo</div><div class="line">salt ‘*’ pillar.item foo bar baz</div><div class="line">salt ‘*’ pillar.items</div><div class="line">salt ‘*’ pillar.raw</div><div class="line">salt ‘*’ pillar.raw key=’roles’</div><div class="line">salt ‘*’ pip.freeze /home/code/path/to/virtualenv/</div><div class="line">salt ‘*’ pip.install &lt;package name&gt;,&lt;package2 name&gt;</div><div class="line">salt ‘*’ pip.install requirements=/path/to/requirements.txt</div><div class="line">salt ‘*’ pip.install &lt;package name&gt; bin_env=/path/to/virtualenv</div><div class="line">salt ‘*’ pip.install &lt;package name&gt; bin_env=/path/to/pip_bin</div><div class="line">salt ‘*’ pip.install markdown,django                 editable=git+https://github.com/worldcompany/djangoembed.git#egg=djangoembed upgrade=True no_deps=True</div><div class="line">salt ‘*’ pip.list salt</div><div class="line">salt ‘*’ pip.uninstall &lt;package name&gt;,&lt;package2 name&gt;</div><div class="line">salt ‘*’ pip.uninstall requirements=/path/to/requirements.txt</div><div class="line">salt ‘*’ pip.uninstall &lt;package name&gt; bin_env=/path/to/virtualenv</div><div class="line">salt ‘*’ pip.uninstall &lt;package name&gt; bin_env=/path/to/pip_bin</div><div class="line">salt ‘*’ pip.version</div><div class="line">salt ‘*’ pkg.latest_version &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.latest_version &lt;package name&gt; fromrepo=epel-testing</div><div class="line">salt ‘*’ pkg.latest_version &lt;package name&gt; disableexcludes=main</div><div class="line">salt ‘*’ pkg.latest_version &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; …</div><div class="line">salt ‘*’ pkg.check_db &lt;package1&gt; &lt;package2&gt; &lt;package3&gt;</div><div class="line">salt ‘*’ pkg.check_db &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; fromrepo=epel-testing</div><div class="line">salt ‘*’ pkg.check_db &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; disableexcludes=main</div><div class="line">salt ‘*’ pkg.clean_metadata</div><div class="line">salt ‘*’ pkg.del_repo myrepo</div><div class="line">salt ‘*’ pkg.del_repo myrepo basedir=/path/to/dir</div><div class="line">salt ‘*’ pkg.file_list httpd</div><div class="line">salt ‘*’ pkg.file_list httpd postfix</div><div class="line">salt ‘*’ pkg.file_list</div><div class="line">salt ‘*’ pkg.file_list httpd</div><div class="line">salt ‘*’ pkg.file_list httpd postfix</div><div class="line">salt ‘*’ pkg.file_list</div><div class="line">salt ‘*’ pkg.get_locked_packages</div><div class="line">salt ‘*’ pkg.get_repo myrepo</div><div class="line">salt ‘*’ pkg.get_repo myrepo basedir=/path/to/dir</div><div class="line">salt ‘*’ pkg.group_diff ‘Perl Support’</div><div class="line">salt ‘*’ pkg.group_info ‘Perl Support’</div><div class="line">salt ‘*’ pkg.group_install ‘Group 1′</div><div class="line">salt ‘*’ pkg.group_install ‘Group 1,Group 2′</div><div class="line">salt ‘*’ pkg.group_install ‘[“Group 1″, “Group 2″]’</div><div class="line">salt ‘*’ pkg.group_install ‘My Group’ skip=’foo,bar’</div><div class="line">salt ‘*’ pkg.group_install ‘My Group’ skip='[“foo”, “bar”]’</div><div class="line">salt ‘*’ pkg.group_install ‘My Group’ include=’foo,bar’</div><div class="line">salt ‘*’ pkg.group_install ‘My Group’ include=<span class="string">'[“foo”, “bar”]’</span></div><div class="line">salt ‘*’ pkg.group_list</div><div class="line">salt ‘*’ pkg.hold &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.hold pkgs='[“foo”, “bar”]’</div><div class="line">salt ‘*’ pkg.install &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.install pkgs=<span class="string">'[“foo”, “bar”]’</span></div><div class="line">salt ‘*’ pkg.install pkgs='[“foo”, &#123;“bar”: “1.2.3-4.el5″&#125;]’</div><div class="line">salt ‘*’ pkg.install sources=<span class="string">'[&#123;“foo”: “salt://foo.rpm”&#125;, &#123;“bar”: “salt://bar.rpm”&#125;]’</span></div><div class="line">salt ‘*’ pkg.latest_version &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.latest_version &lt;package name&gt; fromrepo=epel-testing</div><div class="line">salt ‘*’ pkg.latest_version &lt;package name&gt; disableexcludes=main</div><div class="line">salt ‘*’ pkg.latest_version &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; …</div><div class="line">salt ‘*’ pkg.list_pkgs</div><div class="line">salt ‘*’ pkg.list_repo_pkgs</div><div class="line">salt ‘*’ pkg.list_repo_pkgs foo bar baz</div><div class="line">salt ‘*’ pkg.list_repo_pkgs ‘samba4*’ fromrepo=base,updates</div><div class="line">salt ‘*’ pkg.list_repos</div><div class="line">salt ‘*’ pkg.list_upgrades</div><div class="line">salt ‘*’ pkg.mod_repo reponame enabled=1 gpgcheck=1</div><div class="line">salt ‘*’ pkg.mod_repo reponame basedir=/path/to/dir enabled=1</div><div class="line">salt ‘*’ pkg.mod_repo reponame baseurl= mirrorlist=http://host.com/</div><div class="line">salt ‘*’ pkg.normalize_name zsh.x86_64</div><div class="line">salt ‘*’ pkg.owner /usr/bin/apachectl</div><div class="line">salt ‘*’ pkg.owner /usr/bin/apachectl /etc/httpd/conf/httpd.conf</div><div class="line">salt ‘*’ pkg.purge &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.purge &lt;package1&gt;,&lt;package2&gt;,&lt;package3&gt;</div><div class="line">salt ‘*’ pkg.purge pkgs='[“foo”, “bar”]’</div><div class="line">salt ‘*’ pkg.refresh_db</div><div class="line">salt ‘*’ pkg.remove &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.remove &lt;package1&gt;,&lt;package2&gt;,&lt;package3&gt;</div><div class="line">salt ‘*’ pkg.remove pkgs=<span class="string">'[“foo”, “bar”]’</span></div><div class="line">salt ‘*’ pkg.unhold &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.unhold pkgs='[“foo”, “bar”]’</div><div class="line">salt ‘*’ pkg.upgrade</div><div class="line">salt ‘*’ pkg.upgrade_available &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.verify</div><div class="line">salt ‘*’ pkg.verify httpd</div><div class="line">salt ‘*’ pkg.verify ‘httpd postfix’</div><div class="line">salt ‘*’ pkg.verify ‘httpd postfix’ ignore_types=[‘config’,’doc’]</div><div class="line">salt ‘*’ pkg.version &lt;package name&gt;</div><div class="line">salt ‘*’ pkg.version &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; …</div><div class="line">salt ‘*’ pkg_resource.add_pkg ‘&#123;&#125;’ <span class="built_in">bind</span> 9</div><div class="line">salt ‘*’ pkg_resource.check_extra_requirements &lt;pkgname&gt; &lt;extra_requirements&gt;</div><div class="line">salt ‘*’ pkg_resource.pack_sources ‘[&#123;“foo”: “salt://foo.rpm”&#125;, &#123;“bar”: “salt://bar.rpm”&#125;]’</div><div class="line">salt ‘*’ pkg_resource.parse_targets</div><div class="line">salt ‘*’ pkg_resource.sort_pkglist ‘[“3.45″, “2.13”]’</div><div class="line">salt ‘*’ pkg_resource.stringify ‘vim: 7.127′</div><div class="line">salt ‘*’ pkg_resource.version vim</div><div class="line">salt ‘*’ pkg_resource.version foo bar baz</div><div class="line">salt ‘*’ pkg_resource.version ‘python*’</div><div class="line">salt ‘*’ pkg_resource.version_clean &lt;version_string&gt;</div><div class="line">salt ‘*’ publish.full_data test.kwarg arg=’cheese=spam’</div><div class="line">salt ‘*’ publish.publish test.kwarg arg=’cheese=spam’</div><div class="line">salt ‘*’ pyenv.default</div><div class="line">salt ‘*’ pyenv.default 2.0.0-p0</div><div class="line">salt ‘*’ pyenv.do ‘gem list bundler’</div><div class="line">salt ‘*’ pyenv.do ‘gem list bundler’ deploy</div><div class="line">salt ‘*’ pyenv.do_with_python 2.0.0-p0 ‘gem list bundler’</div><div class="line">salt ‘*’ pyenv.do_with_python 2.0.0-p0 ‘gem list bundler’ deploy</div><div class="line">salt ‘*’ pyenv.install</div><div class="line">salt ‘*’ pyenv.install_python 2.0.0-p0</div><div class="line">salt ‘*’ pyenv.is_installed</div><div class="line">salt ‘*’ pyenv.list</div><div class="line">salt ‘*’ pyenv.rehash</div><div class="line">salt ‘*’ pyenv.uninstall_python 2.0.0-p0</div><div class="line">salt ‘*’ pyenv.update</div><div class="line">salt ‘*’ pyenv.versions</div><div class="line">salt ‘*’ raid.assemble /dev/md0 [‘/dev/xvdd’, ‘/dev/xvde’]</div><div class="line">salt ‘*’ raid.create /dev/md0 level=1 chunk=256 devices=”[‘/dev/xvdd’, ‘/dev/xvde’]” test_mode=True</div><div class="line">salt ‘*’ raid.detail /dev/md0</div><div class="line">salt ‘*’ raid.destroy /dev/md0</div><div class="line">salt ‘*’ raid.detail ‘/dev/md0′</div><div class="line">salt ‘*’ raid.list</div><div class="line">salt ‘*’ raid.save_config</div><div class="line">salt ‘*’ random.get_str 128</div><div class="line">salt ‘*’ random.hash ‘I am a string’ md5</div><div class="line">salt ‘*’ random.shadow_hash ‘My5alT’ ‘MyP@asswd’ md5</div><div class="line">salt ‘*’ random.str_encode ‘I am a new string’ base64</div><div class="line">salt ‘*’ rbenv.default</div><div class="line">salt ‘*’ rbenv.default 2.0.0-p0</div><div class="line">salt ‘*’ rbenv.do ‘gem list bundler’</div><div class="line">salt ‘*’ rbenv.do ‘gem list bundler’ deploy</div><div class="line">salt ‘*’ rbenv.do_with_ruby 2.0.0-p0 ‘gem list bundler’</div><div class="line">salt ‘*’ rbenv.do_with_ruby 2.0.0-p0 ‘gem list bundler’ deploy</div><div class="line">salt ‘*’ rbenv.install</div><div class="line">salt ‘*’ rbenv.install_ruby 2.0.0-p0</div><div class="line">salt ‘*’ rbenv.is_installed</div><div class="line">salt ‘*’ rbenv.list</div><div class="line">salt ‘*’ rbenv.rehash</div><div class="line">salt ‘*’ rbenv.uninstall_ruby 2.0.0-p0</div><div class="line">salt ‘*’ rbenv.update</div><div class="line">salt ‘*’ rbenv.versions</div><div class="line">salt ‘*’ ret.get_fun mysql network.interfaces</div><div class="line">salt ‘*’ ret.get_jid redis 20421104181954700505</div><div class="line">salt ‘*’ ret.get_jids mysql</div><div class="line">salt ‘*’ ret.get_minions mysql</div><div class="line">salt ‘*’ rsync.config</div><div class="line">salt ‘*’ rsync.rsync &#123;src&#125; &#123;dst&#125; &#123;delete=True&#125; &#123;update=True&#125; &#123;passwordfile=/etc/pass.crt&#125; &#123;exclude=xx&#125;</div><div class="line">salt ‘*’ rsync.rsync &#123;src&#125; &#123;dst&#125; &#123;delete=True&#125; &#123;excludefrom=/xx.ini&#125;</div><div class="line">salt ‘*’ rsync.version</div><div class="line">salt ‘*’ rvm.do 2.0.0 &lt;<span class="built_in">command</span>&gt;</div><div class="line">salt ‘*’ rvm.gemset_copy foobar bazquo</div><div class="line">salt ‘*’ rvm.gemset_create 2.0.0 foobar</div><div class="line">salt ‘*’ rvm.gemset_delete 2.0.0 foobar</div><div class="line">salt ‘*’ rvm.gemset_empty 2.0.0 foobar</div><div class="line">salt ‘*’ rvm.gemset_list</div><div class="line">salt ‘*’ rvm.gemset_list_all</div><div class="line">salt ‘*’ rvm.get</div><div class="line">salt ‘*’ rvm.install</div><div class="line">salt ‘*’ rvm.install_ruby 1.9.3-p385</div><div class="line">salt ‘*’ rvm.is_installed</div><div class="line">salt ‘*’ rvm.list</div><div class="line">salt ‘*’ rvm.reinstall_ruby 1.9.3-p385</div><div class="line">salt ‘*’ rvm.rubygems 2.0.0 1.8.24</div><div class="line">salt ‘*’ rvm.set_default 2.0.0</div><div class="line">salt ‘*’ rvm.wrapper &lt;ruby_string&gt; &lt;wrapper_prefix&gt;</div><div class="line">salt ‘*’ saltutil.clear_cache</div><div class="line">salt ‘*’ saltutil.cmd</div><div class="line">salt ‘*’ saltutil.cmd</div><div class="line">salt ‘*’ saltutil.find_cached_job &lt;job id&gt;</div><div class="line">salt ‘*’ saltutil.find_job &lt;job id&gt;</div><div class="line">salt ‘*’ saltutil.is_running state.highstate</div><div class="line">salt ‘*’ saltutil.kill_job &lt;job id&gt;</div><div class="line">salt ‘*’ saltutil.mmodule base test.ping</div><div class="line">salt ‘*’ saltutil.refresh_modules</div><div class="line">salt ‘*’ saltutil.refresh_pillar</div><div class="line">salt ‘*’ saltutil.regen_keys</div><div class="line">salt ‘*’ saltutil.revoke_auth</div><div class="line">salt ‘*’ saltutil.runner jobs.list_jobs</div><div class="line">salt ‘*’ saltutil.running</div><div class="line">salt ‘*’ saltutil.signal_job &lt;job id&gt; 15</div><div class="line">salt ‘*’ saltutil.sync_all</div><div class="line">salt ‘*’ saltutil.sync_grains</div><div class="line">salt ‘*’ saltutil.sync_modules</div><div class="line">salt ‘*’ saltutil.sync_outputters</div><div class="line">salt ‘*’ saltutil.sync_renderers</div><div class="line">salt ‘*’ saltutil.sync_returners</div><div class="line">salt ‘*’ saltutil.sync_states</div><div class="line">salt ‘*’ saltutil.sync_utils</div><div class="line">salt ‘*’ saltutil.term_job &lt;job id&gt;</div><div class="line">salt ‘*’ saltutil.update</div><div class="line">salt ‘*’ saltutil.update 0.10.3</div><div class="line">salt ‘*’ saltutil.wheel key.accept match=jerry</div><div class="line">salt ‘*’ schedule.add job1 <span class="keyword">function</span>=’test.ping’ seconds=3600</div><div class="line">salt ‘*’ schedule.build_schedule_item job1 <span class="keyword">function</span>=’test.ping’ seconds=3600</div><div class="line">salt ‘*’ schedule.delete job1</div><div class="line">salt ‘*’ schedule.disable</div><div class="line">salt ‘*’ schedule.disable_job job1</div><div class="line">salt ‘*’ schedule.enable</div><div class="line">salt ‘*’ schedule.enable_job job1</div><div class="line">salt ‘*’ schedule.list</div><div class="line">salt ‘*’ schedule.list show_all=True</div><div class="line">salt ‘*’ schedule.modify job1 <span class="keyword">function</span>=’test.ping’ seconds=3600</div><div class="line">salt ‘*’ schedule.purge</div><div class="line">salt ‘*’ schedule.reload</div><div class="line">salt ‘*’ schedule.run_job job1</div><div class="line">salt ‘*’ schedule.run_job job1 force=True</div><div class="line">salt ‘*’ schedule.save</div><div class="line">salt ‘minion’ seed.apply path id [config=config_data] \</div><div class="line">salt ‘minion’ seed.mkconfig [config=config_data] [tmp=tmp_dir] \</div><div class="line">salt ‘*’ serverdensity_device.create lama</div><div class="line">salt ‘*’ serverdensity_device.create rich_lama group=lama_band installedRAM=32768</div><div class="line">salt ‘*’ serverdensity_device.delete 51f7eafcdba4bb235e000ae4</div><div class="line">salt ‘*’ serverdensity_device.get_sd_auth &lt;val&gt;</div><div class="line">salt ‘*’ serverdensity_device.install_agent c2bbdd6689ff46282bdaa07555641498</div><div class="line">salt ‘*’ serverdensity_device.ls</div><div class="line">salt ‘*’ serverdensity_device.ls name=lama</div><div class="line">salt ‘*’ serverdensity_device.ls name=lama group=lama_band installedRAM=32768</div><div class="line">salt ‘*’ serverdensity_device.update 51f7eafcdba4bb235e000ae4 name=lama group=lama_band</div><div class="line">salt ‘*’ serverdensity_device.update 51f7eafcdba4bb235e000ae4 name=better_lama group=rock_lamas swapSpace=512</div><div class="line">salt ‘*’ service.available sshd</div><div class="line">salt ‘*’ service.available sshd <span class="built_in">limit</span>=upstart</div><div class="line">salt ‘*’ service.available sshd <span class="built_in">limit</span>=sysvinit</div><div class="line">salt ‘*’ service.disable &lt;service name&gt;</div><div class="line">salt ‘*’ service.disabled &lt;service name&gt;</div><div class="line">salt ‘*’ service.enable &lt;service name&gt;</div><div class="line">salt ‘*’ service.enabled &lt;service name&gt;</div><div class="line">salt ‘*’ service.get_all</div><div class="line">salt ‘*’ service.get_all <span class="built_in">limit</span>=upstart</div><div class="line">salt ‘*’ service.get_all <span class="built_in">limit</span>=sysvinit</div><div class="line">salt ‘*’ service.get_disabled</div><div class="line">salt ‘*’ service.get_disabled <span class="built_in">limit</span>=upstart</div><div class="line">salt ‘*’ service.get_disabled <span class="built_in">limit</span>=sysvinit</div><div class="line">salt ‘*’ service.get_enabled</div><div class="line">salt ‘*’ service.get_enabled <span class="built_in">limit</span>=upstart</div><div class="line">salt ‘*’ service.get_enabled <span class="built_in">limit</span>=sysvinit</div><div class="line">salt ‘*’ service.missing sshd</div><div class="line">salt ‘*’ service.missing sshd <span class="built_in">limit</span>=upstart</div><div class="line">salt ‘*’ service.missing sshd <span class="built_in">limit</span>=sysvinit</div><div class="line">salt ‘*’ service.reload &lt;service name&gt;</div><div class="line">salt ‘*’ service.restart &lt;service name&gt;</div><div class="line">salt ‘*’ service.start &lt;service name&gt;</div><div class="line">salt ‘*’ service.status &lt;service name&gt;</div><div class="line">salt ‘*’ service.stop &lt;service name&gt;</div><div class="line">salt ‘*’ shadow.default_hash</div><div class="line">salt ‘*’ shadow.del_password username</div><div class="line">salt ‘*’ shadow.gen_password ‘I_am_password’</div><div class="line">salt ‘*’ shadow.gen_password ‘I_am_password’ crypt_salt’I_am_salt’ algorithm=sha256</div><div class="line">salt ‘*’ shadow.info root</div><div class="line">salt ‘*’ shadow.set_date username 0</div><div class="line">salt ‘*’ shadow.set_expire username -1</div><div class="line">salt ‘*’ shadow.set_inactdays username 7</div><div class="line">salt ‘*’ shadow.set_maxdays username 90</div><div class="line">salt ‘*’ shadow.set_mindays username 7</div><div class="line">salt ‘*’ shadow.set_password root ‘<span class="variable">$1</span><span class="variable">$UYCIxa628</span>.9qXjpQCjM4a..’</div><div class="line">salt ‘*’ shadow.set_warndays username 7</div><div class="line">salt ‘*’ sqlite3.fetch /root/test.db ‘SELECT * FROM <span class="built_in">test</span>;’</div><div class="line">salt ‘*’ sqlite3.indexes /root/test.db</div><div class="line">salt ‘*’ sqlite3.indices /root/test.db</div><div class="line">salt ‘*’ sqlite3.modify /root/test.db ‘CREATE TABLE <span class="built_in">test</span>(id INT, testdata TEXT);’</div><div class="line">salt ‘*’ sqlite3.sqlite_version</div><div class="line">salt ‘*’ sqlite3.tables /root/test.db</div><div class="line">salt ‘*’ sqlite3.version</div><div class="line">salt ‘*’ ssh.auth_keys root</div><div class="line">salt ‘*’ ssh.check_key &lt;user&gt; &lt;key&gt; &lt;enc&gt; &lt;comment&gt; &lt;options&gt;</div><div class="line">salt ‘*’ root salt://ssh/keyfile</div><div class="line">salt ‘*’ ssh.check_known_host &lt;user&gt; &lt;hostname&gt; key=’AAAA…FAaQ==’</div><div class="line">salt ‘*’ ssh.get_known_host &lt;user&gt; &lt;hostname&gt;</div><div class="line">salt ‘*’ ssh.hash_known_hosts</div><div class="line">salt ‘*’ ssh.host_keys</div><div class="line">salt ‘*’ ssh.recv_known_host &lt;hostname&gt; enc=&lt;enc&gt; port=&lt;port&gt;</div><div class="line">salt ‘*’ ssh.rm_auth_key &lt;user&gt; &lt;key&gt;</div><div class="line">salt ‘*’ ssh.rm_known_host &lt;user&gt; &lt;hostname&gt;</div><div class="line">salt ‘*’ ssh.set_auth_key &lt;user&gt; ‘&lt;key&gt;’ enc=’dsa’</div><div class="line">salt ‘*’ ssh.set_auth_key_from_file &lt;user&gt; salt://ssh_keys/&lt;user&gt;.id_rsa.pub</div><div class="line">salt ‘*’ ssh.set_known_host &lt;user&gt; fingerprint=’xx:xx:..:xx’ enc=’ssh-rsa’ config=’.ssh/known_hosts’</div><div class="line">salt ‘*’ ssh.user_keys</div><div class="line">salt ‘*’ ssh.user_keys user=user1</div><div class="line">salt ‘*’ ssh.user_keys user=user1 pubfile=/home/user1/.ssh/id_rsa.pub prvfile=/home/user1/.ssh/id_rsa</div><div class="line">salt ‘*’ ssh.user_keys user=”[‘user1′,’user2′] pubfile=id_rsa.pub prvfile=id_rsa</div><div class="line">salt ‘*’ state.clear_cache</div><div class="line">salt ‘*’ state.high ‘&#123;“vim”: &#123;“pkg”: [“installed”]&#125;&#125;’</div><div class="line">salt ‘*’ state.highstate</div><div class="line">salt ‘*’ state.highstate whitelist=sls1_to_run,sls2_to_run</div><div class="line">salt ‘*’ state.highstate exclude=sls_to_exclude</div><div class="line">salt ‘*’ state.highstate exclude=”[&#123;‘id<span class="string">': ‘id_to_exclude’&#125;, &#123;‘sls'</span>: ‘sls_to_exclude’&#125;]”</div><div class="line">salt ‘*’ state.highstate pillar=”&#123;foo: ‘Foo!’, bar: ‘Bar!’&#125;”</div><div class="line">salt ‘*’ state.low ‘&#123;“state”: “pkg”, “fun”: “installed”, “name”: “vi”&#125;’</div><div class="line">salt ‘*’ state.pkg /tmp/state_pkg.tgz</div><div class="line">salt ‘*’ state.running</div><div class="line">salt ‘*’ state.show_highstate</div><div class="line">salt ‘*’ state.show_low_sls foo</div><div class="line">salt ‘*’ state.show_lowstate</div><div class="line">salt ‘*’ state.show_sls core,edit.vim dev</div><div class="line">salt ‘*’ state.show_top</div><div class="line">salt ‘*’ state.single pkg.installed name=vim</div><div class="line">salt ‘*’ state.sls core,edit.vim dev</div><div class="line">salt ‘*’ state.sls core exclude=”[&#123;‘id<span class="string">': ‘id_to_exclude’&#125;, &#123;‘sls'</span>: ‘sls_to_exclude’&#125;]”</div><div class="line">salt ‘*’ state.sls myslsfile pillar=”&#123;foo: ‘Foo!’, bar: ‘Bar!’&#125;”</div><div class="line">salt ‘*’ state.sls_id apache http</div><div class="line">salt ‘*’ state.template ‘&lt;Path to template on the minion&gt;’</div><div class="line">salt ‘*’ state.template_str ‘&lt;Template String&gt;’</div><div class="line">salt ‘*’ state.top reverse_top.sls</div><div class="line">salt ‘*’ state.top reverse_top.sls exclude=sls_to_exclude</div><div class="line">salt ‘*’ state.top reverse_top.sls exclude=”[&#123;‘id<span class="string">': ‘id_to_exclude’&#125;, &#123;‘sls'</span>: ‘sls_to_exclude’&#125;]”</div><div class="line">salt ‘*’ status.all_status</div><div class="line">salt ‘*’ status.cpuinfo</div><div class="line">salt ‘*’ status.cpustats</div><div class="line">salt ‘*’ status.custom</div><div class="line">salt ‘*’ status.diskstats</div><div class="line">salt ‘*’ status.diskusage [paths and/or filesystem types]</div><div class="line">salt ‘*’ status.diskusage         <span class="comment"># usage for all filesystems</span></div><div class="line">salt ‘*’ status.diskusage / /tmp  <span class="comment"># usage for / and /tmp</span></div><div class="line">salt ‘*’ status.diskusage ext?    <span class="comment"># usage for ext[234] filesystems</span></div><div class="line">salt ‘*’ status.diskusage / ext?  <span class="comment"># usage for / and all ext filesystems</span></div><div class="line">salt ‘*’ status.loadavg</div><div class="line">salt ‘*’ status.master</div><div class="line">salt ‘*’ status.meminfo</div><div class="line">salt ‘*’ status.netdev</div><div class="line">salt ‘*’ status.netstats</div><div class="line">salt ‘*’ status.nproc</div><div class="line">salt ‘*’ status.pid &lt;sig&gt;</div><div class="line">salt ‘*’ status.procs</div><div class="line">salt ‘*’ status.uptime</div><div class="line">salt ‘*’ status.version</div><div class="line">salt ‘*’ status.vmstats</div><div class="line">salt ‘*’ status.w</div><div class="line">salt ‘*’ supervisord.add &lt;name&gt;</div><div class="line">salt ‘*’ supervisord.custom “mstop ‘*gunicorn*<span class="string">'”</span></div><div class="line">salt ‘*’ supervisord.options foo</div><div class="line">salt ‘*’ supervisord.remove &lt;name&gt;</div><div class="line">salt ‘*’ supervisord.reread</div><div class="line">salt ‘*’ supervisord.restart &lt;service&gt;</div><div class="line">salt ‘*’ supervisord.restart &lt;group&gt;:</div><div class="line">salt ‘*’ supervisord.start &lt;service&gt;</div><div class="line">salt ‘*’ supervisord.start &lt;group&gt;:</div><div class="line">salt ‘*’ supervisord.status</div><div class="line">salt ‘*’ supervisord.status_raw</div><div class="line">salt ‘*’ supervisord.stop &lt;service&gt;</div><div class="line">salt ‘*’ supervisord.stop &lt;group&gt;:</div><div class="line">salt ‘*’ supervisord.update</div><div class="line">salt ‘*’ sys.argspec pkg.install</div><div class="line">salt ‘*’ sys.argspec sys</div><div class="line">salt ‘*’ sys.argspec</div><div class="line">salt ‘*’ sys.doc</div><div class="line">salt ‘*’ sys.doc sys</div><div class="line">salt ‘*’ sys.doc sys.doc</div><div class="line">salt ‘*’ sys.doc network.traceroute user.info</div><div class="line">salt ‘*’ sys.list_functions</div><div class="line">salt ‘*’ sys.list_functions sys</div><div class="line">salt ‘*’ sys.list_functions sys user</div><div class="line">salt ‘*’ sys.list_modules</div><div class="line">salt ‘*’ sys.list_returner_functions</div><div class="line">salt ‘*’ sys.list_returner_functions mysql</div><div class="line">salt ‘*’ sys.list_returner_functions mysql etcd</div><div class="line">salt ‘*’ sys.list_returners</div><div class="line">salt ‘*’ sys.list_runner_functions</div><div class="line">salt ‘*’ sys.list_runner_functions state</div><div class="line">salt ‘*’ sys.list_runner_functions state virt</div><div class="line">salt ‘*’ sys.list_runners</div><div class="line">salt ‘*’ sys.list_state_functions</div><div class="line">salt ‘*’ sys.list_state_functions file</div><div class="line">salt ‘*’ sys.list_state_functions pkg user</div><div class="line">salt ‘*’ sys.list_state_modules</div><div class="line">salt ‘*’ sys.reload_modules</div><div class="line">salt ‘*’ sys.returner_doc</div><div class="line">salt ‘*’ sys.returner_doc sqlite3</div><div class="line">salt ‘*’ sys.returner_doc sqlite3.get_fun</div><div class="line">salt ‘*’ sys.returner_doc sqlite3.get_fun etcd.get_fun</div><div class="line">salt ‘*’ sys.runner_doc</div><div class="line">salt ‘*’ sys.runner_doc cache</div><div class="line">salt ‘*’ sys.runner_doc cache.grains</div><div class="line">salt ‘*’ sys.runner_doc cache.grains mine.get</div><div class="line">salt ‘*’ sys.state_doc</div><div class="line">salt ‘*’ sys.state_doc service</div><div class="line">salt ‘*’ sys.state_doc service.running</div><div class="line">salt ‘*’ sys.state_doc service.running ipables.append</div><div class="line">salt ‘*’ sysctl.assign net.ipv4.ip_forward 1</div><div class="line">salt ‘*’ sysctl.get net.ipv4.ip_forward</div><div class="line">salt ‘*’ sysctl.persist net.ipv4.ip_forward 1</div><div class="line">salt ‘*’ sysctl.show</div><div class="line">salt ‘*’ system.halt</div><div class="line">salt ‘*’ system.init 3</div><div class="line">salt ‘*’ system.poweroff</div><div class="line">salt ‘*’ system.reboot</div><div class="line">salt ‘*’ system.shutdown</div><div class="line">salt ‘*’ test.arg 1 “two” 3.1 txt=”hello” wow='&#123;a: 1, b: “hello”&#125;’</div><div class="line">salt ‘*’ test.arg_repr 1 “two” 3.1 txt=”hello” wow=<span class="string">'&#123;a: 1, b: “hello”&#125;’</span></div><div class="line">salt ‘*’ test.arg_type 1 ‘int’</div><div class="line">salt ‘*’ test.collatz 3</div><div class="line">salt ‘*’ test.conf_test</div><div class="line">salt ‘*’ test.cross_test file.gid_to_group 0</div><div class="line">salt ‘*’ test.echo ‘foo bar baz quo qux’</div><div class="line">salt ‘*’ test.exception ‘Oh noes!’</div><div class="line">salt ‘*’ test.fib 3</div><div class="line">salt ‘*’ test.get_opts</div><div class="line">salt ‘*’ test.kwarg num=1 txt=”two” env='&#123;a: 1, b: “hello”&#125;’</div><div class="line">salt ‘*’ test.not_loaded</div><div class="line">salt ‘*’ test.opts_pkg</div><div class="line">salt ‘*’ test.outputter foobar</div><div class="line">salt ‘*’ test.ping</div><div class="line">salt ‘*’ test.provider service</div><div class="line">salt ‘*’ test.providers</div><div class="line">salt ‘*’ test.rand_sleep 60</div><div class="line">salt ‘*’ test.rand_str</div><div class="line">salt ‘*’ test.retcode 42</div><div class="line">salt ‘*’ test.sleep 20</div><div class="line">salt ‘*’ test.stack</div><div class="line">salt ‘*’ test.tty tty0 ‘This is a <span class="built_in">test</span>’</div><div class="line">salt ‘*’ test.tty pts3 ‘This is a <span class="built_in">test</span>’</div><div class="line">salt ‘*’ test.version</div><div class="line">salt ‘*’ test.versions_information</div><div class="line">salt ‘*’ test.versions_report</div><div class="line">salt ‘*’ timezone.get_hwclock</div><div class="line">salt ‘*’ timezone.get_offset</div><div class="line">salt ‘*’ timezone.get_zone</div><div class="line">salt ‘*’ timezone.get_zonecode</div><div class="line">salt ‘*’ timezone.set_hwclock UTC</div><div class="line">salt ‘*’ timezone.set_zone ‘America/Denver’</div><div class="line">salt ‘*’ timezone.zone_compare ‘America/Denver’</div><div class="line">salt ‘*’ user.add name &lt;uid&gt; &lt;gid&gt; &lt;groups&gt; &lt;home&gt; &lt;shell&gt;</div><div class="line">salt ‘*’ user.chfullname foo “Foo Bar”</div><div class="line">salt ‘*’ user.chgid foo 4376</div><div class="line">salt ‘*’ user.chgroups foo wheel,root True</div><div class="line">salt ‘*’ user.chhome foo /home/users/foo True</div><div class="line">salt ‘*’ user.chhomephone foo “7735551234”</div><div class="line">salt ‘*’ user.chroomnumber foo 123</div><div class="line">salt ‘*’ user.chshell foo /bin/zsh</div><div class="line">salt ‘*’ user.chuid foo 4376</div><div class="line">salt ‘*’ user.chworkphone foo “7735550123”</div><div class="line">salt ‘*’ user.delete name remove=True force=True</div><div class="line">salt ‘*’ user.getent</div><div class="line">salt ‘*’ user.info root</div><div class="line">salt ‘*’ user.list_groups foo</div><div class="line">salt ‘*’ user.list_users</div><div class="line">salt ‘*’ virtualenv.create /path/to/new/virtualenv</div><div class="line">salt ‘*’ virtualenv.get_site_packages /path/to/my/venv</div><div class="line">salt ‘*’ webutil.useradd /etc/httpd/htpasswd larry badpassword</div><div class="line">salt ‘*’ webutil.useradd /etc/httpd/htpasswd larry badpass opts=ns</div><div class="line">salt ‘*’ webutil.useradd /etc/httpd/htpasswd larry badpassword</div><div class="line">salt ‘*’ webutil.useradd /etc/httpd/htpasswd larry badpass opts=ns</div><div class="line">salt ‘*’ webutil.userdel /etc/httpd/htpasswd larry</div></pre></td></tr></table></figure>

	

	

</article>




	<article>
	
		<h1><a href="/2015/11/20/自动化+Jenkins/saltstack/自动化运维工具--saltstack远程启动tomcat日志乱码 /">自动化运维工具--saltstack远程启动tomcat日志乱码</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-11-20</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Automation/">Automation</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Saltstack/">Saltstack</a>
			</span>
		
	</div>

	

	
		<h1 id="自动化运维工具–saltstack远程启动tomcat日志乱码"><a href="#自动化运维工具–saltstack远程启动tomcat日志乱码" class="headerlink" title="自动化运维工具–saltstack远程启动tomcat日志乱码"></a>自动化运维工具–saltstack远程启动tomcat日志乱码</h1><p>最近在线上发布tomcat，想做到自动部署，可是出现了问题，就是日志输出会有乱码，用户名的getMyUserInfo 是一堆乱码，salt原理系统字符集没太深入的研究，后来在墙外看到一篇文章很实用，就做了下自己的总结。</p>
<p>开始我是salt执行远程脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">salt <span class="string">'tomcat_A1'</span> cmd.run <span class="string">'/etc/init.d/tomcat-account start'</span></div></pre></td></tr></table></figure>
<p>直接这样去执行，发现会出现乱码。</p>
<p>这是日志输出结果，我用curl去调我的userinfoid： 调用之前我这边先删除了指定的用户信息redis的缓存，然后在用curl在另外一台机器上面调用看看。</p>
<p>tomcat_A1 机器日志：乱码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">nickname1:?????????</div><div class="line">11111</div><div class="line">nickname1:?????????</div><div class="line">333333</div><div class="line">3</div><div class="line">4</div><div class="line">?????????</div></pre></td></tr></table></figure>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/tomcat_error2.jpg" alt=""></figure></p>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/tomcat_error3.png" alt=""></figure></p>
<p>在minion设置字符集增加LCALL=<code>”zhUS.UTF-8″：</code></p>
<p>cat /etc/sysconfig/i18n</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">LANG=<span class="string">"en_US.UTF-8"</span></div><div class="line">LC_ALL=<span class="string">"zh_US.UTF-8"</span></div><div class="line">SYSFONT=<span class="string">"latarcyrheb-sun16"</span></div></pre></td></tr></table></figure>
<p>cmd.run 调用时需要加入env=’{“LCALL”:“zhCN.UTF-8”}’：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">salt <span class="string">'tomcat_A1'</span> cmd.run <span class="string">'/etc/init.d/tomcat-account sop'</span> env=<span class="string">'&#123;"LC_ALL": "zh_CN.UTF-8"&#125;'</span></div><div class="line"><span class="comment">###先关闭tomcat</span></div><div class="line">salt <span class="string">'tomcat_A1'</span> cmd.run <span class="string">'/etc/init.d/tomcat-account start'</span> env=<span class="string">'&#123;"LC_ALL": "zh_CN.UTF-8"&#125;'</span></div><div class="line"><span class="comment">###在启动tomcat</span></div></pre></td></tr></table></figure>
<p>在调用查看 日志就恢复正常了。数据库的用户名id也正常了，如果你写发布脚本把tomcat启动写在执行脚本里面的话，如果添加了不行，就拆分开，就可以了。</p>
<p>这是一次血的教训啊，对字符集不是很多，完全摸不着头脑，还好多普及了下，终于弄好了。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2015/11/01/自动化+Jenkins/saltstack/自动化运维工具--Saltstack写sls语法批量部署zabbix_agent/">自动化运维工具--Saltstack写sls语法批量部署zabbix_agent</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-11-01</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Automation/">Automation</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Saltstack/">Saltstack</a>
			</span>
		
	</div>

	

	
		<h1 id="Saltstack批量部署zabbix-agent服务"><a href="#Saltstack批量部署zabbix-agent服务" class="headerlink" title="Saltstack批量部署zabbix_agent服务"></a>Saltstack批量部署zabbix_agent服务</h1><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line">epel_install:</div><div class="line">  file.managed:</div><div class="line">    -<span class="ruby"> <span class="symbol">name:</span> /root/zabbix-release-<span class="number">2.4</span>-<span class="number">1</span>.el6.noarch.rpm             <span class="comment">## 指定节点的epel安装包的存放路径</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">source:</span> <span class="symbol">salt:</span>/<span class="regexp">/epel/zabbix</span>-release-<span class="number">2.4</span>-<span class="number">1</span>.el6.noarch.rpm     <span class="comment">## 指定从master的哪个位置拷贝epel的rpm包</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">user:</span> root                                                  <span class="comment">## 文件的拥有者</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">group:</span> root                                                 <span class="comment">## 文件的所属组</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">mode:</span> <span class="number">777</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">backup:</span> minion</span></div><div class="line"></div><div class="line">  cmd.run:</div><div class="line">    -<span class="ruby"> <span class="symbol">name:</span> rpm -ivh /root/zabbix-release-<span class="number">2.4</span>-<span class="number">1</span>.el6.noarch.rpm    <span class="comment">## 执行rpm包的安装</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">unless:</span> test -f /etc/yum.repos.d/epel.repo                  <span class="comment">## 如果存在这个文件就不再执行安装程序</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">require:</span></span></div><div class="line">      -<span class="ruby"> <span class="symbol">file:</span> epel_install</span></div><div class="line"></div><div class="line">SELINUX:</div><div class="line">  cmd.run:</div><div class="line">    -<span class="ruby"> <span class="symbol">name:</span> service iptables stop &amp;&amp; chkconfig iptables off &amp;&amp; setenforce <span class="number">0</span>      </span></div><div class="line"></div><div class="line">   #sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config</div><div class="line">   </div><div class="line">    -<span class="ruby"> <span class="symbol">require:</span></span></div><div class="line">      -<span class="ruby"> <span class="symbol">file:</span> epel_install</span></div><div class="line"></div><div class="line">cache_yum:</div><div class="line">  cmd.run:</div><div class="line">    -<span class="ruby"> <span class="symbol">name:</span> yum makecache                                 <span class="comment">## 生成yum的缓存</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">require:</span> </span></div><div class="line">      -<span class="ruby"> <span class="symbol">file:</span> epel_install                              <span class="comment">## 生成缓存要在epel安装之后</span></span></div><div class="line"></div><div class="line">zabbix-agentd:</div><div class="line">  pkg.installed: []</div><div class="line">  service.running:</div><div class="line">#    - name: zabbix-agent</div><div class="line">#    - running</div><div class="line">    -<span class="ruby"> <span class="symbol">enable:</span> True</span></div><div class="line">    -<span class="ruby"> <span class="symbol">reload:</span> True</span></div><div class="line">    -<span class="ruby"> <span class="symbol">watch:</span></span></div><div class="line">      -<span class="ruby"> <span class="symbol">file:</span> /etc/zabbix/zabbix_agentd.conf</span></div><div class="line">    -<span class="ruby"> <span class="symbol">require:</span></span></div><div class="line">      -<span class="ruby"> <span class="symbol">file:</span> epel_install</span></div><div class="line"><span class="comment"></span></div><div class="line"></div><div class="line">/etc/zabbix/zabbix_agentd.conf:</div><div class="line">   file.managed:</div><div class="line">    -<span class="ruby"> <span class="symbol">source:</span> <span class="symbol">salt:</span>/<span class="regexp">/zabbix/zabbix</span>_agentd.conf</span></div><div class="line">    -<span class="ruby"> <span class="symbol">user:</span> zabbix                                          <span class="comment">## 文件的拥有者</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">group:</span> zabbix                                         <span class="comment">## 文件的所属组</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">mode:</span> <span class="number">644</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">backup:</span> minion</span></div><div class="line">    -<span class="ruby"> <span class="symbol">template:</span> jinja</span></div><div class="line">    -<span class="ruby"> <span class="symbol">require:</span></span></div><div class="line">      -<span class="ruby"> <span class="symbol">file:</span> epel_install</span></div><div class="line"></div><div class="line">ntp:</div><div class="line">  pkg.installed: []                                        ## 安装ntp </div><div class="line">#     name: ntp</div><div class="line">  service.running:</div><div class="line">#     name: ntpd</div><div class="line">#     running</div><div class="line">     enable: True</div><div class="line">    reload: True</div><div class="line">    watch:</div><div class="line">    file: /etc/ntp.conf</div><div class="line">    require:                                            ## 安装ntp要在epel安装之后</div><div class="line">    file: epel_install</div><div class="line"><span class="comment"></span></div><div class="line">/etc/ntp.conf:</div><div class="line">  file.managed:</div><div class="line">    -<span class="ruby"> <span class="symbol">source:</span> <span class="symbol">salt:</span>/<span class="regexp">/ntp/ntp</span>.conf</span></div><div class="line">    -<span class="ruby"> <span class="symbol">user:</span> root                                          <span class="comment">## 文件的拥有者</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">group:</span> root                                         <span class="comment">## 文件的所属组</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">mode:</span> <span class="number">644</span></span></div><div class="line">    -<span class="ruby"> <span class="symbol">backup:</span> minion</span></div><div class="line">    -<span class="ruby"> <span class="symbol">require:</span></span></div><div class="line">      -<span class="ruby"> <span class="symbol">file:</span> epel_install</span></div></pre></td></tr></table></figure>

	

	

</article>




	<article>
	
		<h1><a href="/2015/11/01/自动化+Jenkins/saltstack/自动化运维工具--SaltStack-分组（使用记录,groups） /">自动化运维工具--SaltStack-分组（使用记录,groups）</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-11-01</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Automation/">Automation</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Saltstack/">Saltstack</a>
			</span>
		
	</div>

	

	
		<h1 id="自动化运维工具–SaltStack-分组（使用记录-groups）"><a href="#自动化运维工具–SaltStack-分组（使用记录-groups）" class="headerlink" title="自动化运维工具–SaltStack-分组（使用记录,groups）"></a>自动化运维工具–SaltStack-分组（使用记录,groups）</h1><p>在使用 SaltStack 对主机进行批量管理的时候，因为不同的服务器组所做的业务功能不同，因此为了更加方便的管理，为了便于管理功能业务相似的minion,Saltstack提供了分组的模式，因为线上机器多，不可能每次都是“*”或者“ip主机名” 这样不现实的。</p>
<p>所以我们现在都是提供分组，哪里的机器分哪个组这样你操作起来就方便而且容易排查，因此就自己在分组使用的过程中有以下一点记录下。</p>
<p>官方文档：<a href="http://docs.saltstack.com/topics/targeting/nodegroups.html" target="_blank" rel="external">http://docs.saltstack.com/topics/targeting/nodegroups.html</a></p>
<p>参考 SaltStack 的官方文档 4.4 Compound matchers 和 4.3. Node groups 知道，对目标服务器分组有以下七种方式，这七种方式的标示符分别为：</p>
<ul>
<li>G – 针对 Grains 做单个匹配，例如：G@os:Ubuntu</li>
<li>E – 针对 minion 针对正则表达式做匹配，例如：E@web\d+.(dev|qa|prod).loc</li>
<li>P – 针对 Grains 做正则表达式匹配，例如：P@os:(RedHat|Fedora|CentOS)</li>
<li>L – 针对 minion 做列表匹配，例如：L@minion1.example.com,minion3.domain.com or bl*.domain.com</li>
<li>I – 针对 Pillar 做单个匹配，例如：I@pdata:foobar</li>
<li>S – 针对子网或是 IP 做匹配，例如：S@192.168.1.0/24 or S@192.168.1.100</li>
<li>R – 针对客户端范围做匹配，例如： R@%foo.bar</li>
</ul>
<p>然后我自己在做分组的时候，尝试了下 L 是否可以使用正则表达式</p>
<p>配置：</p>
<p>编辑配置文件 vi /etc/salt/master 这里大约706-714行：<br>原文：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#####         Node Groups           #####</span></div><div class="line"><span class="comment">##########################################</span></div><div class="line"><span class="comment"># Node groups allow for logical groupings of minion nodes. A group consists of a group</span></div><div class="line"><span class="comment"># name and a compound target.</span></div><div class="line"><span class="comment">#nodegroups:</span></div><div class="line"><span class="comment">#  group1: 'L@foo.domain.com,bar.domain.com,baz.domain.com and bl*.domain.com'</span></div><div class="line"><span class="comment">#  group2: 'G@os:Debian and foo.domain.com'</span></div></pre></td></tr></table></figure>
<p> 绿色的是指定组名：可以定义自己好记的组名，应用服务器是需要同样配置的，可以放在同一个分组。<br>修改配置：<br>注意：这里组名前面：需要空格，每个用户key名称，都逗号隔开。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#nodegroups:</span></div><div class="line"><span class="comment">#  group1: 'L@foo.domain.com,bar.domain.com,baz.domain.com and bl*.domain.com'</span></div><div class="line"><span class="comment">#  group2: 'G@os:Debian and foo.domain.com'</span></div><div class="line">ihaozhuo1: <span class="string">''</span>L@d_104_article_1,d_108_account_1,d_109_comm_1,d_110_consumer_1‘</div><div class="line">ihaozhuo2: <span class="string">'L@api'</span></div></pre></td></tr></table></figure>
<p>我们来测试下：</p>
<p>-N 是指定分组名称：</p>
<p>执行命令 sudo salt -N “ihaozhuo1” test.ping结果为：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="string">[root@jumper</span> <span class="string">~]#</span> <span class="string">salt</span>  <span class="bullet">-N</span> <span class="string">'ihaozhuo1'</span> <span class="string">test.ping</span></div><div class="line"><span class="attr">d_104_article_1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">d_108_account_1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">d_109_comm_1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">d_110_consumer_1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="string">[root@jumper</span> <span class="string">~]#</span> <span class="string">salt</span>  <span class="bullet">-N</span> <span class="string">'ihaozhuo2'</span> <span class="string">test.ping</span></div><div class="line"><span class="attr">api:</span></div><div class="line">    <span class="literal">True</span></div></pre></td></tr></table></figure>
<p>分组分好几台一起，是可以获取的。匹配指定的key</p>
<p>修改配置尝试一：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="section">#nodegroups:</span></div><div class="line"><span class="section">#  group1: 'L@foo.domain.com,bar.domain.com,baz.domain.com and bl*.domain.com'</span></div><div class="line"><span class="section">#  group2: 'G@os:Debian and foo.domain.com'</span></div><div class="line">ihaozhuo1: ‘ L@JF1-TEST1-001,JF1-TEST1-002 or JF-TEST1-0[<span class="string">0-9</span>][<span class="symbol">0-9</span>]'</div></pre></td></tr></table></figure>
<p>执行命令 sudo salt -N TEST1 test.ping结果为：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="attr">JF1-TEST1-002:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">JF1-TEST1-001:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">JF1-TEST1-003:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">JF1-TEST1-004:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">JF1-TEST1-006:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">JF1-TEST1-005:</span></div><div class="line">    <span class="literal">True</span></div></pre></td></tr></table></figure>
<p>匹配了所有指定的key.</p>
<p>使用 L 列表的方式，必须把 minion 列出来，或者是列出几台后，在后面接 or 或者 and 表达式， or 或者 and 后面接的表达式后面可以使用正则表达式。</p>
<p>注：想使用正则表达式，最好的方式就是使用<code>E</code></p>

	

	

</article>




	<article>
	
		<h1><a href="/2015/10/10/自动化+Jenkins/saltstack/自动化运维工具--Saltstack安装部署配置使用/">自动化运维工具--Saltstack安装部署配置使用</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-10-10</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Automation/">Automation</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Saltstack/">Saltstack</a>
			</span>
		
	</div>

	

	
		<h1 id="自动化运维工具–Saltstack安装部署配置使用"><a href="#自动化运维工具–Saltstack安装部署配置使用" class="headerlink" title="自动化运维工具–Saltstack安装部署配置使用"></a>自动化运维工具–Saltstack安装部署配置使用</h1><p>前言：</p>
<p>开始学saltstack的时候是在现在一家做CDN云加速的那是在2014年，salt刚刚出来所以我觉得我接触应该也算早的。 使用最多的同步下发的用到这个工具，下面我简单介绍和操作给大家看下。<br>Salt 和 Puppet Chef 一样可以让你同时在多台服务器上执行命令也包括安装和配置软件。</p>
<p>Salt 有两个主要的功能：<code>配置管理和远程执行</code>。 Saltstack是一个大型分布式的配置管理系统（安装升级卸载软件，检测环境），也是一个远程命令执行系统。通过c/s的模型实现。服务器端对远程客户机的操作：</p>
<p>###（一）部署虚拟化环境</p>
<p>（1）两组服务器进行，操作系统版本为Centos release 6.4 RHEL 也可以。 （2）安装这个先安装下epel 由于现在网络RHEL官网yum源还没有 saltstack的安装包支持。因此先安装epel作为部署saltstack的默认yum源。</p>
<ul>
<li>CenOs 5 版本: rpm -Uvh 下载地址：<a href="http://ftp.linux.ncsu.edu/pud/epel/6/i386/epel-release-5-4.noarch.rpm" target="_blank" rel="external">http://ftp.linux.ncsu.edu/pud/epel/6/i386/epel-release-5-4.noarch.rpm</a></li>
<li>CenOs 6 版本: rpm -Uvh 下载地址：<a href="http://ftp.linux.ncsu.edu/pud/epel/6/i386/epel-release-6-8.noarch.rpm" target="_blank" rel="external">http://ftp.linux.ncsu.edu/pud/epel/6/i386/epel-release-6-8.noarch.rpm</a></li>
<li>百度云也可以去下载，我的是centos 64位的 <a href="http://pan.baidu.com/s/1eQGWboI" target="_blank" rel="external">http://pan.baidu.com/s/1eQGWboI</a></li>
</ul>
<p><code>(1) 主服务器 （主控端） IP：192.168.23.21</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-id">#rpm</span> -ivh http:<span class="comment">//mirrors.sohu.com/fedora-epel/6/x86_64/epel-release-6-8.noarch.rpm</span></div><div class="line"><span class="selector-id">#yum</span> install salt-master -y    （安装salt-master）</div><div class="line"><span class="selector-id">#chkconfig</span> salt-master on</div><div class="line"><span class="selector-id">#service</span> salt-master start</div></pre></td></tr></table></figure>
<p><code>(2)从服务器安装 （被控端）IP：192.168.23.24</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">yum install salt-minion -y （安装salt-minion）</span></div><div class="line"><span class="meta">#</span><span class="bash">chkconfig salt-master on</span></div><div class="line"><span class="meta">#</span><span class="bash">service salt-master start</span></div></pre></td></tr></table></figure>
<p>到这里已经安装完成。</p>
<p><code>Saltstack 防火墙配置</code></p>
<p>在主控端添加TCP 4505,TCP 4506 的规则，而在被控端无须配置防火墙，原理是被控端直接与主控端的zeromp建立链接。 接收 广播道任务信息并执行，具体操作是添加两条iptables规则：</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-A INPUT -m <span class="keyword">state</span> --state new -m tcp -p tcp --dport <span class="number">4505</span> -j ACCEPT</div><div class="line">-A INPUT -m <span class="keyword">state</span> --state new -m tcp -p tcp --dport <span class="number">4506</span> -j ACCEPT</div></pre></td></tr></table></figure>
<p>默认配置文件位于/etc/salt/master ，默认不需要更改该配置文件。master端有两个端口需要在iptables上放行.</p>
<p><strong>部署要求：两台机器网络互通，最好关闭防火墙。关闭selinux. 在启动下服务。</strong></p>
<p>更新Saltstack 配置及安装效验。</p>
<p>Saltsatack 分两种，一种为master (主控制)，另一端为minion (被控端)，安装完毕后需要对两种角色的配置文件进行修改。 具体说明如下：</p>
<p>（1） master 主控端配置</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  vim /etc/salt/master</div><div class="line">  # 绑定Master 通信<span class="built_in">IP</span>；</div><div class="line">  interface :<span class="number">192.168</span><span class="meta">.23</span><span class="meta">.21</span></div><div class="line">  #自动认证，避免手动运行salt-key 来确认证书信任；</div><div class="line">  auto-accept:True</div><div class="line"></div><div class="line">  修改/etc/hosts</div><div class="line">主机要添加被控机器的<span class="built_in">IP</span> 和主机名</div><div class="line"><span class="number">192.168</span><span class="meta">.23</span><span class="meta">.24</span>  xx.rix.com</div></pre></td></tr></table></figure>
<p><strong>服务端配置</strong></p>
<p>主控端基本设置 编辑配置文件 /etc/salt/master,修改如下所示配置项，去掉前面的注释符</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">interface:</span> <span class="number">192.168</span><span class="number">.23</span><span class="number">.21</span></div><div class="line"><span class="symbol">log_file:</span> <span class="meta-keyword">/var/</span>log<span class="meta-keyword">/salt/</span>master      <span class="meta"># 记录主控端运行日志</span></div><div class="line"><span class="symbol">key_logfile:</span> <span class="meta-keyword">/var/</span>log<span class="meta-keyword">/salt/</span>key      <span class="meta"># 记录认证证书日志</span></div></pre></td></tr></table></figure>
<p> <strong>客户端配置</strong> </p>
<p>修改/etc/hosts</p>
<p>主机要添加服务端机器的IP 和主机名</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">192<span class="selector-class">.168</span><span class="selector-class">.23</span><span class="selector-class">.21</span>  <span class="selector-tag">salt</span></div></pre></td></tr></table></figure>
<p> 受控端基本设置 编辑配置文件 /etc/salt/minion,修改如下所示配置项，去掉前面的注释符#</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="literal">master</span>: <span class="number">192.168</span>.<span class="number">23.21</span>        <span class="comment"># 设置主控端</span></div><div class="line">这里<span class="literal">master</span>设置主控端可以hosts名称：</div><div class="line"><span class="comment">#master: salt</span></div><div class="line">前提是要设置hosts.</div></pre></td></tr></table></figure>
<p>我这里直接配置的是主机名，也可以配置成IP地址，如果配置成主机名的话，就需要在/etc/hosts文件中master主机对应的IP ，如果使用内部DNS的例外，可以在内部DNS上的统一配置。</p>
<p>在其下增加一行内容为：</p>
<figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- <span class="attribute">id:</span><span class="string"> tomcatA1</span></div></pre></td></tr></table></figure>
<p>这里是指定当前主机的id号，这在后面master认证和master调用命令执行时显示的名称，可以根据实际识别需要填写。另外需要注意的是，<code>以上两处配置冒号后面都需要有一个空格，不然会报如下错误：</code></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">log_file:</span> <span class="meta-keyword">/var/</span>log<span class="meta-keyword">/salt/</span>minion  <span class="meta"># 记录受控端运行日志</span></div><div class="line"><span class="symbol">key_logfile:</span> <span class="meta-keyword">/var/</span>log<span class="meta-keyword">/salt/</span>key  <span class="meta"># 记录认证证书日志</span></div></pre></td></tr></table></figure>
<p><strong>主控端和受控端</strong></p>
<p> 启动各自的服务，确保服务启动后没有任何报错信息,如果异常请检查相应日志文件处理</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">主控端: service salt-<span class="keyword">master</span> <span class="title">restart</span></div><div class="line">受控端: service salt-minion restart</div></pre></td></tr></table></figure>
<p>saltstack 主控端是依靠openssl证书来与受控端主机认证通讯的，受控端启动后会发送给主控端一个公钥证书文件，在主控端用 salt-key 命令来管理证书。</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">salt-<span class="built_in">key</span> -L                  <span class="meta"># 用来查看证书情况</span></div><div class="line">salt-<span class="built_in">key</span> -a 服务端名称或IP    <span class="meta"># 用来管理接受证书</span></div><div class="line">salt-<span class="built_in">key</span> -A                <span class="meta"># 用来管理接受所有认证主机的认证</span></div></pre></td></tr></table></figure>
<p>主控端和被控端的证书默认都存放在<code>/etc/salt/pki/</code> 中，如果遇到证书不生效的情况下，可在主控端证书存放目录删除受控端证书，重新认证一下。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="selector-attr">[root@ny-cloud-pagespeed00 ~]</span># <span class="selector-tag">salt-key</span> <span class="selector-tag">-a</span>  192<span class="selector-class">.168</span><span class="selector-class">.23</span><span class="selector-class">.24</span></div><div class="line"><span class="selector-tag">The</span> <span class="selector-tag">following</span> <span class="selector-tag">keys</span> <span class="selector-tag">are</span> <span class="selector-tag">going</span> <span class="selector-tag">to</span> <span class="selector-tag">be</span> <span class="selector-tag">accepted</span>:</div><div class="line"><span class="selector-tag">Unaccepted</span> <span class="selector-tag">Keys</span>:</div><div class="line">192<span class="selector-class">.168</span><span class="selector-class">.23</span><span class="selector-class">.24</span></div><div class="line"><span class="selector-tag">Proceed</span>? <span class="selector-attr">[n/Y]</span> <span class="selector-tag">y</span>   #这里输入<span class="selector-tag">y</span> 代表同意加入证书。</div><div class="line"></div><div class="line"><span class="selector-attr">[root@ny-cloud-pagespeed00 minions]</span># <span class="selector-tag">salt</span> <span class="selector-tag">-v</span> "<span class="selector-tag">xx</span><span class="selector-class">.rix</span><span class="selector-class">.com</span>" <span class="selector-tag">test</span><span class="selector-class">.ping</span>  #这里的<span class="selector-class">.com</span>是受控机的<span class="selector-tag">hostname</span> 认证名称。</div><div class="line"></div><div class="line"><span class="selector-tag">Executing</span> <span class="selector-tag">job</span> <span class="selector-tag">with</span> <span class="selector-tag">jid</span> 20151004162442004183</div><div class="line"> <span class="selector-tag">-------------------------------------------</span></div><div class="line"></div><div class="line"><span class="selector-tag">xx</span><span class="selector-class">.rix</span><span class="selector-class">.com</span>:</div><div class="line"><span class="selector-tag">True</span></div></pre></td></tr></table></figure>
<p>这里可以获取到认证，那么我们把认证加进去。</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">[root@salt ~]<span class="comment"># salt-key -L</span></div><div class="line">Accepted Keys:</div><div class="line">Gateway1</div><div class="line">Gateway2</div><div class="line">ihaozhuo1</div><div class="line">ihaozhuo2</div><div class="line"><span class="keyword">node</span></div><div class="line"><span class="title">openapi</span></div><div class="line">report1</div><div class="line">report2</div><div class="line">tomcat_A1</div><div class="line">tomcat_A2</div><div class="line">tomcat_B1</div><div class="line">tomcat_B2</div><div class="line">tomcat_bmw</div><div class="line">tomcat_C1</div><div class="line">tomcat_C2</div><div class="line">weixin</div><div class="line">Denied Keys:</div><div class="line">Unaccepted Keys:</div><div class="line">Rejected Keys:</div></pre></td></tr></table></figure>
<p>我上面用的-A参数，该参数意思是接受所有认证主机的认证，也可以使用 -a id名 只认证单独的主机。默认认证完成后会在/etc/salt/pki/master/minions目录找到以ID名命令的文件，里面存放的是密钥文件。</p>
<p>如果对客户端信任，可以让master自动接受请求，在master端/etc/salt/master配置。</p>
<h3 id="（二）命令执行"><a href="#（二）命令执行" class="headerlink" title="（二）命令执行"></a>（二）命令执行</h3><p><code>True</code>代表正常，<code>*</code>代表所有主机，也可以选择单台或者按组及正则进行匹配等，这个可以参看下官方相关文档 。其默认执行的正则是shell正则，也可以使用其他正则或组等，如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="string">[root@salt</span> <span class="string">~]#</span> <span class="string">salt</span> <span class="string">'*'</span> <span class="string">test.ping</span></div><div class="line"><span class="string">[root@salt</span> <span class="string">~]#</span> <span class="string">salt</span> <span class="string">'*'</span> <span class="string">test.ping</span></div><div class="line"><span class="attr">tomcat_C2:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">tomcat_B2:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">ihaozhuo1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">ihaozhuo2:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">openapi:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">tomcat_B1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">tomcat_C1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">weixin:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">tomcat_A1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">tomcat_A2:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">node:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">Gateway2:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">report1:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">report2:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">tomcat_bmw:</span></div><div class="line">    <span class="literal">True</span></div><div class="line"><span class="attr">Gateway1:</span></div><div class="line">    <span class="string">Minion</span> <span class="string">did</span> <span class="string">not</span> <span class="string">return.</span> <span class="string">[Not</span> <span class="string">connected]</span></div></pre></td></tr></table></figure>
<p>这里可以看到有一台ping不通，就应该上去查看下。</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root@Gateway1 ~]<span class="comment"># ps -ef | grep minion</span></div><div class="line">root    <span class="number"> 15343 </span>15168 <span class="number"> 0 </span>11:22 pts/0    00:00:00 grep --color=auto minion</div><div class="line">[root@Gateway1 ~]<span class="comment"># service salt-minion start</span></div><div class="line">Redirecting to /bin/systemctl start  salt-minion.service</div><div class="line">[root@Gateway1 ~]<span class="comment"># ps -ef | grep minion</span></div><div class="line">root    <span class="number"> 15422 </span>   <span class="number"> 1 </span><span class="number"> 7 </span>11:22 ?        00:00:00 /usr/bin/python /usr/bin/salt-minion</div><div class="line">root    <span class="number"> 15431 </span>15422<span class="number"> 46 </span>11:22 ?        00:00:00 /usr/bin/python /usr/bin/salt-minion</div><div class="line">root    <span class="number"> 15494 </span>15168 <span class="number"> 0 </span>11:22 pts/0    00:00:00 grep --color=auto minion</div></pre></td></tr></table></figure>
<p>原来是进程挂了，所有这也是salt什么都好唯一一点缺点就是需要配置客户端启动服务，这样对网络传输等等都有要求比较高。一旦进程死了，几百台以上可能就比较费力。</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby"> salt <span class="string">'shell正则'</span> 命令</span></div><div class="line">-<span class="ruby"> salt -E <span class="string">'prel 正则'</span></span></div><div class="line">-<span class="ruby"> salt -N $group 命令</span></div><div class="line">-<span class="ruby"> salt -L <span class="string">'server_id1,server_id2,server_id3'</span> 命令</span></div></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">常用的操作类似如下</div><div class="line">- salt <span class="string">'*'</span> cmd<span class="selector-class">.run</span> <span class="string">"ab -n 10 -c 2 http://www.google.com/"</span></div><div class="line">- salt <span class="string">'*'</span> grains<span class="selector-class">.ls</span> 查看grains分类</div><div class="line">- salt <span class="string">'*'</span> grains<span class="selector-class">.items</span> 查看grains所有信息</div><div class="line">- salt <span class="string">'*'</span> grains<span class="selector-class">.item</span> osrelease 查看grains某个信息</div><div class="line">- salt <span class="string">'*'</span> cmd<span class="selector-class">.run</span> <span class="string">"/App/nginx/sbin/nginx -v"</span></div></pre></td></tr></table></figure>

	

	

</article>




	<article>
	
		<h1><a href="/2015/09/10/自动化+Jenkins/saltstack/自动化运维工具-Saltstack的详细介绍安装与使用以及语法开发操作/">自动化运维工具-Saltstack的详细介绍安装与使用以及语法开发操作</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-09-10</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Automation/">Automation</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Saltstack/">Saltstack</a>
			</span>
		
	</div>

	

	
		<h2 id="引言-自动化运维"><a href="#引言-自动化运维" class="headerlink" title="引言:自动化运维"></a>引言:自动化运维</h2><h3 id="1-saltstack-的基本介绍"><a href="#1-saltstack-的基本介绍" class="headerlink" title="1:saltstack 的基本介绍"></a>1:saltstack 的基本介绍</h3><h4 id="2-salt-的安装"><a href="#2-salt-的安装" class="headerlink" title="2:salt 的安装"></a>2:salt 的安装</h4><ul>
<li>服务端 <ul>
<li>安装</li>
<li>配置文件 </li>
<li>运行 </li>
<li>注意事项</li>
</ul>
</li>
<li>客户端 <ul>
<li>安装</li>
<li>配置文件</li>
<li>运行</li>
<li>注意事项</li>
</ul>
</li>
</ul>
<h4 id="3-salt-的使用"><a href="#3-salt-的使用" class="headerlink" title="3:salt 的使用:"></a>3:salt 的使用:</h4><ul>
<li>基础知识<ul>
<li>targeting </li>
<li>nodegroup </li>
<li>grains </li>
<li>pillar</li>
</ul>
</li>
<li>状态管理 <ul>
<li>state</li>
<li>state 语法</li>
<li>state 的逻辑关系 </li>
<li>highstate</li>
<li>salt schedule </li>
</ul>
</li>
<li>实时管理 <ul>
<li>cmd.run</li>
<li>module </li>
</ul>
</li>
<li>无 master<h4 id="4-salt-开发"><a href="#4-salt-开发" class="headerlink" title="4:salt 开发"></a>4:salt 开发</h4></li>
<li>saltclient 管理 salt<ul>
<li>salt api</li>
</ul>
</li>
</ul>
<h3 id="引言-自动化运维-运维的工作主要在2方面"><a href="#引言-自动化运维-运维的工作主要在2方面" class="headerlink" title="引言:自动化运维 运维的工作主要在2方面:"></a>引言:自动化运维 运维的工作主要在2方面:</h3><ol>
<li>状态的管理</li>
<li>系统性能调优 这里主要简介下运维状态的管理:<br>对于运维来说,基于状态的配置管理已经向自动化迈进了一大步,以状态为核心的运维,<br>让状态本身有了可管理性;在运维过程中我们会发现,同样的一个配置,我们会在不同的时间, 不同的地点一次在一次的配置,这个时候,配置管理就有了重复性;有的甚至是原封不动的重 复,而另外一些则是按照一定的规律在发展,这些按照一定规律发展的配置,就是可预测的.综 上我认识的,我们运维工作的本身是可管理,可重复,可预测的.基于这样的理念,我们就可以更 高一步的推进我们的运维自动化,甚至到智能化.</li>
</ol>
<p>看到这里,我理想中的运维自动化的配置管理平台应该有如下功能: </p>
<ol>
<li>对状态的配置及管理(最基本的) </li>
<li>可以及时的对系统状态进行调整并能看到结果(可以方便的实时升级系统状态)</li>
<li>可以对其本身做方便的第三方管理(借助其 API,直接给状态制定好其发展方向)</li>
</ol>
<h5 id="加分项"><a href="#加分项" class="headerlink" title="加分项:"></a>加分项:</h5><ol>
<li>开发语言单一</li>
<li>架构简单,灵活 </li>
<li>有不差的安全性 </li>
<li>没有商业版<br>下面是现有比较有代表性的自动化配置管理工具: 附:以下仅基于开源版本进行介绍</li>
</ol>
<h4 id="理念-优缺点"><a href="#理念-优缺点" class="headerlink" title="理念 优缺点"></a>理念 优缺点</h4><p>puppet 从运维的角度去做配置管理(运维人员做给运维用的) 架构简单,系统比较成<br>熟/不便于第三方管理</p>
<p>chef 从研发的角度去做配置管理(研发人员做给运维用的) 较便于第三方管理,对<br>自身(节点,变量,cookbook)的管理较方便,有自己的 dashboard,cookbook 支持版本管理,自从 cookbook 的版本管理/架构复杂,开发语言较多,(安全问题)</p>
<ul>
<li>以上 2 者都比较侧重于状态的管理,对单个或者多个状态的临时调整或者管理较差 2 个都有商业版,让我这个用开源版的很自卑</li>
</ul>
<p>这里我们也能看到,2 个配置功能都没能达到我理想中的状态,那就暂用 chef 吧,直到有 一天,了解到了 saltstack 看到了这句话:“ 系统配置的自动化不仅可预测,可重复, 还具有可 管理性”(<a href="http://wiki.saltstack.cn/reproduction/dive-into-saltstack),这尼玛才是运维自动化的未" target="_blank" rel="external">http://wiki.saltstack.cn/reproduction/dive-into-saltstack),这尼玛才是运维自动化的未</a> 来啊,于是毫无节操的开始学习 salt,而且发现越学越喜欢;在我使用 puppet 及 chef 的时 候都没有使用 salt 的感觉,太爽了。所以我这里仅仅介绍几本的语法不涉及实际用例,salt 的安装非常方便,所以你在看本文档的时候希望你能真正的动手去做一下,然后你就会爱上 salt 了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">附:如果你会 python,salt 基本是不需要怎么学的,而我正好了解一点 py,不过这最多占我选择 salt 的 20%。</div></pre></td></tr></table></figure>
<h3 id="1-saltstack-的基本介绍-1"><a href="#1-saltstack-的基本介绍-1" class="headerlink" title="1:saltstack 的基本介绍"></a>1:saltstack 的基本介绍</h3><p>salt 是一个新的基础平台管理工具。很短的时间即可运行并使用起来, 扩展性足以支撑<br>管理上万台服务器,数秒钟即可完成数据传递. 经常被描述为 Func 加强版+Puppet 精简版。</p>
<p>salt 的整个架构都是基于消息来实现.所以能够提供横强的拓展性,灵活性,实时性;不夸 了,看实际的 slat 是什么样的不过 salt 还是一个很年轻的东西,还有很多地方不够完善,做的不够好,不过我相信这 些都只是时间问题。</p>
<ul>
<li>注:以下文档仅仅为基本内容,相关知识点的深入学习,请看相应文档连接 ##2:salt 的安装</li>
</ul>
<p>安装有很多途径,作为一个 centos 的用户,我选择 rpm 首先添加 RPM 源:<br>rpm -ivh <a href="http://mirrors.sohu.com/fedora-epel/6/x86_64/epel-release-6-8.noarch.rpm" target="_blank" rel="external">http://mirrors.sohu.com/fedora-epel/6/x86_64/epel-release-6-8.noarch.rpm</a></p>
<h5 id="附-实际生产中我是自建源"><a href="#附-实际生产中我是自建源" class="headerlink" title="附:实际生产中我是自建源"></a>附:实际生产中我是自建源</h5><p>epel 中关于 salt 的包:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">salt-api.noarch : A web api <span class="keyword">for</span> to access salt the parallel remote execution system salt-master.noarch : Management component <span class="keyword">for</span> salt, a parallel remote execution</div><div class="line">system</div><div class="line">salt-minion.noarch : Client component <span class="keyword">for</span> salt, a parallel remote execution system salt.noarch : A parallel remote execution system</div><div class="line">salt-cloud.noarch : Generic cloud provisioning tool</div></pre></td></tr></table></figure>
<h4 id="1-服务端-1-安装"><a href="#1-服务端-1-安装" class="headerlink" title="1:服务端 1:安装"></a>1:服务端 1:安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">yum install salt-master 2:配置文件</div><div class="line">/etc/salt/master</div><div class="line">配置文件选项介绍: http://docs.saltstack.com/ref/configuration/master.html</div><div class="line">最基本字段:</div><div class="line">interface: 服务端监听 IP</div><div class="line">3:运行 调试模式:</div><div class="line">salt-master <span class="_">-l</span> debug 后台运行:</div><div class="line">salt-master <span class="_">-d</span></div><div class="line">作为 centos 管理员,我选择:</div><div class="line">/etc/init.d/salt-master start </div><div class="line"></div><div class="line">4:注意事项:</div><div class="line">1:监听端口</div><div class="line">4505(publish_port):salt 的消息发布系统 4506(ret_port):salt 客户端与服务端通信的端口</div><div class="line">所以确保客户端能跟服务端的这2个端口通信</div></pre></td></tr></table></figure>
<h4 id="安装客户端"><a href="#安装客户端" class="headerlink" title="安装客户端"></a>安装客户端</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">yum install salt-minion 2:配置文件</div><div class="line">/etc/salt/minion</div><div class="line">配置文件选项介绍: http://docs.saltstack.com/ref/configuration/minion.html 最基本字段:</div><div class="line">master: 服务端主机名</div><div class="line">id: 客户端主机名(在服务端看到的客户端的名字)</div><div class="line">3:运行 调试模式:</div><div class="line">salt-minion <span class="_">-l</span> debug 后台运行:</div><div class="line">salt-minion <span class="_">-d</span></div><div class="line">作为 centos 管理员,我选择:</div><div class="line">/etc/init.d/salt-minion start </div><div class="line"></div><div class="line">4:注意事项:</div><div class="line">1:minion 默认和主机名 salt 的主机通信 </div><div class="line"></div><div class="line">2:关于配置文件</div><div class="line">salt 的配置文件均为 yaml 风格</div><div class="line"><span class="variable">$key</span>: <span class="variable">$value</span> <span class="comment">#注意冒号后有一个空格 3:基础知识</span></div><div class="line">1:salt minion 和 master 的认证过程:</div><div class="line">(1) minion 在第一次启动时,会在/etc/salt/pki/minion/下自动生成</div><div class="line">minion.pem(private key), minion.pub(public key),然后将 minion.pub 发送给 master</div><div class="line">(2) master 在接收到 minion 的 public key 后,通过 salt-key 命令 accept minion public key,这样在 master 的/etc/salt/pki/master/minions 下的将会存放以 minion id 命名的</div><div class="line">public key, 然后 master 就能对 minion 发送指令了</div><div class="line">如下: </div><div class="line">启动服务端:</div><div class="line">/etc/init.d/salt-minion restart</div><div class="line">启动客户端:</div><div class="line">/etc/init.d/salt-minion restart </div><div class="line"></div><div class="line">服务端查看key:</div><div class="line">salt-key</div><div class="line">Accepted Keys:</div><div class="line">Unaccepted Keys: minion1</div><div class="line">Rejected Keys:</div><div class="line">服务端接受 key salt-key <span class="_">-a</span> minion1</div><div class="line"></div><div class="line">测试:</div><div class="line">salt <span class="string">'minion1'</span> test.ping minion1:</div><div class="line">True</div><div class="line">附:salt 更多命令及手册 salt <span class="string">'*'</span> sys.doc</div></pre></td></tr></table></figure>
<h3 id="3-salt-的使用-1-基础知识"><a href="#3-salt-的使用-1-基础知识" class="headerlink" title="3:salt 的使用: 1:基础知识"></a>3:salt 的使用: 1:基础知识</h3><p>1:targeting</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">salt <span class="string">'*'</span> test.ping</div><div class="line">引号中以实现很强大的 minion 的过滤与匹配技术 文档:http://docs.saltstack.com/topics/targeting /compound.html</div><div class="line">常用命令:</div><div class="line">salt <span class="string">'shell 正则'</span> 命令</div><div class="line">salt -E <span class="string">'prel 正则'</span></div><div class="line">salt -N <span class="variable">$group</span> 命令</div><div class="line">salt -L <span class="string">'server_id1,server_id2,server_id3'</span> 命令</div><div class="line">示例:</div><div class="line">salt -C <span class="string">'webserv* and G@os:Debian or E@web-dc1-srv.*'</span> test.ping</div></pre></td></tr></table></figure>
<p>2:nodegroup<br>对 minion 进行分组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">文档: http://docs.saltstack.com/topics/targeting/nodegroups.html 在 master 的配置文件中按如下格式定义:</div><div class="line">nodegroups:</div><div class="line">group1: <span class="string">'L@foo.domain.com,bar.domain.com,baz.domain.com or</span></div><div class="line">bl*.domain.com'</div><div class="line">group2: <span class="string">'G@os:Debian and foo.domain.com'</span> 在 state 或者 pillar 中引用的时候如下:</div><div class="line">base: group1:</div><div class="line">- match: nodegroup - webserver</div></pre></td></tr></table></figure>
<p>3:grains<br>minion 基本信息的管理 文档:<a href="http://docs.saltstack.com/topics/targeting" target="_blank" rel="external">http://docs.saltstack.com/topics/targeting</a> /grains.html 基本使用:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">salt <span class="string">'*'</span> grains.ls 查看 grains 分类</div><div class="line">salt <span class="string">'*'</span> grains.items 查看 grains 所有信息</div><div class="line">salt <span class="string">'*'</span> grains.item osrelease 查看 grains 某个信息</div><div class="line">示例:</div><div class="line">salt <span class="string">'*'</span> grains.item osrelease minoin1:</div><div class="line">osrelease: 6.2</div></pre></td></tr></table></figure>
<h3 id="minion-的变量"><a href="#minion-的变量" class="headerlink" title="minion 的变量"></a>minion 的变量</h3><p>在用 salt 进行管理客户端的时候或者写 state 的时候都可以引用 grains 的变量 4:pillar</p>
<p>salt 敏感信息的管理,只有匹配到的节点才能看到和使用 文档:<a href="http://docs.saltstack.com/topics/tutorials/pillar.html" target="_blank" rel="external">http://docs.saltstack.com/topics/tutorials/pillar.html</a> 默认:pillar 数据定义文件存储路径:/srv/pillar 入口文件:/srv/pillar/top.sls</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">格式: base:</div><div class="line"><span class="string">"targeting"</span>:</div><div class="line">- <span class="variable">$pillar</span></div><div class="line"><span class="variable">$pillar</span>.sls 基本:</div><div class="line"><span class="variable">$key</span>: <span class="variable">$value</span> state 引用方式:</div><div class="line">&#123;&#123; pillar[<span class="string">'$key'</span>] &#125;&#125;</div><div class="line">复杂:</div><div class="line">users:</div><div class="line">thatch: 1000 shouse: 1001 utahdave: 1002 redbeard: 1003</div><div class="line">state 引用方式:</div><div class="line">&#123;% <span class="keyword">for</span> user, uid <span class="keyword">in</span> pillar.get(<span class="string">'users'</span>, &#123;&#125;).items() %&#125;</div><div class="line">&#123;&#123;user&#125;&#125;: user.present:</div><div class="line">- uid: &#123;&#123;uid&#125;&#125; &#123;% endfor %&#125;</div><div class="line">查看节点的 pillar 数据: salt <span class="string">'client2'</span> pillar.data</div><div class="line">同步 pillar:</div><div class="line">salt <span class="string">'*'</span> saltutil.refresh_pillar</div><div class="line">附:这里我们可以看到,pallar 中也可以使用 jinja(后面会提到)做一些处理 5:minion</div><div class="line">即为 salt 的客户端</div><div class="line">2:状态管理 1:state</div><div class="line">salt 基于 minion 进行状态的管理 1:state 语法</div><div class="line">文档:http://docs.saltstack.com/ref/states/all/index.html</div><div class="line"><span class="comment">#名字为pillar.sls的文件来存放对匹配到的</span></div><div class="line">&#123;% <span class="keyword">if</span> grains[<span class="string">'os_family'</span>] == <span class="string">'RedHat'</span> %&#125; - name: vim-enhanced</div><div class="line">&#123;% <span class="keyword">elif</span> grains[<span class="string">'os'</span>] == <span class="string">'Debian'</span> %&#125;</div><div class="line">- name: vim-nox</div><div class="line">&#123;% <span class="keyword">elif</span> grains[<span class="string">'os'</span>] == <span class="string">'Ubuntu'</span> %&#125; - name: vim-nox</div><div class="line">&#123;% endif %&#125;</div><div class="line">- installed</div><div class="line">如果是 redhard 系列的就安装 vim-enhanced,如果系统是 Debian 或 者 Ubuntu 就安装 vim-nox</div><div class="line">以有多个</div><div class="line">附:state 默认使用 jinja(http://jinja.pocoo.org/)的模板语法, 文档地址: http://jinja.pocoo.org /docs/templates/</div></pre></td></tr></table></figure>
<p>2:state 的逻辑关系: 文档:<a href="http://docs.saltstack.com/ref/states/ordering.html" target="_blank" rel="external">http://docs.saltstack.com/ref/states/ordering.html</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">require:依赖某个 state,在运行此 state 前,先运行依赖的 state,依赖可</div><div class="line">httpd: pkg:</div><div class="line">- installed file.managed:</div><div class="line">- name: /etc/httpd/conf/httpd.conf </div><div class="line">- <span class="built_in">source</span>: salt://httpd/httpd.conf</div><div class="line">- require:</div><div class="line">- pkg: httpd</div></pre></td></tr></table></figure>
<p>watch:在某个 state 变化时运行此模块 redis:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">pkg:</div><div class="line">- latest</div><div class="line">file.managed:</div><div class="line">- <span class="built_in">source</span>: salt://redis/redis.conf</div><div class="line">- name: /etc/redis.conf</div><div class="line">- require:</div><div class="line">- pkg: redis service.running: </div><div class="line">- <span class="built_in">enable</span>: True</div><div class="line"><span class="comment">#state 的名字</span></div></pre></td></tr></table></figure>
<p>$state: #要管理的模块类型 - $State states #该模块的状态</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- watch:</div><div class="line">- file: /etc/redis.conf </div><div class="line">- pkg: redis</div></pre></td></tr></table></figure>
<p>附:watch 除具备 require 功能外,还增了关注状态的功能</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">order:</div><div class="line">优先级比 require 和 watch 低</div><div class="line">有 order 指定的 state 比没有 order 指定的优先级高 vim:</div><div class="line">pkg.installed: - order: 1</div><div class="line">想让某个 state 最后一个运行,可以用 last 3:state 与 minion</div><div class="line"></div><div class="line">将临时给 minoin 加个 state</div><div class="line">salt <span class="string">'minion1'</span> state.sls <span class="string">'vim'</span> <span class="comment">#给 minion1 加一个 vim 的 state 执行该命令后可以立即看到输出结果</span></div><div class="line"></div><div class="line">2:highstate</div><div class="line">给 minion 永久下添加状态</div><div class="line">文档: http://docs.saltstack.com/ref/states/highstate.html 默认配置文件:/srv/salt/top.sls</div><div class="line">语法:</div><div class="line"><span class="string">'*'</span>:</div><div class="line">- core</div><div class="line">- wsproxy </div><div class="line">- /srv/salt/目录结构:</div><div class="line">.</div><div class="line">├── core.sls ├── top.sls └── wsproxy</div><div class="line">├── init.sls ├── websocket.py └── websockify</div><div class="line">应用:</div><div class="line">salt <span class="string">"minion1"</span> state.highstate</div><div class="line"></div><div class="line">测试模式:</div><div class="line">salt <span class="string">"minion1"</span> state.highstate -v <span class="built_in">test</span>=True 3:salt schedule</div><div class="line">默认的 state 只有在服务端调用的时候才执行,很多时候我们希望 minon 自觉 的去保持在某个状态</div><div class="line"></div><div class="line">文档:http://docs.saltstack.com/topics/<span class="built_in">jobs</span>/schedule.html</div><div class="line">cat /srv/pillar/top.sls base:</div><div class="line"><span class="string">"*"</span>:</div><div class="line">- schedule</div><div class="line">cat /srv/pillar/schedule.sls schedule:</div><div class="line">highstate:</div><div class="line"><span class="keyword">function</span>: state.highstate minutes: 30</div><div class="line"></div><div class="line">如上配置:</div><div class="line">minion 会没 30 分钟从 master 拉去一次配置,进行自我配置</div><div class="line"></div><div class="line">3:实时管理 有时候我们需要临时的查看一台或多台机器上的某个文件,或者执行某个命令</div><div class="line">1:cmd.run</div><div class="line">用法 salt <span class="string">'$targeting'</span> cmd.run <span class="string">'$cmd'</span></div><div class="line">示例:salt <span class="string">'*'</span> cmd.run <span class="string">'hostname'</span> 执行下这样的命令,马上就感受到效果了,速度还贼快</div><div class="line">2:module</div><div class="line">同时,salt 也将一些常用的命令做了集成 文档:http://docs.saltstack.com/ref/modules/all/index.html 这里几乎涵盖了我们所有的常用命令</div><div class="line">比如:</div><div class="line">查看所有节点磁盘使用情况</div><div class="line">salt <span class="string">'*'</span> disk.usage 文档:http://docs.saltstack.com/topics/tutorials/quickstart.html</div><div class="line">4:无 master</div><div class="line">主要应该在测试和 salt 单机管理的时候</div></pre></td></tr></table></figure>
<h3 id="4-salt-开发-1"><a href="#4-salt-开发-1" class="headerlink" title="4:salt 开发"></a>4:salt 开发</h3><p>1:saltclient 管理 salt<br>只有才 master 才可以salt 全部用 python,这里也用 python<br>文档:<a href="http://docs.saltstack.com/ref/python-api.html" target="_blank" rel="external">http://docs.saltstack.com/ref/python-api.html</a> </p>
<p>示例:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">import salt.client</div><div class="line">client = salt.client.LocalClient()</div><div class="line">ret = client.cmd(<span class="string">'*'</span>, <span class="string">'cmd.run'</span>, [<span class="string">'ls -l'</span>])</div><div class="line"><span class="built_in">print</span> ret</div></pre></td></tr></table></figure>
<p>2:salt api<br>salt api 我现在还没用,不过我也没搞定,如果你搞定了,我会非常感谢你能分享<br>下的。</p>
<p>####参考文档:</p>
<p>1:salt 中文 wiki:<a href="http://wiki.saltstack.cn/" target="_blank" rel="external">http://wiki.saltstack.cn/</a> 很不错的文章:<a href="http://wiki.saltstack.cn/reproduction/dive-into-saltstack" target="_blank" rel="external">http://wiki.saltstack.cn/reproduction/dive-into-saltstack</a><br>2:salt 官网 <a href="http://saltstack.com/" target="_blank" rel="external">http://saltstack.com/</a> 官网文档:<a href="http://docs.saltstack.com/" target="_blank" rel="external">http://docs.saltstack.com/</a></p>

	

	

</article>




	<article>
	
		<h1><a href="/2015/07/23/运维笔记/CDN加速助力高并发网站架构/">CDN加速助力高并发网站架构</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-07-23</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Framework/">Framework</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/CDN/">CDN</a>
			</span>
		
	</div>

	

	
		<h2 id="CDN加速助力高并发网站架构"><a href="#CDN加速助力高并发网站架构" class="headerlink" title="CDN加速助力高并发网站架构"></a>CDN加速助力高并发网站架构</h2><p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/CDN1.png" alt=""></figure></p>
<h2 id="架构说明："><a href="#架构说明：" class="headerlink" title="架构说明："></a>架构说明：</h2><p>用户通过互联网访问网站需要经过的节点如下：</p>
<h4 id="一、要通过域名解析"><a href="#一、要通过域名解析" class="headerlink" title="一、要通过域名解析"></a>一、要通过域名解析</h4><p>在域名解析处有两种方式<br>1、自建，自建需要在域名解析前架设防火墙。</p>
<p>2、使用现有的域名解析提供商，需要设置成CNAME,其实就是另一个域名解析，进行跳转。在刚开始的时候建议先用CNAME方式，部署不影响用户现有方式，容易被用户接受，而且不用暂时不用担心第一级dns的问题。</p>
<p>总之，如果要建设idc加速，防止ddos攻击之类的服务，域名解析服务一定要提供，不管是直接提供dns服务还是间接通过cname转发。<br>里面的主要技术，是通过用户请求的ip来得到离用户最近的服务器的地址，并通过它来提供服务。如果要进行安全防护，比如sql注入检查，js跨站脚本等可以在这一层进行处理。</p>
<h4 id="二、提供虚拟机"><a href="#二、提供虚拟机" class="headerlink" title="二、提供虚拟机"></a>二、提供虚拟机</h4><p>虚拟机现在主流有两种方式，一是虚拟主机，主要的软件有开源的openvz，商用的Virtuozzo等,另一类是虚拟机如vmware、xen、kvm等，这类提供虚拟操作系统，可以是异构的。他们两个的对比主要是虚拟主机的利用率比较高，可以一台主流pcserver可以虚拟几十个到上百个虚拟主机，但只能是同一类操作系统。虚拟机的运行效率相对低很多，一般主流pcserver也就十几个左右。他的有点是异构操作系统，备份管理比较方便。当然在建设的时候可以先用虚拟机，然后在虚拟机上建设虚拟主机。</p>
<p>如果要提供对外服务，ip地址是比不可少的，对于一个用户来说，一个域名需要几个点，就需要几个ip。</p>
<h4 id="三、LVS集群"><a href="#三、LVS集群" class="headerlink" title="三、LVS集群"></a>三、LVS集群</h4><p>由于要提供加速等服务，用户直接使用的openvz虚拟主机的性能和效率一般不大，又要提供高可用性，所以需要通过虚拟主机访问lvs集群的数据，通过lvs集群来提供服务。</p>
<h4 id="四、Squid"><a href="#四、Squid" class="headerlink" title="四、Squid"></a>四、Squid</h4><p>Squid是缓存，尤其是对静态页面和文件有很好加速效果。sina、sohu等都用它来做缓存加速。</p>
<h4 id="五、Nginx​"><a href="#五、Nginx​" class="headerlink" title="五、Nginx​"></a>五、Nginx​</h4><p>Nginx主要提供反向代理功能，当通过修改或者更新了页面，由nginx来负责更新缓存。还有就是动态网站，也是由nginx来提供服务。</p>
<p>Nginx和sqid都可以提供静态缓存功能，两者还要结合起来发挥最大效果。如果要进行安全防护，比如sql注入检查，js跨站脚本等可以在这一层进行处理。<br>防DDOS</p>
<h4 id="六、自动化工具-Docker运行"><a href="#六、自动化工具-Docker运行" class="headerlink" title="六、自动化工具+Docker运行"></a>六、自动化工具+Docker运行</h4><p>Saltstask 自动化工具批量初始化脚本更新监控脚本，增删改查添加缓存机制。上百台服务器节省我们操作时间，物理机运行Docker程序。</p>
<h2 id="防ddos的主要内容由两个方面："><a href="#防ddos的主要内容由两个方面：" class="headerlink" title="防ddos的主要内容由两个方面："></a>防ddos的主要内容由两个方面：</h2><h4 id="一、带宽"><a href="#一、带宽" class="headerlink" title="一、带宽"></a>一、带宽</h4><p>这个是很重要的地方，据我现在从网上得到的资料，现在主流的idc机房一般最大提供独立百兆端口，而且价格不菲。在这种情况下可以机柜租用。这个还需要调研是否可以提供更大的带宽。</p>
<h4 id="二、防火墙设备"><a href="#二、防火墙设备" class="headerlink" title="二、防火墙设备"></a>二、防火墙设备</h4><p>需要在接入口部署防火墙，需要根据idc接口端口来确定容量，有的idc机房也提供此服务。</p>
<h4 id="三、流量牵引设备"><a href="#三、流量牵引设备" class="headerlink" title="三、流量牵引设备"></a>三、流量牵引设备</h4><p>这个一般idc机房会提供此服务，这个根据需要是否需要购买。</p>
<h4 id="交流学习："><a href="#交流学习：" class="headerlink" title="交流学习："></a>交流学习：</h4><p>🐧  Linux shell_高级运维派: <code>459096184</code>    圈子 (系统运维-应用运维-自动化运维-虚拟化技术研究欢迎加入)<br>🐧  BigData-Exchange School : <code>521621407</code>  圈子（大数据运维)（Hadoop开发人员)（大数据研究爱好者) 欢迎加入</p>
<p>相应Bidata有内部微信交流群互相学习，加入QQ群有链接。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2015/04/01/运维安全/使用AIDE做Linux高级入侵检测文件监控/">使用AIDE做Linux高级入侵检测文件监控</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2015-04-01</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/运维安全/">运维安全</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Operation-safety/">Operation safety</a>
			</span>
		
	</div>

	

	
		<h2 id="1、aide介绍"><a href="#1、aide介绍" class="headerlink" title="1、aide介绍"></a>1、aide介绍</h2><blockquote>
<p>AIDE(Adevanced Intrusion Detection Environment,高级入侵检测环境)是个入侵检测工具，主要用途是检查文本的完整性。</p>
<p>AIDE能够构造一个指定文档的数据库，他使用aide.conf作为其配置文档。AIDE数据库能够保存文档的各种属性，包括：权限(permission)、索引节点序号(inode number)、所属用户(user)、所属用户组(group)、文档大小、最后修改时间(mtime)、创建时间(ctime)、最后访问时间(atime)、增加的大小连同连接数。AIDE还能够使用下列算法：sha1、md5、rmd160、tiger，以密文形式建立每个文档的校验码或散列号。</p>
<p>常见的入侵检测软件： tripwire–操作比较复杂,aide–用以代替tripwire,比较简单.</p>
</blockquote>
<h3 id="系统环境："><a href="#系统环境：" class="headerlink" title="系统环境："></a>系统环境：</h3><p>　　RHEL 6.2 [2.6.32-220.el6.i686]</p>
<p>　　软件环境：</p>
<h3 id="2、aide安装-配置使用"><a href="#2、aide安装-配置使用" class="headerlink" title="2、aide安装 配置使用"></a>2、aide安装 配置使用</h3><p>yum rpm二进制安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install aide</div></pre></td></tr></table></figure>
<blockquote>
<p>我的配置文件</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div></pre></td><td class="code"><pre><div class="line">mv /etc/aide.conf /etc/aide.conf.bak</div><div class="line">vim /etc/aide.conf</div><div class="line"> </div><div class="line"></div><div class="line"><span class="comment"># Example configuration file for AIDE.</span></div><div class="line">@@define DBDIR /var/lib/aide <span class="comment">#基准数据库目录</span></div><div class="line">@@define LOGDIR /var/<span class="built_in">log</span>/aide <span class="comment">#日志目录</span></div><div class="line"> </div><div class="line"></div><div class="line"><span class="comment"># The location of the database to be read.</span></div><div class="line">database=file:@@&#123;DBDIR&#125;/aide.db.gz <span class="comment">#基础数据库文件</span></div><div class="line"> </div><div class="line"><span class="comment"># The location of the database to be written.    #database_out=sql:host:port:database:login_name:passwd:table</span></div><div class="line"><span class="comment">#database_out=file:aide.db.new</span></div><div class="line">database_out=file:@@&#123;DBDIR&#125;/aide.db.new.gz <span class="comment">#更新数据库文件</span></div><div class="line"> </div><div class="line"><span class="comment"># Whether to gzip the output to database</span></div><div class="line">gzip_dbout=yes</div><div class="line"> </div><div class="line"><span class="comment"># Default.</span></div><div class="line">verbose=5</div><div class="line"> </div><div class="line">report_url=file:@@&#123;LOGDIR&#125;/aide.log</div><div class="line">report_url=stdout</div><div class="line"><span class="comment">#report_url=stderr</span></div><div class="line"><span class="comment">#NOT IMPLEMENTED report_url=mailto:root@foo.com</span></div><div class="line"><span class="comment">#NOT IMPLEMENTED report_url=syslog:LOG_AUTH</span></div><div class="line"> </div><div class="line"><span class="comment"># These are the default rules.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#p:      permissions</span></div><div class="line"><span class="comment">#i:      inode:</span></div><div class="line"><span class="comment">#n:      number of links</span></div><div class="line"><span class="comment">#u:      user</span></div><div class="line"><span class="comment">#g:      group</span></div><div class="line"><span class="comment">#s:      size</span></div><div class="line"><span class="comment">#b:      block count</span></div><div class="line"><span class="comment">#m:      mtime</span></div><div class="line"><span class="comment">#a:      atime</span></div><div class="line"><span class="comment">#c:      ctime</span></div><div class="line"><span class="comment">#S:      check for growing size</span></div><div class="line"><span class="comment">#acl:           Access Control Lists</span></div><div class="line"><span class="comment">#selinux        SELinux security context</span></div><div class="line"><span class="comment">#xattrs:        Extended file attributes</span></div><div class="line"><span class="comment">#md5:    md5 checksum</span></div><div class="line"><span class="comment">#sha1:   sha1 checksum</span></div><div class="line"><span class="comment">#sha256:        sha256 checksum</span></div><div class="line"><span class="comment">#sha512:        sha512 checksum</span></div><div class="line"><span class="comment">#rmd160: rmd160 checksum</span></div><div class="line"><span class="comment">#tiger:  tiger checksum</span></div><div class="line"> </div><div class="line"><span class="comment">#haval:  haval checksum (MHASH only)</span></div><div class="line"><span class="comment">#gost:   gost checksum (MHASH only)</span></div><div class="line"><span class="comment">#crc32:  crc32 checksum (MHASH only)</span></div><div class="line"><span class="comment">#whirlpool:     whirlpool checksum (MHASH only)</span></div><div class="line"> </div><div class="line"> <span class="comment">#R:              p+i+n+u+g+s+m+c+acl+selinux+xattrs+md5</span></div><div class="line"><span class="comment">#L:             p+i+n+u+g+acl+selinux+xattrs</span></div><div class="line"><span class="comment">#E:             Empty group</span></div><div class="line"><span class="comment">#&gt;:             Growing logfile       p+u+g+i+n+S+acl+selinux+xattrs</span></div><div class="line">R = p+i+n+u+g+s+m+c+acl+selinux+xattrs+md5</div><div class="line">L = p+i+n+u+g+acl+selinux+xattrs</div><div class="line">&gt; = p+u+g+i+n+S+acl+selinux+xattrs</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="comment"># You can create custom rules like this.</span></div><div class="line"><span class="comment"># With MHASH...</span></div><div class="line"><span class="comment"># ALLXTRAHASHES =      sha1+rmd160+sha256+sha512+whirlpool+tiger+haval+gost+crc32</span></div><div class="line">ALLXTRAHASHES = sha1+rmd160+sha256+sha512+tiger</div><div class="line"><span class="comment"># Everything but access time (Ie. all changes)</span></div><div class="line">EVERYTHING = R+ALLXTRAHASHES</div><div class="line"> </div><div class="line"><span class="comment"># Sane, with multiple hashes</span></div><div class="line"><span class="comment"># NORMAL = R+rmd160+sha256+whirlpool</span></div><div class="line">NORMAL = R+rmd160+sha256</div><div class="line"> </div><div class="line"><span class="comment"># For directories, don't bother doing hashes</span></div><div class="line">DIR = p+i+n+u+g+acl+selinux+xattrs</div><div class="line"> </div><div class="line"> <span class="comment"># Access control only</span></div><div class="line"> PERMS = p+i+u+g+acl+selinux</div><div class="line"> </div><div class="line"> <span class="comment"># Logfile are special, in that they often change</span></div><div class="line"> LOG = &gt;</div><div class="line"> </div><div class="line"> <span class="comment"># Just do md5 and sha256 hashes</span></div><div class="line"> LSPP = R+sha256</div><div class="line"> </div><div class="line"> <span class="comment"># Some files get updated automatically, so the     inode/ctime/mtime change</span></div><div class="line"> <span class="comment"># but we want to know when the data inside them   changes</span></div><div class="line"> DATAONLY =     p+n+u+g+s+acl+selinux+xattrs+md5+sha256+rmd160+tiger</div><div class="line"> </div><div class="line"> <span class="comment"># Next decide what directories/files you want in the database.</span></div><div class="line"> </div><div class="line">/boot   NORMAL</div><div class="line">/bin    NORMAL</div><div class="line">/sbin   NORMAL</div><div class="line">/lib    NORMAL</div><div class="line">/lib64  NORMAL</div><div class="line">/opt    NORMAL</div><div class="line">/usr    NORMAL</div><div class="line">/root   NORMAL</div><div class="line"><span class="comment"># These are too volatile</span></div><div class="line">!/usr/src</div><div class="line">!/usr/tmp</div><div class="line">!/usr/share <span class="comment">#通过文件路径前面加感叹号 ! 排除这个路径的监控,请自定义</span></div><div class="line"> <span class="comment"># Check only permissions, inode, user and group for /etc, but</span></div><div class="line"><span class="comment"># cover some important files closely.</span></div><div class="line">/etc    PERMS</div><div class="line">!/etc/mtab</div><div class="line"> <span class="comment"># Ignore backup files</span></div><div class="line">!/etc/.*~</div><div class="line">/etc/exports  NORMAL</div><div class="line">/etc/fstab    NORMAL</div><div class="line">/etc/passwd   NORMAL</div><div class="line">/etc/group    NORMAL</div><div class="line">/etc/gshadow  NORMAL</div><div class="line">/etc/shadow   NORMAL</div><div class="line">/etc/security/opasswd   NORMAL</div><div class="line"> </div><div class="line">/etc/hosts.allow   NORMAL</div><div class="line">/etc/hosts.deny    NORMAL</div><div class="line"> </div><div class="line">/etc/sudoers NORMAL</div><div class="line">/etc/skel NORMAL</div><div class="line"> </div><div class="line">/etc/logrotate.d NORMAL</div><div class="line"> </div><div class="line">/etc/resolv.conf DATAONLY</div><div class="line"> </div><div class="line">/etc/nscd.conf NORMAL</div><div class="line">/etc/securetty NORMAL</div><div class="line"> </div><div class="line"><span class="comment"># Shell/X starting files</span></div><div class="line">/etc/profile NORMAL</div><div class="line">/etc/bashrc NORMAL</div><div class="line">/etc/bash_completion.d/ NORMAL</div><div class="line">/etc/login.defs NORMAL</div><div class="line">/etc/zprofile NORMAL</div><div class="line">/etc/zshrc NORMAL</div><div class="line">/etc/zlogin NORMAL</div><div class="line">/etc/zlogout NORMAL</div><div class="line">/etc/profile.d/ NORMAL</div><div class="line">/etc/X11/ NORMAL</div><div class="line">  </div><div class="line"><span class="comment"># Pkg manager</span></div><div class="line">/etc/yum.conf NORMAL</div><div class="line">/etc/yumex.conf NORMAL</div><div class="line">/etc/yumex.profiles.conf NORMAL</div><div class="line">/etc/yum/ NORMAL</div><div class="line"> /etc/yum.repos.d/ NORMAL</div><div class="line"> </div><div class="line"> /var/<span class="built_in">log</span>   LOG</div><div class="line"> /var/run/utmp LOG</div><div class="line"> </div><div class="line"> <span class="comment"># This gets new/removes-old filenames daily</span></div><div class="line">!/var/<span class="built_in">log</span>/sa</div><div class="line"> <span class="comment"># As we are checking it, we've truncated     yesterdays size to zero.</span></div><div class="line"> !/var/<span class="built_in">log</span>/aide.log</div><div class="line"> </div><div class="line"><span class="comment"># LSPP rules...</span></div><div class="line"><span class="comment"># AIDE produces an audit record, so this becomes       # /var/log/audit/ LSPP</span></div><div class="line">/etc/audit/ LSPP</div><div class="line">/etc/libaudit.conf LSPP</div><div class="line">/usr/sbin/stunnel LSPP</div><div class="line">/var/spool/at LSPP</div><div class="line">/etc/at.allow LSPP</div><div class="line">/etc/at.deny LSPP</div><div class="line">/etc/cron.allow LSPP</div><div class="line">/etc/cron.deny LSPP</div><div class="line">/etc/cron.d/ LSPP</div><div class="line">/etc/cron.daily/ LSPP</div><div class="line">/etc/cron.hourly/ LSPP</div><div class="line">/etc/cron.monthly/ LSPP</div><div class="line">/etc/cron.weekly/ LSPP</div><div class="line">/etc/crontab LSPP</div><div class="line">/var/spool/cron/root LSPP</div><div class="line"> </div><div class="line">/etc/login.defs LSPP</div><div class="line">/etc/securetty LSPP</div><div class="line">/var/<span class="built_in">log</span>/faillog LSPP</div><div class="line">/var/<span class="built_in">log</span>/lastlog LSPP</div><div class="line"> </div><div class="line">/etc/hosts LSPP</div><div class="line">/etc/sysconfig LSPP</div><div class="line"> </div><div class="line">/etc/inittab LSPP</div><div class="line">/etc/grub/ LSPP</div><div class="line">/etc/rc.d LSPP</div><div class="line"> </div><div class="line">/etc/ld.so.conf LSPP</div><div class="line"> </div><div class="line"> /etc/localtime LSPP</div><div class="line"> </div><div class="line">/etc/sysctl.conf LSPP</div><div class="line"> </div><div class="line">/etc/modprobe.conf LSPP</div><div class="line"> </div><div class="line">/etc/pam.d LSPP</div><div class="line">/etc/security LSPP</div><div class="line">/etc/aliases LSPP</div><div class="line">/etc/postfix LSPP</div><div class="line"> </div><div class="line">/etc/ssh/sshd_config LSPP</div><div class="line"> /etc/ssh/ssh_config LSPP</div><div class="line"> </div><div class="line">/etc/stunnel LSPP</div><div class="line"> </div><div class="line">/etc/vsftpd.ftpusers LSPP</div><div class="line"> /etc/vsftpd LSPP</div><div class="line"> </div><div class="line">/etc/issue LSPP</div><div class="line">/etc/issue.net LSPP</div><div class="line">  </div><div class="line">/etc/cups LSPP</div><div class="line"> </div><div class="line"><span class="comment"># With AIDE's default verbosity level of 5, these would give lots of</span></div><div class="line"><span class="comment"># warnings upon tree traversal. It might change with  future version.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#=/lost\+found    DIR</span></div><div class="line"><span class="comment">#=/home           DIR</span></div><div class="line"> </div><div class="line"><span class="comment"># Ditto /var/log/sa reason...</span></div><div class="line">!/var/<span class="built_in">log</span>/and-httpd</div><div class="line"> </div><div class="line"><span class="comment"># Admins dot files constantly change, just check perms</span></div><div class="line">/root/\..* PERMS</div></pre></td></tr></table></figure>
<h4 id="下一步："><a href="#下一步：" class="headerlink" title="下一步："></a>下一步：</h4><p> 初始化监控数据库(这需要一些时间)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">  /usr/sbin/aide -c /etc/aide.conf --init</div><div class="line">``` </div><div class="line">把当前初始化的数据库作为开始的基础数据库</div><div class="line"></div><div class="line">``` bash</div><div class="line">     cp /var/lib/aide/aide.db.new.gz       /var/lib/aide/aide.db.gz</div></pre></td></tr></table></figure>
<p>如果是正常的改动 更新改动到基础数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">aide --update</div><div class="line"><span class="built_in">cd</span> /var/lib/aide/</div></pre></td></tr></table></figure>
<p>覆盖替换旧的数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mv aide.db.new.gz aide.db.gz</div></pre></td></tr></table></figure>
<p>在终端中查看检测结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">aide --check</div></pre></td></tr></table></figure>
<p>检查文件改动 保存到文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">    aide --check --report=file:/tmp/aide-report-`date +%Y%m%d`.txt</div><div class="line">``` </div><div class="line">定时任务执行aide检测报告和自动邮件发送aide检测报告(如果没有mail, yum install mail,还需要有本地邮件服务支持, yum install sendmail;/etc/init.d/sendmail start)</div><div class="line">  </div><div class="line">``` bash</div><div class="line">    crontab <span class="_">-e</span></div><div class="line">    00 02 * * * /usr/sbin/aide -C -V4 | /bin/mail <span class="_">-s</span> <span class="string">"AIDE REPORT <span class="variable">$(date +%Y%m%d)</span>"</span>  root@localhost</div></pre></td></tr></table></figure>
<h3 id="5、参考"><a href="#5、参考" class="headerlink" title="5、参考"></a>5、参考</h3><ul>
<li><p>官网 :<a href="http://aide.sourceforge.net/" target="_blank" rel="external">http://aide.sourceforge.net/</a></p>
</li>
<li><p>AIDE –Linux高级入侵检测 <a href="http://gupt12.blog.51cto.com/7651206/1263183" target="_blank" rel="external">http://gupt12.blog.51cto.com/7651206/1263183</a></p>
</li>
<li><p>参考：<a href="http://www.iamle.com/archives/1664.html" target="_blank" rel="external">http://www.iamle.com/archives/1664.html</a></p>
</li>
</ul>

	

	

</article>





	<span class="different-posts">📖 <a href="/page/11">more posts</a> 📖</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<h5>Hi there,</h5>
	<p style="text-align:justify;">my name is Yancy, they know me as Radiant🐑🐑. This blog is about Bi-data and my live.<br> I like 🌳🌳🌳</p>
</div>


	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2017 Yancy | Powered by <a href="http://blog.yancy.cc/">Yancy</a> | Theme <a href="https://github.com/yangcvo">Yancy_GitHub</a></span>
		</div>

	</div>


</footer>



</body>

</html>
