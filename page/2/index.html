<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Yancy&#39;s blog</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="Yancy&#39;s blog" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link">Home</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/archives" class="header__link">ARCHIVES</a>
			
				<a href="/about/About" class="header__link">ABOUT</a>
			
				<a href="http://weibo.com/yangcvo" class="header__link">Weibo</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Yancy&#39;s blog</a></h1>
		<h2 class="header__subtitle">SIMPLICITY IS PREREQUISITE FOR  RELIABILITY</h2>
	</header>

	<main>
		
	<span class="different-posts different-posts_earlier">ğŸ“– <a href="/">earlier posts</a> ğŸ“–</span>




	<article>
	
		<h1><a href="/2017/08/27/Bigdata-hadoop/zookeeper/Bigdata-Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜ /">Bigdata-Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-08-27</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata/">Bigdata</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/ZooKeeper/">ZooKeeper</a>
			</span>
		
	</div>

	

	
		<h4 id="Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜"><a href="#Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜" class="headerlink" title="Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜"></a>Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜</h4><h3 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h3><p>æ­å»ºzookeeperå’Œkafkaé›†ç¾¤è¿è¡Œå¤§æ•°æ®å¤„ç†æ•°æ®æ¶ˆè´¹ï¼Œå…¬å¸dubboä½¿ç”¨zookeeperåšæœåŠ¡ç«¯çš„æœåŠ¡å‘ç°ç®¡ç†åŠé…ç½®ä¸­å¿ƒï¼Œåœ¨ä½¿ç”¨æ—¶éƒ½å‡ºç°è¿‡ç”±äºzkçš„æ—¥å¿—å¤§å°è¿‡å¤§å¡æ»¡ç£ç›˜çš„æƒ…å†µ ï¼Œé‡åˆ°äº†Zookeeperæ—¥å¿—é—®é¢˜è¾“å‡ºè·¯å¾„çš„é—®é¢˜, å‘ç°zookeeperè®¾ç½®log4j.propertiesä¸èƒ½è§£å†³æ—¥å¿—è·¯å¾„é—®é¢˜, å‘ç°è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ã€‚</p>
<p><img src="http://7xrthw.com1.z0.glb.clouddn.com/zookeeper_cartoon.jpg" alt=""></p>
<h3 id="zookeeperæ—¥å¿—è¯´æ˜"><a href="#zookeeperæ—¥å¿—è¯´æ˜" class="headerlink" title="zookeeperæ—¥å¿—è¯´æ˜"></a>zookeeperæ—¥å¿—è¯´æ˜</h3><p>ZooKeeperä½¿ç”¨<code>SLF4J(the Simple Logging Facade for Java)</code>ä½œä¸ºæ—¥å¿—çš„æŠ½è±¡å±‚ï¼Œé»˜è®¤ä½¿ç”¨<code>Log4J</code>æ¥åšå®é™…çš„æ—¥å¿—å·¥ä½œã€‚ä½¿ç”¨2å±‚æ—¥å¿—æŠ½è±¡çœ‹èµ·æ¥çœŸæ˜¯å¤Ÿå‘›ï¼Œè¿™é‡Œç®€è¦çš„è¯´æ˜å¦‚ä½•æ¥é…ç½®<code>Log4J</code>ã€‚å°½ç®¡Log4Jéå¸¸çµæ´»ä¸”å¼ºå¤§ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›å¤æ‚ï¼Œå¯ä»¥ç”¨ä¸€æ•´æœ¬ä¹¦æ¥æè¿°å®ƒï¼Œè¿™é‡Œåªæ˜¯ç®€è¦çš„ä»‹ç»ä¸€ä¸‹åŸºæœ¬çš„ç”¨æ³•ã€‚</p>
		<p><a class="article__read-more-link" href="/2017/08/27/Bigdata-hadoop/zookeeper/Bigdata-Zookeeperé›†ç¾¤æ—¥å¿—é…ç½®è¯¦è§£å’Œæ¸…ç†è‡ªå®šä¹‰å¯åŠ¨å†…å­˜ /">...read more</a></p>
	

	

</article>




	<article>
	
		<h1><a href="/2017/08/04/Bigdata-hadoop/Kafka/Monitor Kafka with Prometheus +Grafana/">Monitor Kafka with Prometheus +Grafana</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-08-04</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata-Hadoop/">Bigdata Hadoop</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Grafana/">Grafana</a> <a class="article__tag-link" href="/tags/Kafka/">Kafka</a> <a class="article__tag-link" href="/tags/Prometheus/">Prometheus</a>
			</span>
		
	</div>

	

	
		<h3 id="Monitoring-Kafka-with-Prometheus"><a href="#Monitoring-Kafka-with-Prometheus" class="headerlink" title="Monitoring Kafka with Prometheus"></a>Monitoring Kafka with Prometheus</h3><p>Weâ€™ve previously looked at how to monitor Cassandra with <a href="https://www.robustperception.io/monitoring-cassandra-with-prometheus/" target="_blank" rel="external">Prometheus</a>. Letâ€™s see the process for getting metrics from another popular Java application, <a href="https://kafka.apache.org/" target="_blank" rel="external">Kafka.</a></p>
<p><img src="http://7xrthw.com1.z0.glb.clouddn.com/kafka-overview.png" alt=""></p>
		<p><a class="article__read-more-link" href="/2017/08/04/Bigdata-hadoop/Kafka/Monitor Kafka with Prometheus +Grafana/">...read more</a></p>
	

	

</article>




	<article>
	
		<h1><a href="/2017/08/01/Bigdata-hadoop/Kafka/Kafka-nodeæ¨¡å—å®ç°è°ƒç”¨jså‘é€æ•°æ®/">Bigdata-Kafka-nodeæ¨¡å—å®ç°è°ƒç”¨jså‘é€æ•°æ®</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-08-01</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/å¤§æ•°æ®/">å¤§æ•°æ®</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Kafka/">Kafka</a>
			</span>
		
	</div>

	

	
		<p><img src="http://7xrthw.com1.z0.glb.clouddn.com/streams-interactive-queries-02.png" alt=""></p>
<p>mongodbå†™åˆ°kafka æŒ‡å®štopicæ¶ˆè´¹ã€‚ä¸ºäº†ä¿è¯æ•°æ®ç¨³å®šå¯é æ€§ã€‚<br>é…åˆå¤§æ•°æ®åœ¨countly ä½¿ç”¨å¼€æº<code>Kafka-node</code>æ˜¯ä¸€ä¸ªNode.jså®¢æˆ·ç«¯ å†™jsç¨‹åºè®©countlyä¸‰å°é›†ç¾¤åˆ†åˆ«æ•°æ®åˆ°kafka åšæ–°çš„topicä¸»é¢˜å¤‡ä»½ã€‚</p>
		<p><a class="article__read-more-link" href="/2017/08/01/Bigdata-hadoop/Kafka/Kafka-nodeæ¨¡å—å®ç°è°ƒç”¨jså‘é€æ•°æ®/">...read more</a></p>
	

	

</article>




	<article>
	
		<h1><a href="/2017/07/29/Bigdata-hadoop/countly/Cloudera Manager5åŠCDH5å®‰è£…æŒ‡å¯¼/">Bigdata-Cloudera Manager5åŠCDH5å®‰è£…æŒ‡å¯¼</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-07-29</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata-Hadoop/">Bigdata Hadoop</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Bigdata-Hadoop/">Bigdata Hadoop</a> <a class="article__tag-link" href="/tags/Countly/">Countly</a>
			</span>
		
	</div>

	

	
		<p><img src="http://7xrthw.com1.z0.glb.clouddn.com/Bigdata-Cloudera-Manager.png" alt=""></p>
<h3 id="é—®é¢˜å¯¼è¯»ï¼š"><a href="#é—®é¢˜å¯¼è¯»ï¼š" class="headerlink" title="é—®é¢˜å¯¼è¯»ï¼š"></a>é—®é¢˜å¯¼è¯»ï¼š</h3><p>1.ä»€ä¹ˆæ˜¯cloudera CM ã€CDH?<br>2.CDHã€CMæœ‰å“ªäº›ç‰ˆæœ¬ï¼Ÿ<br>3.CDHã€CMæœ‰å“ªäº›å®‰è£…æ–¹å¼ï¼Ÿ<br>4.CDHå¦‚ä½•å¼€å‘ï¼Ÿ</p>
		<p><a class="article__read-more-link" href="/2017/07/29/Bigdata-hadoop/countly/Cloudera Manager5åŠCDH5å®‰è£…æŒ‡å¯¼/">...read more</a></p>
	

	

</article>




	<article>
	
		<h1><a href="/2017/07/29/Bigdata-hadoop/RabbitMQ/Zabbix 3.0 ç›‘æ§æ¨é€rabbitmqé˜Ÿåˆ—/">Zabbix 3.0 ç›‘æ§æ¨é€rabbitmqé˜Ÿåˆ—-æ¶ˆæ¯å †ç§¯</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-07-29</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata-Hadoop/">Bigdata Hadoop</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Bigdata-Hadoop/">Bigdata Hadoop</a> <a class="article__tag-link" href="/tags/Rabbitmq/">Rabbitmq</a>
			</span>
		
	</div>

	

	
		<h4 id="Zabbix-3-0-ç›‘æ§æ¨é€rabbitmqé˜Ÿåˆ—"><a href="#Zabbix-3-0-ç›‘æ§æ¨é€rabbitmqé˜Ÿåˆ—" class="headerlink" title="Zabbix 3.0 ç›‘æ§æ¨é€rabbitmqé˜Ÿåˆ—"></a>Zabbix 3.0 ç›‘æ§æ¨é€rabbitmqé˜Ÿåˆ—</h4><p>å¯¹äºRabbitMQçš„ç›‘æ§ï¼Œé™¤äº†æœåŠ¡å™¨åŸºæœ¬ä¿¡æ¯<code>ï¼ˆç¡¬ç›˜ã€CPUã€å†…å­˜ã€IOç­‰ï¼‰</code>ä»¥åŠMQçš„è¿›ç¨‹å’Œç«¯å£ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¯·æ±‚urlè®¿é—®ç®¡ç†APIç›‘æ§å…¶é›†ç¾¤å’Œé˜Ÿåˆ—çš„æƒ…å†µã€‚åœ¨java api 3.6.0ä»¥åï¼Œchannelæ¥å£ä¸ºæˆ‘ä»¬æä¾›äº†å¦‚ä¸‹æ¥å£ï¼š</p>
<ul>
<li>messageCountï¼šæŸ¥è¯¢é˜Ÿåˆ—æœªæ¶ˆè´¹çš„æ¶ˆæ¯æ•°ï¼Œå¯ä»¥ç›‘æ§æ¶ˆæ¯å †ç§¯çš„æƒ…å†µã€‚ </li>
<li>consumerCountï¼šé˜Ÿåˆ—çš„æ¶ˆè´¹è€…ä¸ªæ•°ï¼Œå¯ä»¥å¯¹æ¶ˆè´¹è€…è¿›è¡Œç›‘æ§ </li>
</ul>
<p>1.ç›‘æ§å‘Šè­¦éœ€æ±‚é—®é¢˜ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">message.bié˜Ÿåˆ—  ç§¯å‹&gt; 300 æˆ–è€… æ¶ˆè´¹è€…æ•°&lt;=2</div><div class="line">message.push.carté˜Ÿåˆ—  ç§¯å‹ &gt;10000 æˆ–è€…æ¶ˆè´¹è€…æ•°&lt;5</div><div class="line">message.user.relatedé˜Ÿåˆ— ç§¯å‹&gt;2000 æˆ–è€… æ¶ˆè´¹è€…æ•°&lt;=2</div><div class="line">message.carté˜Ÿåˆ— ç§¯å‹&gt;10000 æˆ–è€… æ¶ˆè´¹è€…æ•°&lt;=2</div></pre></td></tr></table></figure>
<p>2.ç¼–å†™Pythonè„šæœ¬ç›‘æ§è·å–æ¶ˆè´¹è€…æ•°ç›‘æ§ï¼Œé˜Ÿåˆ—ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">vim rabbitmq-monitor.py</div><div class="line"><span class="comment">#!/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></div><div class="line">import sys, urllib2, base64, json, re,time</div><div class="line">ip = <span class="string">"169.23.73.22"</span></div><div class="line">keys = (<span class="string">'messages_ready'</span>,)</div><div class="line">def GetRabbitmqData():</div><div class="line">        request = urllib2.Request(<span class="string">"http://%s:15672/api/queues"</span> % ip)</div><div class="line">        base64string = base64.b64encode(<span class="string">'guest:guest'</span>)</div><div class="line">        request.add_header(<span class="string">"Authorization"</span>, <span class="string">"Basic %s"</span> % base64string)</div><div class="line">        result = urllib2.urlopen(request)</div><div class="line">        data = json.loads(result.read())</div><div class="line">        <span class="built_in">return</span> data</div><div class="line"></div><div class="line"></div><div class="line">data=GetRabbitmqData()</div><div class="line"><span class="comment">#print data</span></div><div class="line"><span class="keyword">for</span> queue <span class="keyword">in</span> data:</div><div class="line">    try:</div><div class="line">        <span class="built_in">print</span> <span class="string">"æ¶ˆè´¹è€…æ•°é‡:"</span>,queue[<span class="string">'consumers'</span>],<span class="string">"é˜Ÿåˆ—:"</span>,queue[<span class="string">'name'</span>],<span class="string">"æ¶ˆæ¯ç§¯å‹æ•°:"</span>,int(queue[keys[0]])</div><div class="line">    except:</div><div class="line">        pass</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[root@message-center-mq zabbix]<span class="comment"># python rabbitmq-monitor.py</span></div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 0 é˜Ÿåˆ—: 79d02dde-2007-4a49-b94b-0d4bee67b19c æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 0 é˜Ÿåˆ—: aliveness-test æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 0 é˜Ÿåˆ—: cartService.orderCancel.update æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 0 é˜Ÿåˆ—: cartService.virtualOrderCancel.update æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 0 é˜Ÿåˆ—: e9de65bd-be59-4c1c-b4a8-7312f382ac59 æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: message.bi æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: message.cart æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: message.console æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: message.logistics æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: message.order.info æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 30 é˜Ÿåˆ—: message.push.cart æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: message.style æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: message.user.related æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 0 é˜Ÿåˆ—: payment.virtual.notify.success æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 1 é˜Ÿåˆ—: 61b73745-4c74-475b-803e-bf2d48d2fa50 æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 1 é˜Ÿåˆ—: a984d00a-8bbe-43c1-aa20-c1dc788ddd97 æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 1 é˜Ÿåˆ—: e569e8a1-b7c9-4736-8bf8-13d76ecf7577 æ¶ˆæ¯ç§¯å‹æ•°: 0</div><div class="line">æ¶ˆè´¹è€…æ•°é‡: 3 é˜Ÿåˆ—: push.station.task.status æ¶ˆæ¯ç§¯å‹æ•°: 0</div></pre></td></tr></table></figure>
<p>ç¼–å†™zabbix-agentd ç›‘æ§ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@message-center-mq zabbix]<span class="comment"># vim zabbix_agentd.conf</span></div><div class="line">UserParameter=rabbitmq.consumer.bi,python /etc/zabbix/rabbitmq-monitor.py | grep message.bi |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $3&#125;'</span></div><div class="line">UserParameter=rabbitmq.overstock.bi,python /etc/zabbix/rabbitmq-monitor.py | grep message.bi |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $NF&#125;'</span></div><div class="line">UserParameter=rabbitmq.consumer.push.cart,python /etc/zabbix/rabbitmq-monitor.py | grep message.push.cart |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $3&#125;'</span></div><div class="line">UserParameter=rabbitmq.overstock.push.cart,python /etc/zabbix/rabbitmq-monitor.py | grep message.push.cart |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $NF&#125;'</span></div><div class="line">UserParameter=rabbitmq.consumer.user.related,python /etc/zabbix/rabbitmq-monitor.py | grep message.user.related |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $3&#125;'</span></div><div class="line">UserParameter=rabbitmq.overstock.user.related,python /etc/zabbix/rabbitmq-monitor.py | grep message.user.related |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $NF&#125;'</span></div><div class="line">UserParameter=rabbitmq.consumer.cart,python /etc/zabbix/rabbitmq-monitor.py | grep message.cart |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $3&#125;'</span></div><div class="line">UserParameter=rabbitmq.overstock.cart,python /etc/zabbix/rabbitmq-monitor.py | grep message.cart |awk -F<span class="string">'[ :]'</span> <span class="string">'&#123;print $NF&#125;'</span></div></pre></td></tr></table></figure>
<p>ç›‘æ§æ¨¡æ¿ä¸‹è½½ï¼šåœ¨æˆ‘githubä¸Šé¢.</p>
<p>weixinç›‘æ§æ•ˆæœå›¾ï¼š</p>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/rabbitmq.png" alt=""></figure></p>

	

	

</article>




	<article>
	
		<h1><a href="/2017/07/21/Bigdata-hadoop/Kafka/KafkaåŠ¨æ€å¢åŠ Topicçš„å‰¯æœ¬(Replication)/">KafkaåŠ¨æ€å¢åŠ Topicçš„å‰¯æœ¬(Replication)</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-07-21</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata-Hadoop/">Bigdata Hadoop</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Kafka/">Kafka</a>
			</span>
		
	</div>

	

	
		<h2 id="KafkaåŠ¨æ€å¢åŠ Topicçš„å‰¯æœ¬-Replication"><a href="#KafkaåŠ¨æ€å¢åŠ Topicçš„å‰¯æœ¬-Replication" class="headerlink" title="KafkaåŠ¨æ€å¢åŠ Topicçš„å‰¯æœ¬(Replication)"></a>KafkaåŠ¨æ€å¢åŠ Topicçš„å‰¯æœ¬(Replication)</h2><p>å½“å‰æˆ‘çš„topic ï¼šcountly_event åªæœ‰1ä¸ªå‰¯æœ¬ï¼Œå¦‚æœé›†ç¾¤å…¶ä¸­ä¸€å°æœºå™¨å‡ºç°é—®é¢˜ï¼Œå°±ä¼šä¸¢å¤±æ•°æ®ã€‚æ‰€ä»¥è¿™é‡Œä»¥åæ–°å»ºæ–°çš„topic æœ€å°‘2ä¸ªå‰¯æœ¬ï¼Œå¦‚æœèµ„æºéå¸¸å……è¶³å¯ä»¥è€ƒè™‘å‰¯æœ¬3ä¸ªã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">[jollybi@kafka1 kafka_2.10-0.9.0.1]$ ./bin/kafka-topics.sh --zookeeper 172.31.2.6:2182,172.31.2.7:2182,172.31.2.8:2182  -describe -topic countly_event</div><div class="line">Topic:countly_event	PartitionCount:12	ReplicationFactor:1	Configs:</div><div class="line">	Topic: countly_event	Partition: 0	Leader: 1	Replicas: 1	Isr: 1</div><div class="line">	Topic: countly_event	Partition: 1	Leader: 2	Replicas: 2	Isr: 2</div><div class="line">	Topic: countly_event	Partition: 2	Leader: 3	Replicas: 3	Isr: 3</div><div class="line">	Topic: countly_event	Partition: 3	Leader: 4	Replicas: 4	Isr: 4</div><div class="line">	Topic: countly_event	Partition: 4	Leader: 1	Replicas: 1	Isr: 1</div><div class="line">	Topic: countly_event	Partition: 5	Leader: 2	Replicas: 2	Isr: 2</div><div class="line">	Topic: countly_event	Partition: 6	Leader: 3	Replicas: 3	Isr: 3</div><div class="line">	Topic: countly_event	Partition: 7	Leader: 4	Replicas: 4	Isr: 4</div><div class="line">	Topic: countly_event	Partition: 8	Leader: 1	Replicas: 1	Isr: 1</div><div class="line">	Topic: countly_event	Partition: 9	Leader: 2	Replicas: 2	Isr: 2</div><div class="line">	Topic: countly_event	Partition: 10	Leader: 3	Replicas: 3	Isr: 3</div><div class="line">	Topic: countly_event	Partition: 11	Leader: 4	Replicas: 4	Isr: 4</div></pre></td></tr></table></figure>
<p>å¢åŠ ç°æœ‰åˆ†åŒºçš„å¤åˆ¶å› å­å¾ˆå®¹æ˜“ã€‚åªéœ€åœ¨è‡ªå®šä¹‰é‡æ–°åˆ†é…jsonæ–‡ä»¶ä¸­æŒ‡å®šé¢å¤–å‰¯æœ¬ï¼Œå¹¶å°†å…¶ä¸â€“executeé€‰é¡¹ä¸€èµ·ä½¿ç”¨å³å¯å¢åŠ æŒ‡å®šåˆ†åŒºçš„å¤åˆ¶å› å­ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ç¤ºä¾‹å°†ä¸»é¢˜countly_eventçš„åˆ†åŒº0çš„å¤åˆ¶å› å­ä»1å¢åŠ åˆ°3.åœ¨å¢åŠ å¤åˆ¶å› å­ä¹‹å‰ï¼Œè¯¥åˆ†åŒºçš„å”¯ä¸€å‰¯æœ¬å­˜åœ¨äºä»£ç†1ä¸Šã€‚ä½œä¸ºå¢åŠ å¤åˆ¶å› å­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ·»åŠ æ›´å¤šå‰¯æœ¬ç»çºªäºº2å’Œ3å’Œ4ã€‚</p>
<p>ç¬¬ä¸€æ­¥æ˜¯åœ¨jsonæ–‡ä»¶ä¸­æ‰‹å·¥åˆ¶ä½œè‡ªå®šä¹‰é‡æ–°åˆ†é…è®¡åˆ’ - è¿™ä¸ªè‡ªå·±å®šä¹‰æ¯ä¸ªåˆ†åŒºè®¾ç½®å‰¯æœ¬ï¼Œä¾‹å¦‚ï¼š0åˆ†åŒºè®¾ç½®åœ¨3å’Œ2å’Œ4. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">"version"</span>:1,</div><div class="line"> <span class="string">"partitions"</span>:</div><div class="line"> [&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:0,<span class="string">"replicas"</span>:[3,2,4]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:1,<span class="string">"replicas"</span>:[3,2,4]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:2,<span class="string">"replicas"</span>:[4,3,1]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:3,<span class="string">"replicas"</span>:[2,1,3]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:4,<span class="string">"replicas"</span>:[3,4,1]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:5,<span class="string">"replicas"</span>:[4,1,2]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:6,<span class="string">"replicas"</span>:[1,2,3]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:7,<span class="string">"replicas"</span>:[2,3,4]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:8,<span class="string">"replicas"</span>:[3,1,2]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:9,<span class="string">"replicas"</span>:[4,2,3]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:10,<span class="string">"replicas"</span>:[1,3,4]&#125;,</div><div class="line"> &#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:11,<span class="string">"replicas"</span>:[2,4,1]&#125;]</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œä½¿ç”¨å¸¦æœ‰â€“executeé€‰é¡¹çš„jsonæ–‡ä»¶å¯åŠ¨é‡æ–°åˆ†é…è¿‡ç¨‹ </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> ./bin/kafka-reassign-partitions.sh --zookeeper 10.155.90.153:2281,10.155.90.155:2281,10.155.90.138:2281  --reassignment-json-file increase-replication-factor.json --execute</div><div class="line"></div><div class="line"></div><div class="line">[jollybi@kafka1 kafka_2.10-0.9.0.1]$ ./bin/kafka-reassign-partitions.sh --zookeeper 10.155.90.153:2281,10.155.90.155:2281,10.155.90.138:2281  --reassignment-json-file increase-replication-factor.json --execute</div><div class="line">Current partition replica assignment</div><div class="line"></div><div class="line">&#123;<span class="string">"version"</span>:1,<span class="string">"partitions"</span>:[&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:6,<span class="string">"replicas"</span>:[4]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:4,<span class="string">"replicas"</span>:[2]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:5,<span class="string">"replicas"</span>:[3]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:7,<span class="string">"replicas"</span>:[1]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:3,<span class="string">"replicas"</span>:[1]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:9,<span class="string">"replicas"</span>:[3]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:11,<span class="string">"replicas"</span>:[1]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:0,<span class="string">"replicas"</span>:[2]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:10,<span class="string">"replicas"</span>:[4]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:2,<span class="string">"replicas"</span>:[4]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:1,<span class="string">"replicas"</span>:[3]&#125;,&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:8,<span class="string">"replicas"</span>:[2]&#125;]&#125;</div><div class="line"></div><div class="line">Save this to use as the --reassignment-json-file option during rollback</div><div class="line">Successfully started reassignment of partitions &#123;<span class="string">"version"</span>:1,<span class="string">"partitions"</span>:[&#123;<span class="string">"topic"</span>:<span class="string">"countly_event"</span>,<span class="string">"partition"</span>:0,<span class="string">"replicas"</span>:[1,2,3,4]&#125;]&#125;</div></pre></td></tr></table></figure>
<p>â€“verifyé€‰é¡¹å¯ä¸è¯¥å·¥å…·ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æ£€æŸ¥åˆ†åŒºé‡æ–°åˆ†é…çš„çŠ¶æ€ã€‚è¯·æ³¨æ„ï¼Œä¸â€“verifyé€‰é¡¹ä¸€èµ·ä½¿ç”¨ç›¸åŒçš„increase-replication-factor.jsonï¼ˆä¸â€“executeé€‰é¡¹ä¸€èµ·ä½¿ç”¨ï¼‰</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="string">[jollybi@kafka1</span> <span class="string">kafka_2.10-0.9.0.1]$</span> <span class="string">./bin/kafka-reassign-partitions.sh</span> <span class="bullet">--zookeeper</span> <span class="number">10.155</span><span class="number">.90</span><span class="number">.153</span><span class="string">:2281,10.155.90.155:2281,10.155.90.138:2281</span>  <span class="bullet">--reassignment-json-file</span> <span class="string">increase-replication-factor.json</span> <span class="bullet">--verify</span></div><div class="line"><span class="string">Status</span> <span class="string">of</span> <span class="string">partition</span> <span class="attr">reassignment:</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,0]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,1]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,2]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,3]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,4]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,5]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,6]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,7]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,8]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,9]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,10]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"><span class="string">Reassignment</span> <span class="string">of</span> <span class="string">partition</span> <span class="string">[countly_event,11]</span> <span class="string">is</span> <span class="string">still</span> <span class="string">in</span> <span class="string">progress</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="string">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨kafka-topicså·¥å…·éªŒè¯å¤åˆ¶å› å­çš„å¢åŠ æƒ…å†µ</span> </div><div class="line"></div><div class="line"><span class="string">[root@kafka1</span> <span class="string">kafka_2.10-0.9.0.1]#</span> <span class="string">./bin/kafka-topics.sh</span> <span class="bullet">--zookeeper</span> <span class="number">10.155</span><span class="number">.90</span><span class="number">.153</span><span class="string">:2281,10.155.90.155:2281,10.155.90.138:2281</span> <span class="bullet">-describe</span> <span class="bullet">-topic</span> <span class="string">countly_event</span></div><div class="line"><span class="attr">Topic:</span><span class="string">countly_event</span>	<span class="attr">PartitionCount:12</span>	<span class="attr">ReplicationFactor:3</span>	<span class="attr">Configs:</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">0</span>	<span class="attr">Leader:</span> <span class="number">2</span>	<span class="attr">Replicas:</span> <span class="number">3</span><span class="string">,2,4</span>	<span class="attr">Isr:</span> <span class="number">2</span><span class="string">,3,4</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">1</span>	<span class="attr">Leader:</span> <span class="number">3</span>	<span class="attr">Replicas:</span> <span class="number">3</span><span class="string">,2,4</span>	<span class="attr">Isr:</span> <span class="number">3</span><span class="string">,2,4</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">2</span>	<span class="attr">Leader:</span> <span class="number">4</span>	<span class="attr">Replicas:</span> <span class="number">4</span><span class="string">,3,1</span>	<span class="attr">Isr:</span> <span class="number">4</span><span class="string">,1,3</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">3</span>	<span class="attr">Leader:</span> <span class="number">1</span>	<span class="attr">Replicas:</span> <span class="number">2</span><span class="string">,1,3</span>	<span class="attr">Isr:</span> <span class="number">1</span><span class="string">,2,3</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">4</span>	<span class="attr">Leader:</span> <span class="number">3</span>	<span class="attr">Replicas:</span> <span class="number">3</span><span class="string">,4,1</span>	<span class="attr">Isr:</span> <span class="number">4</span><span class="string">,1,3</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">5</span>	<span class="attr">Leader:</span> <span class="number">4</span>	<span class="attr">Replicas:</span> <span class="number">4</span><span class="string">,1,2</span>	<span class="attr">Isr:</span> <span class="number">1</span><span class="string">,4,2</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">6</span>	<span class="attr">Leader:</span> <span class="number">1</span>	<span class="attr">Replicas:</span> <span class="number">1</span><span class="string">,2,3</span>	<span class="attr">Isr:</span> <span class="number">2</span><span class="string">,1,3</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">7</span>	<span class="attr">Leader:</span> <span class="number">2</span>	<span class="attr">Replicas:</span> <span class="number">2</span><span class="string">,3,4</span>	<span class="attr">Isr:</span> <span class="number">4</span><span class="string">,2,3</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">8</span>	<span class="attr">Leader:</span> <span class="number">2</span>	<span class="attr">Replicas:</span> <span class="number">3</span><span class="string">,1,2</span>	<span class="attr">Isr:</span> <span class="number">2</span><span class="string">,1,3</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">9</span>	<span class="attr">Leader:</span> <span class="number">3</span>	<span class="attr">Replicas:</span> <span class="number">4</span><span class="string">,2,3</span>	<span class="attr">Isr:</span> <span class="number">3</span><span class="string">,2,4</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">10</span>	<span class="attr">Leader:</span> <span class="number">4</span>	<span class="attr">Replicas:</span> <span class="number">1</span><span class="string">,3,4</span>	<span class="attr">Isr:</span> <span class="number">4</span><span class="string">,1,3</span></div><div class="line">	<span class="attr">Topic:</span> <span class="string">countly_event</span>	<span class="attr">Partition:</span> <span class="number">11</span>	<span class="attr">Leader:</span> <span class="number">1</span>	<span class="attr">Replicas:</span> <span class="number">2</span><span class="string">,4,1</span>	<span class="attr">Isr:</span> <span class="number">1</span><span class="string">,4,2</span></div></pre></td></tr></table></figure>
<p>å‚è€ƒåœ°å€ï¼š<a href="http://kafka.apache.org/documentation/" target="_blank" rel="external">http://kafka.apache.org/documentation/</a></p>
<p>Communicative learning:<br>ğŸ§ Linux shell_ senior operation and maintenance faction: QQ group 459096184 circle (system operation and maintenance - application operation and maintenance - automation operation and maintenance - virtualization technology research, welcome to join)<br>ğŸ§ BigData-Exchange School:QQ group 521621407 circles (big data Yun Wei) (Hadoop developer) (big data research enthusiasts) welcome to join</p>
<p>Bidata have internal WeChat exchange group, learn from each other, join QQ group has links.</p>

	

	

</article>




	<article>
	
		<h1><a href="/2017/07/11/ä¸ªäººç”Ÿæ´»è®°å½•/é˜¿è¡°é™„ä½“ï¼šäººç”Ÿæ€»ä¼šé‡åˆ°ä¸é¡ºå¿ƒäº‹æƒ…/">é˜¿è¡°ğŸŠé™„ä½“ï¼šäººç”Ÿæ€»ä¼šé‡åˆ°ä¸é¡ºå¿ƒäº‹æƒ…</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-07-11</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/ç”Ÿæ´»/">ç”Ÿæ´»</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Personal-life-record/">Personal life record</a>
			</span>
		
	</div>

	

	
		<ul>
<li>è®©æˆ‘æƒ³èµ·ä¿„â€¢æ™®å¸Œé‡‘ è¯´è¿‡ä¸€å¥è¯ï¼š</li>
</ul>
<p><code>å‡å¦‚ç”Ÿæ´»æ¬ºéª—äº†ä½ ï¼Œä¸è¦å¿§éƒï¼Œä¹Ÿä¸è¦æ„¤æ…¨ï¼ä¸é¡ºå¿ƒçš„æ—¶å€™æš‚ä¸”å®¹å¿ï¼šç›¸ä¿¡å§ï¼å¿«ä¹çš„æ—¥å­å°±ä¼šåˆ°æ¥ã€‚</code></p>
<p><img src="https://cdn.dribbble.com/users/516449/screenshots/2386555/bad-mood.gif" alt=""></p>
		<p><a class="article__read-more-link" href="/2017/07/11/ä¸ªäººç”Ÿæ´»è®°å½•/é˜¿è¡°é™„ä½“ï¼šäººç”Ÿæ€»ä¼šé‡åˆ°ä¸é¡ºå¿ƒäº‹æƒ…/">...read more</a></p>
	

	

</article>




	<article>
	
		<h1><a href="/2017/07/11/Bigdata-hadoop/Kafka/KafKaæ‰©å®¹ç¾¤é›†(Topic.partitionsè¿ç§»)/">KafKaåŠ¨æ€æ‰©å®¹ç¾¤é›†-(Topic.partitionsè¿ç§»)</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2017-07-11</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Bigdata-Hadoop/">Bigdata Hadoop</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Kafka/">Kafka</a>
			</span>
		
	</div>

	

	
		<h4 id="kafkaçš„æ‰©å®¹éš¾ç‚¹ï¼š"><a href="#kafkaçš„æ‰©å®¹éš¾ç‚¹ï¼š" class="headerlink" title="kafkaçš„æ‰©å®¹éš¾ç‚¹ï¼š"></a>kafkaçš„æ‰©å®¹éš¾ç‚¹ï¼š</h4><p>1ï¼‰ä¸»è¦åœ¨äºå¢åŠ æœºå™¨ä¹‹åï¼Œæ•°æ®éœ€è¦rebalanceåˆ°æ–°å¢çš„ç©ºé—²èŠ‚ç‚¹ï¼Œå³æŠŠpartitionsè¿ç§»åˆ°ç©ºé—²æœºå™¨ä¸Šã€‚<br>kafkaæä¾›<code>bin/kafka-reassign-partitions.sh</code>å·¥å…·ï¼Œå®Œæˆparttitionçš„è¿ç§»ã€‚</p>
<p>2ï¼‰kafkaçš„é›†ç¾¤çš„æ•°æ®é‡åŠ å¤§ï¼Œæ•°æ®rebalanceçš„æ—¶é—´è¾ƒé•¿ã€‚è§£å†³åŠæ³•æ˜¯æŠŠ<code>log.retention.hours=1</code>è®¾ç½®ä¸€å°æ—¶ï¼ˆç”Ÿäº§å‚æ•°24å°æ—¶ï¼‰ã€‚<br>ä¿®æ”¹å‚æ•°ä¹‹åï¼Œé‡å¯kakfaèŠ‚ç‚¹ï¼Œkafkaä¼šä¸»åŠ¨purge 1å°æ—¶ä¹‹å‰çš„logæ•°æ®ã€‚<br>ä»¥ä¸‹æ˜¯kafka_0.8.1.1ç‰ˆæœ¬kafkkaé›†ç¾¤æ‰©å®¹æ“ä½œè®°å½•ï¼Œä»3å°ç‰©ç†æœºæ‰©å®¹åˆ°4å°ç‰©ç†ï¼Œpartitionæ•°é‡ç”±24ä¸ªå¢åŠ åˆ°28ä¸ªã€‚</p>
		<p><a class="article__read-more-link" href="/2017/07/11/Bigdata-hadoop/Kafka/KafKaæ‰©å®¹ç¾¤é›†(Topic.partitionsè¿ç§»)/">...read more</a></p>
	

	

</article>





	<span class="different-posts">ğŸ“– <a href="/page/3">more posts</a> ğŸ“–</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<h5>Hi there,</h5>
	<p style="text-align:justify;">my name is Yancy, they know me as RadiantğŸ‘ğŸ‘. This blog is about Bi-data and my live.<br> I like ğŸŒ³ğŸŒ³ğŸŒ³</p>
</div>


	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>Â© 2018 Yancy | Powered by <a href="http://blog.yancy.cc/">Yancy</a> | Theme <a href="https://github.com/yangcvo">Yancy_GitHub</a></span>
		</div>

	</div>


</footer>



</body>

</html>
