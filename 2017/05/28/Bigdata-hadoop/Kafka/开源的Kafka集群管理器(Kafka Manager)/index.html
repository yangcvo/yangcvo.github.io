<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Bigdata-开源的Kafka集群管理器(Kafka Manager) | Yancy&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Kafka ManagerA tool for managing Apache Kafka. It supports the following: 管理多个群集 容易检查集群状态（主题，消费者，偏移量，经纪人，副本分发，分区分配） 运行首选副本选举 使用选项生成分区分配，以选择要使用的代理 运行分区的重新分配（基于生成的分配） 创建可选主题配置的主题（0.8.1.1具有不同于0.8.2+的配置）">
<meta name="keywords" content="Kafka">
<meta property="og:type" content="article">
<meta property="og:title" content="Bigdata-开源的Kafka集群管理器(Kafka Manager)">
<meta property="og:url" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka Manager)/index.html">
<meta property="og:site_name" content="Yancy&#39;s blog">
<meta property="og:description" content="Kafka ManagerA tool for managing Apache Kafka. It supports the following: 管理多个群集 容易检查集群状态（主题，消费者，偏移量，经纪人，副本分发，分区分配） 运行首选副本选举 使用选项生成分区分配，以选择要使用的代理 运行分区的重新分配（基于生成的分配） 创建可选主题配置的主题（0.8.1.1具有不同于0.8.2+的配置）">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014722977191.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014724051756.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15020729297106.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15020745879851.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014725443386.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014725288425.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014725659340.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014725864134.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014726361909.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014727525618.jpg">
<meta property="og:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014727932029.jpg">
<meta property="og:updated_time" content="2017-11-21T02:04:28.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bigdata-开源的Kafka集群管理器(Kafka Manager)">
<meta name="twitter:description" content="Kafka ManagerA tool for managing Apache Kafka. It supports the following: 管理多个群集 容易检查集群状态（主题，消费者，偏移量，经纪人，副本分发，分区分配） 运行首选副本选举 使用选项生成分区分配，以选择要使用的代理 运行分区的重新分配（基于生成的分配） 创建可选主题配置的主题（0.8.1.1具有不同于0.8.2+的配置）">
<meta name="twitter:image" content="http://blog.yancy.cc/2017/05/28/Bigdata-hadoop/Kafka/开源的Kafka集群管理器(Kafka%20Manager)/media/15014722977191.jpg">
  
  <link rel="stylesheet" href="/css/index.css">
</head>

<body style="


  background-color: #eff0f6

">
  <div id="container">
    <nav id="nav">
  <header class="header">
    <a href="/" class="title">Clover Tuan</a>
  </header>
  <div class="ctnWrap">
    <div class="icons">
      
        
          
            <a href="https://dribbble.com/clovertuan" target="_blank" class="nav-icn iconfont icon-dribbble"></a>
          
        
          
            <a href="https://www.behance.net/clovertuan" target="_blank" class="nav-icn iconfont icon-behance"></a>
          
        
          
            <a href="http://clovertuan.lofter.com/" target="_blank" class="nav-icn iconfont icon-lofter"></a>
          
        
          
            <a href="https://www.instagram.com/clovertuan/" target="_blank" class="nav-icn iconfont icon-instagram"></a>
          
        
          
            <a href="https://github.com/cloverTuan" target="_blank" class="nav-icn iconfont icon-github"></a>
          
        
      
    </div>
    <div class="menu">
      
        
            <a href="/" class="nav-menu ">HOME</a>
          
        
            <a href="/archives" class="nav-menu ">ARCHIVE</a>
          
        
            <a href="/about" class="nav-menu ">ABOUT</a>
          
        
      
    </div>
  </div>
</nav>
    <div id="main"><section class="article">
  <h2 class="title">Bigdata-开源的Kafka集群管理器(Kafka Manager)</h2>
  <p class="sub">May 28, 2017</p>
  <article class="content">
    <p>参考开源地址：<a href="https://github.com/yahoo/kafka-manager" target="_blank" rel="external">https://github.com/yahoo/kafka-manager</a></p>
<h4 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h4><p>Kafka 0.8.1.1 or 0.8.2.<em> or 0.9.0.</em> or 0.10.0.*<br>Java 8+</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sudo wget --header <span class="string">"Cookie: oraclelicense=accept-securebackup-cookie”   http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/jdk-8u144-linux-x64.tar.gz</span></div><div class="line"></div><div class="line">sudo vim /etc/profile</div><div class="line">export JAVA_HOME=/home/jollybi/tools/jdk1.8.0_144</div><div class="line">export LASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/tools.jar:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib:<span class="variable">$JAVA_HOME</span>/jre/lib:<span class="variable">$JAVA_HOME</span>/bin</div><div class="line">export PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$JAVA_HOME</span>/jre/bin:<span class="variable">$TOMCAT_HOME</span>/bin:<span class="variable">$PATH</span></div></pre></td></tr></table></figure>
<h4 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/yahoo/kafka-manager.git</div><div class="line">./sbt clean dist</div><div class="line"></div><div class="line">[info]   Compilation completed <span class="keyword">in</span> 13.366 s</div><div class="line">model contains 672 documentable templates</div><div class="line">[info] Main Scala API documentation successful.</div><div class="line">[info] Packaging /home/jollybi/kafka-manager/target/scala-2.11/kafka-manager_2.11-1.3.3.8-javadoc.jar ...</div><div class="line">[info] Done packaging.</div><div class="line">[info] Packaging /home/jollybi/kafka-manager/target/scala-2.11/kafka-manager_2.11-1.3.3.8.jar ...</div><div class="line">[info] Done packaging.</div><div class="line">[info] Packaging /home/jollybi/kafka-manager/target/scala-2.11/kafka-manager_2.11-1.3.3.8-sans-externalized.jar ...</div><div class="line">[info] Done packaging.</div><div class="line">[info]</div><div class="line">[info] Your package is ready <span class="keyword">in</span> /home/jollybi/kafka-manager/target/universal/kafka-manager-1.3.3.8.zip</div><div class="line">[info]</div><div class="line">[success] Total time: 142 s, completed Jul 27, 2017 3:48:35 PM</div><div class="line">完成</div></pre></td></tr></table></figure>
<h4 id="Starting-the-service"><a href="#Starting-the-service" class="headerlink" title="Starting the service"></a>Starting the service</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">解压缩生成的zip文件后，将工作目录更改为可以运行的服务：</div><div class="line"></div><div class="line">unzip /home/jollybi/kafka-manager/target/universal/kafka-manager-1.3.3.8.zip</div><div class="line"></div><div class="line"></div><div class="line">修改zk地址和管理员账号和密码：</div><div class="line"></div><div class="line">vim kafka-manager-1.3.3.8/conf/application.conf</div><div class="line"></div><div class="line"><span class="comment">#kafka-manager.zkhosts="kafka-manager-zookeeper:2181"</span></div><div class="line"><span class="comment">#zk集群可以这么配置：</span></div><div class="line">kafka-manager.zkhosts=<span class="string">"kafka1.jollychic.com:2281,kafka2.jollychic.com:2281,kafka3.jollychic.com:2281"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#根据个人公司这里可以开启true 设置账号和密码</span></div><div class="line">basicAuthentication.enabled=<span class="literal">true</span></div><div class="line">basicAuthentication.username=<span class="string">"admin"</span></div><div class="line">basicAuthentication.password=<span class="string">"admin"</span></div><div class="line"></div><div class="line"></div><div class="line">默认情况下，它将选择端口9000.这是可以覆盖的，配置文件的位置也是如此。例如：</div><div class="line"></div><div class="line">$ ./bin/kafka-manager -Dconfig.file=conf/application.conf -Dhttp.port=8080</div><div class="line"></div><div class="line">后台生效：</div><div class="line"></div><div class="line">$ ./bin/kafka-manager -Dconfig.file=conf/application.conf -Dhttp.port=8080 &amp;</div><div class="line"></div><div class="line">再次，如果java不在您的路径中，或者您需要针对不同版本的Java运行，请按如下所示添加-java-home选项：</div><div class="line"></div><div class="line">$ bin/kafka-manager -java-home /usr/<span class="built_in">local</span>/oracle-java-8</div></pre></td></tr></table></figure>
<h4 id="Packaging"><a href="#Packaging" class="headerlink" title="Packaging"></a>Packaging</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">If you<span class="string">'d like to create a Debian or RPM package instead, you can run one of:</span></div><div class="line"></div><div class="line">sbt debian:packageBin</div><div class="line"></div><div class="line">sbt rpm:packageBin</div></pre></td></tr></table></figure>
<h4 id="查看端口："><a href="#查看端口：" class="headerlink" title="查看端口："></a>查看端口：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">[jollybi@kafka1 conf]$ netstat -ntulp | grep 8080</div><div class="line">(Not all processes could be identified, non-owned process info</div><div class="line"> will not be shown, you would have to be root to see it all.)</div><div class="line">tcp6       0      0 :::8080                 :::*                    LISTEN      70517/java</div></pre></td></tr></table></figure>
<p>四、安装配置中的两个小坑</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>、安装配置上面已经有说明介绍步骤。</div><div class="line"><span class="number">2</span>、kafka的服务器必须添加hostname对应的host域名解析，并重启kafka</div><div class="line">这个是java本身处理的一个机制问题，通过代码修改和绑定host都可以解决，如果不处理，报出来的错误如下：</div><div class="line"><span class="meta">at</span> org.apache.kafka.clients.consumer.KafkaConsumer.pollOnce(KafkaConsumer.java:<span class="number">974</span>) ~[org.apache.kafka.kafka-clients-<span class="number">0.10</span><span class="meta">.0</span><span class="meta">.1</span>.jar:na]</div><div class="line">[error] k.m.j.KafkaJMX$ - Failed to connect to service:jmx:rmi:///jndi/rmi://<span class="number">10.143</span><span class="meta">.40</span><span class="meta">.239</span>:<span class="number">9999</span>/jmxrmi</div><div class="line"><span class="symbol">java.rmi.ConnectException:</span> Connection refused to host: <span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span><span class="comment">; nested exception is:</span></div><div class="line"><span class="symbol">	java.net.ConnectException:</span> Connection refused</div><div class="line">从一个运维人员的角度出发，改host解析是最得心应手的，登录kafka的服务器，打开/etc/hosts文件，将主机名对应的解析记录修改为本机对外通信的<span class="built_in">ip</span>地址，另外将<span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span>和::<span class="number">1</span>对应的主机名删掉，修改如下，修改后必须重启kafka才能生效。</div><div class="line"></div><div class="line"></div><div class="line"><span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span> localhost.localdomain localhost</div><div class="line"><span class="number">169.44</span><span class="meta">.62</span><span class="meta">.19</span> kafka1.jollychic.com kafka1</div><div class="line"><span class="number">169.44</span><span class="meta">.59</span><span class="meta">.18</span> kafka2.jollychic.com kafka2</div><div class="line"><span class="number">169.44</span><span class="meta">.62</span><span class="meta">.17</span> kafka3.jollychic.com kafka3</div><div class="line"><span class="number">169.55</span><span class="meta">.32</span><span class="meta">.22</span> kafka4.jollychic.com kafka4</div><div class="line"><span class="number">10.155</span><span class="meta">.90</span><span class="meta">.13</span> zk1.jollychic.com</div><div class="line"><span class="number">10.155</span><span class="meta">.90</span><span class="meta">.15</span> zk2.jollychic.com</div><div class="line"><span class="number">10.155</span><span class="meta">.90</span><span class="meta">.18</span> zk3.jollychic.com</div></pre></td></tr></table></figure>
<h3 id="网站访问kafka-Manger"><a href="#网站访问kafka-Manger" class="headerlink" title="网站访问kafka Manger"></a>网站访问kafka Manger</h3><p>这里我设置了登录账号和密码： admin admin</p>
<p><img src="media/15014722977191.jpg" alt=""></p>
<p>创建kafka名字;<br>选择kafka版本号;<br>JMX这个不需要;<br>下面选择默认点击确认即可.</p>
<p><img src="media/15014724051756.jpg" alt=""></p>
<blockquote>
<p>(2)kafka 启用 JMX端口</p>
</blockquote>
<p><img src="media/15020729297106.jpg" alt=""></p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">以如下命令重新启动kafka</div><div class="line"></div><div class="line">JMX_PORT=<span class="number">9999</span> bin/kafka-<span class="built_in">server</span>-start.sh config/<span class="built_in">server</span>.properties</div><div class="line">或者修改kafka-<span class="built_in">server</span>-start.sh 文件，追加JMX_PORT=<span class="string">"9999"</span></div><div class="line"></div><div class="line"> <span class="keyword">if</span> [ <span class="string">"x$KAFKA_HEAP_OPTS"</span> = <span class="string">"x"</span> ]; <span class="keyword">then</span></div><div class="line">    export KAFKA_HEAP_OPTS=<span class="string">"-Xmx1G -Xms1G"</span></div><div class="line">    export JMX_PORT=<span class="string">"9999"</span></div><div class="line">fi</div><div class="line">然后重新启动kafka</div><div class="line">bin/kafka-<span class="built_in">server</span>-start.sh config/<span class="built_in">server</span>.properties</div><div class="line"></div><div class="line">但是Metrics中数据都是零</div><div class="line">查看 kafka manager 报错，无法连接jxm</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">解决方法 修改每个kafka broker的 kafka_2.11-0.10.1.0/bin/kafka-run-class.sh文件</div><div class="line">​</div><div class="line"><span class="comment"># JMX settings</span></div><div class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$KAFKA_JMX_OPTS</span>"</span> ]; <span class="keyword">then</span></div><div class="line">  KAFKA_JMX_OPTS=<span class="string">"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false  -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=75.126.5.162"</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"></div><div class="line">-Djava.rmi.server.hostname 的值为当前kafka服务器ip</div><div class="line"></div><div class="line">这里说明下集群kafka都需要修改</div></pre></td></tr></table></figure>
<p><img src="media/15020745879851.jpg" alt=""></p>
<p><img src="media/15014725443386.jpg" alt=""></p>
<p><img src="media/15014725288425.jpg" alt=""></p>
<p><img src="media/15014725659340.jpg" alt=""></p>
<p><img src="media/15014725864134.jpg" alt=""></p>
<p><img src="media/15014726361909.jpg" alt=""></p>
<p><img src="media/15014727525618.jpg" alt=""></p>
<p><img src="media/15014727932029.jpg" alt=""></p>
<h3 id="交流学习："><a href="#交流学习：" class="headerlink" title="交流学习："></a>交流学习：</h3><p>🐧  Linux shell_高级运维派: <code>459096184</code>    圈子 (系统运维-应用运维-自动化运维-虚拟化技术研究欢迎加入)<br>🐧  BigData-Exchange School : <code>521621407</code>  圈子（大数据运维)（Hadoop开发人员)（大数据研究爱好者) 欢迎加入</p>
<p>相应Bidata有内部微信交流群互相学习，加入QQ群有链接。</p>
  </article>
  <footer class="f-cf">
    
      <a href="/2017/06/01/Bigdata-hadoop/Kafka/Zabbix监控Kafka集群 Brokers服务/" class="link f-fl">⟵Zabbix监控Kafka集群 Brokers服务</a>
    
    
      <a href="/2017/05/27/Bigdata-hadoop/zookeeper/Bigdata-ZooKeeper的配置详解优化/" class="link f-fr">Bigdata-ZooKeeper的配置详解优化⟶</a>
    
  </footer>
</section></div>
    <footer id="footer" class="f-cf">
  d.guangying@foxmail.com
  
    
      
        · <a href="https://dribbble.com/clovertuan" target="_blank" class="nav-icn">Dribbble</a>
      
    
      
        · <a href="https://www.behance.net/clovertuan" target="_blank" class="nav-icn">Behance</a>
      
    
      
        · <a href="http://clovertuan.lofter.com/" target="_blank" class="nav-icn">Lofter</a>
      
    
      
        · <a href="https://www.instagram.com/clovertuan/" target="_blank" class="nav-icn">Instagram</a>
      
    
      
        · <a href="https://github.com/cloverTuan" target="_blank" class="nav-icn">GitHub</a>
      
    
  
  <span class="copyright">All rights reserved @Clover Tuan</span>
</footer>
  </div>
</body>
</html>