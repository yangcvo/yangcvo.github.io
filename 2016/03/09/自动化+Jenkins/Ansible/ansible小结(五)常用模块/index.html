<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Ansibleå°ç»“ (äº”) å¸¸ç”¨æ¨¡å— | Yancy&#39;s blog</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="Yancy&#39;s blog" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link">Home</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/archives" class="header__link">ARCHIVES</a>
			
				<a href="/about/About" class="header__link">ABOUT</a>
			
				<a href="http://weibo.com/yangcvo" class="header__link">Weibo</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Yancy&#39;s blog</a></h1>
		<h2 class="header__subtitle">SIMPLICITY IS PREREQUISITE FOR  RELIABILITY</h2>
	</header>

	<main>
		<article>
	
		<h1>Ansibleå°ç»“ (äº”) å¸¸ç”¨æ¨¡å—</h1>
	
	<div class="article__infos">
		<span class="article__date">2016-03-09</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/automation/">automation</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Ansible/">Ansible</a>
			</span>
		
	</div>

	

	
		<h1 id="ansibleå‘½ä»¤æ€»ç»“ä½¿ç”¨ï¼š"><a href="#ansibleå‘½ä»¤æ€»ç»“ä½¿ç”¨ï¼š" class="headerlink" title="ansibleå‘½ä»¤æ€»ç»“ä½¿ç”¨ï¼š"></a>ansibleå‘½ä»¤æ€»ç»“ä½¿ç”¨ï¼š</h1><p>åœ¨ä¸Šä¸€ç¯‡ä¸­ä»‹ç»äº†commandséƒ¨åˆ†æ¨¡å—ï¼Œæœ¬ç¯‡æ‰¿æ¥ä¸Šç¯‡ä»‹ç»ä¸‹å¸¸ç”¨çš„æ¨¡å—ã€‚æ ¹æ®å®˜æ–¹çš„åˆ†ç±»ï¼Œå°†æ¨¡å—æŒ‰åŠŸèƒ½åˆ†ç±»ä¸ºï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">äº‘æ¨¡å—ã€å‘½ä»¤æ¨¡å—ã€æ•°æ®åº“æ¨¡å—ã€æ–‡ä»¶æ¨¡å—ã€èµ„äº§æ¨¡å—ã€æ¶ˆæ¯æ¨¡å—ã€ç›‘æ§æ¨¡å—ã€ç½‘ç»œæ¨¡å—ã€é€šçŸ¥æ¨¡å—ã€åŒ…ç®¡ç†æ¨¡å—ã€æºç æ§åˆ¶æ¨¡å—ã€ç³»ç»Ÿæ¨¡å—ã€å•å…ƒæ¨¡å—ã€webè®¾æ–½æ¨¡å—ã€windowsæ¨¡å—</div></pre></td></tr></table></figure>
<p>å…·ä½“å¯ä»¥å‚çœ‹<a href="http://docs.ansible.com/list_of_all_modules.html" target="_blank" rel="external">å®˜æ–¹é¡µé¢</a></p>
<p>è¿™é‡Œä»å®˜æ–¹åˆ†ç±»çš„æ¨¡å—é‡Œé€‰æ‹©<code>æœ€å¸¸ç”¨çš„ä¸€äº›æ¨¡å—</code>è¿›è¡Œä»‹ç»ï¼ˆcommandsæ¨¡å—ä¸Šä¸€ç¯‡å·²ç»ä»‹ç»ï¼Œè¿™é‡Œä¸å†æï¼‰ã€‚</p>
<h3 id="ä¸€ã€pingæ¨¡å—"><a href="#ä¸€ã€pingæ¨¡å—" class="headerlink" title="ä¸€ã€pingæ¨¡å—"></a>ä¸€ã€pingæ¨¡å—</h3><h6 id="æµ‹è¯•ä¸»æœºæ˜¯å¦æ˜¯é€šçš„ï¼Œç”¨æ³•å¾ˆç®€å•ï¼Œä¸æ¶‰åŠå‚æ•°ï¼š"><a href="#æµ‹è¯•ä¸»æœºæ˜¯å¦æ˜¯é€šçš„ï¼Œç”¨æ³•å¾ˆç®€å•ï¼Œä¸æ¶‰åŠå‚æ•°ï¼š" class="headerlink" title="æµ‹è¯•ä¸»æœºæ˜¯å¦æ˜¯é€šçš„ï¼Œç”¨æ³•å¾ˆç®€å•ï¼Œä¸æ¶‰åŠå‚æ•°ï¼š"></a>æµ‹è¯•ä¸»æœºæ˜¯å¦æ˜¯é€šçš„ï¼Œç”¨æ³•å¾ˆç®€å•ï¼Œä¸æ¶‰åŠå‚æ•°ï¼š</h6><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ansible tomcat_B1 -m <span class="built_in">ping</span></div><div class="line"></div><div class="line">[root<span class="symbol">@ansible</span> ~]<span class="meta"># ansible tomcat_C1 -m ping</span></div><div class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.177</span> | SUCCESS =&gt; &#123;</div><div class="line">    <span class="string">"changed"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="string">"ping"</span>: <span class="string">"pong"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="äºŒã€setupæ¨¡å—"><a href="#äºŒã€setupæ¨¡å—" class="headerlink" title="äºŒã€setupæ¨¡å—"></a>äºŒã€setupæ¨¡å—</h3><p>setupæ¨¡å—ï¼Œä¸»è¦ç”¨äºè·å–ä¸»æœºä¿¡æ¯ï¼Œåœ¨playbooksé‡Œç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªå‚æ•°<code>gather_facts</code>å°±ä¸è¯¥æ¨¡å—ç›¸å…³ã€‚setupæ¨¡å—ä¸‹ç»å¸¸ä½¿ç”¨çš„ä¸€ä¸ªå‚æ•°æ˜¯filterå‚æ•°ï¼Œå…·ä½“ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼ˆç”±äºè¾“å‡ºç»“æœè¾ƒå¤šï¼Œè¿™é‡Œåªåˆ—å‘½ä»¤ä¸å†™ç»“æœï¼‰ï¼š</p>
<h6 id="æŸ¥çœ‹ä¸»æœºå†…å­˜ä¿¡æ¯"><a href="#æŸ¥çœ‹ä¸»æœºå†…å­˜ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ä¸»æœºå†…å­˜ä¿¡æ¯"></a>æŸ¥çœ‹ä¸»æœºå†…å­˜ä¿¡æ¯</h6><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@ansible</span> ~]<span class="meta"># ansible tomcat_C1 -m setup -a <span class="string">'filter=ansible_*_mb'</span></span></div></pre></td></tr></table></figure>
<h6 id="æŸ¥çœ‹åœ°æ¥å£ä¸ºeth0-2çš„ç½‘å¡ä¿¡æ¯"><a href="#æŸ¥çœ‹åœ°æ¥å£ä¸ºeth0-2çš„ç½‘å¡ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹åœ°æ¥å£ä¸ºeth0-2çš„ç½‘å¡ä¿¡æ¯"></a>æŸ¥çœ‹åœ°æ¥å£ä¸ºeth0-2çš„ç½‘å¡ä¿¡æ¯</h6><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@ansible</span> ~]<span class="meta"># ansible tomcat_C1 -m setup -a <span class="string">'filter=ansible_eth[0-2]'</span> </span></div><div class="line">[root<span class="symbol">@ansible</span> ~]<span class="meta"># ansible all -m setup --tree /tmp/facts</span></div></pre></td></tr></table></figure>
<p>  //å°†æ‰€æœ‰ä¸»æœºçš„ä¿¡æ¯è¾“å…¥åˆ°/tmp/factsç›®å½•ä¸‹ï¼Œæ¯å°ä¸»æœºçš„ä¿¡æ¯è¾“å…¥åˆ°ä¸»æœºåæ–‡ä»¶ä¸­ï¼ˆ/etc/ansible/hostsé‡Œçš„ä¸»æœºåï¼‰</p>
<h3 id="ä¸‰ã€fileæ¨¡å—"><a href="#ä¸‰ã€fileæ¨¡å—" class="headerlink" title="ä¸‰ã€fileæ¨¡å—"></a>ä¸‰ã€fileæ¨¡å—</h3><p>fileæ¨¡å—ä¸»è¦ç”¨äºè¿œç¨‹ä¸»æœºä¸Šçš„æ–‡ä»¶æ“ä½œï¼Œfileæ¨¡å—åŒ…å«å¦‚ä¸‹é€‰é¡¹ï¼š </p>
<ul>
<li>forceï¼šéœ€è¦åœ¨ä¸¤ç§æƒ…å†µä¸‹å¼ºåˆ¶åˆ›å»ºè½¯é“¾æ¥ï¼Œä¸€ç§æ˜¯æºæ–‡ä»¶ä¸å­˜åœ¨ä½†ä¹‹åä¼šå»ºç«‹çš„æƒ…å†µä¸‹ï¼›å¦ä¸€ç§æ˜¯ç›®æ ‡è½¯é“¾æ¥å·²å­˜åœ¨,éœ€è¦å…ˆå–æ¶ˆä¹‹å‰çš„è½¯é“¾ï¼Œç„¶ååˆ›å»ºæ–°çš„è½¯é“¾ï¼Œæœ‰ä¸¤ä¸ªé€‰é¡¹ï¼šyes|no </li>
<li>groupï¼šå®šä¹‰æ–‡ä»¶/ç›®å½•çš„å±ç»„ </li>
<li>modeï¼šå®šä¹‰æ–‡ä»¶/ç›®å½•çš„æƒé™</li>
<li>ownerï¼šå®šä¹‰æ–‡ä»¶/ç›®å½•çš„å±ä¸»</li>
<li>pathï¼šå¿…é€‰é¡¹ï¼Œå®šä¹‰æ–‡ä»¶/ç›®å½•çš„è·¯å¾„</li>
<li>recurseï¼šé€’å½’çš„è®¾ç½®æ–‡ä»¶çš„å±æ€§ï¼Œåªå¯¹ç›®å½•æœ‰æ•ˆ</li>
<li>srcï¼šè¦è¢«é“¾æ¥çš„æºæ–‡ä»¶çš„è·¯å¾„ï¼Œåªåº”ç”¨äºstate=linkçš„æƒ…å†µ</li>
<li>destï¼šè¢«é“¾æ¥åˆ°çš„è·¯å¾„ï¼Œåªåº”ç”¨äºstate=linkçš„æƒ…å†µ </li>
<li>stateï¼š  directoryï¼šå¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ›å»ºç›®å½•</li>
<li>fileï¼šå³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šè¢«åˆ›å»º</li>
<li>linkï¼šåˆ›å»ºè½¯é“¾æ¥</li>
<li>hardï¼šåˆ›å»ºç¡¬é“¾æ¥</li>
<li>touchï¼šå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶æˆ–ç›®å½•å·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°å…¶æœ€åä¿®æ”¹æ—¶é—´</li>
<li>absentï¼šåˆ é™¤ç›®å½•ã€æ–‡ä»¶æˆ–è€…å–æ¶ˆé“¾æ¥æ–‡ä»¶<br>ä½¿ç”¨ç¤ºä¾‹ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ansible <span class="built_in">test</span> -m file <span class="_">-a</span> <span class="string">"src=/etc/fstab dest=/tmp/fstab state=link"</span></div><div class="line">ansible <span class="built_in">test</span> -m file <span class="_">-a</span> <span class="string">"path=/tmp/fstab state=absent"</span></div><div class="line">ansible <span class="built_in">test</span> -m file <span class="_">-a</span> <span class="string">"path=/tmp/test state=touch"</span></div><div class="line">ansible <span class="built_in">test</span> -m file <span class="_">-a</span> <span class="string">"path=/tmp/test state=directory"</span> ansible <span class="built_in">test</span> -m file <span class="_">-a</span> <span class="string">"path=/tmp/testd state=directory owner=root group=root mode=777"</span></div></pre></td></tr></table></figure>
<h3 id="å››ã€copyæ¨¡å—"><a href="#å››ã€copyæ¨¡å—" class="headerlink" title="å››ã€copyæ¨¡å—"></a>å››ã€copyæ¨¡å—</h3><h5 id="å¤åˆ¶æ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœºï¼Œcopyæ¨¡å—åŒ…å«å¦‚ä¸‹é€‰é¡¹ï¼š"><a href="#å¤åˆ¶æ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœºï¼Œcopyæ¨¡å—åŒ…å«å¦‚ä¸‹é€‰é¡¹ï¼š" class="headerlink" title="å¤åˆ¶æ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœºï¼Œcopyæ¨¡å—åŒ…å«å¦‚ä¸‹é€‰é¡¹ï¼š"></a>å¤åˆ¶æ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœºï¼Œcopyæ¨¡å—åŒ…å«å¦‚ä¸‹é€‰é¡¹ï¼š</h5><ul>
<li><code>backup</code>ï¼šåœ¨è¦†ç›–ä¹‹å‰å°†åŸæ–‡ä»¶å¤‡ä»½ï¼Œå¤‡ä»½æ–‡ä»¶åŒ…å«æ—¶é—´ä¿¡æ¯ã€‚æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼šyes|no </li>
<li><code>content</code>ï¼šç”¨äºæ›¿ä»£â€srcâ€,å¯ä»¥ç›´æ¥è®¾å®šæŒ‡å®šæ–‡ä»¶çš„å€¼ </li>
<li><code>dest</code>ï¼šå¿…é€‰é¡¹ã€‚è¦å°†æºæ–‡ä»¶å¤åˆ¶åˆ°çš„è¿œç¨‹ä¸»æœºçš„ç»å¯¹è·¯å¾„ï¼Œå¦‚æœæºæ–‡ä»¶æ˜¯ä¸€ä¸ªç›®å½•ï¼Œé‚£ä¹ˆè¯¥è·¯å¾„ä¹Ÿå¿…é¡»æ˜¯ä¸ªç›®å½• </li>
<li><code>directory_mode</code>ï¼šé€’å½’çš„è®¾å®šç›®å½•çš„æƒé™ï¼Œé»˜è®¤ä¸ºç³»ç»Ÿé»˜è®¤æƒé™</li>
<li><code>force</code>ï¼šå¦‚æœç›®æ ‡ä¸»æœºåŒ…å«è¯¥æ–‡ä»¶ï¼Œä½†å†…å®¹ä¸åŒï¼Œå¦‚æœè®¾ç½®ä¸ºyesï¼Œåˆ™å¼ºåˆ¶è¦†ç›–ï¼Œå¦‚æœä¸ºnoï¼Œåˆ™åªæœ‰å½“ç›®æ ‡ä¸»æœºçš„ç›®æ ‡ä½ç½®ä¸å­˜åœ¨è¯¥æ–‡ä»¶æ—¶ï¼Œæ‰å¤åˆ¶ã€‚é»˜è®¤ä¸ºyes</li>
<li><code>others</code>ï¼šæ‰€æœ‰çš„fileæ¨¡å—é‡Œçš„é€‰é¡¹éƒ½å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨</li>
<li><code>src</code>ï¼šè¦å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºçš„æ–‡ä»¶åœ¨æœ¬åœ°çš„åœ°å€ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚å¦‚æœè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå®ƒå°†é€’å½’å¤åˆ¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè·¯å¾„ä½¿ç”¨â€/â€œæ¥ç»“å°¾ï¼Œåˆ™åªå¤åˆ¶ç›®å½•é‡Œçš„å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨â€/â€œæ¥ç»“å°¾ï¼Œåˆ™åŒ…å«ç›®å½•åœ¨å†…çš„æ•´ä¸ªå†…å®¹å…¨éƒ¨å¤åˆ¶ï¼Œç±»ä¼¼äºrsyncã€‚ </li>
<li><code>validate</code>ï¼šThe validation command to run before copying into place. The path to the file to validate is passed in via â€˜%sâ€™ which must be present as in the visudo example below.</li>
</ul>
<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ansible test -m <span class="keyword">copy</span><span class="bash"> <span class="_">-a</span> <span class="string">"src=/srv/myfiles/foo.conf dest=/etc/foo.conf owner=foo group=foo mode=0644"</span></span></div><div class="line">ansible test -m <span class="keyword">copy</span><span class="bash"> <span class="_">-a</span> <span class="string">"src=/mine/ntp.conf dest=/etc/ntp.conf owner=root group=root mode=644 backup=yes"</span></span></div><div class="line">ansible test -m <span class="keyword">copy</span><span class="bash"> <span class="_">-a</span> <span class="string">"src=/mine/sudoers dest=/etc/sudoers validate='visudo -cf %s'"</span></span></div></pre></td></tr></table></figure>
<p>è¿™é‡Œåœ¨ä¸¾ä¸ªä¾‹å­ï¼š</p>
<p>ç›®çš„ï¼šæŠŠä¸»æ§ç«¯/opt/ç›®å½•ä¸‹é¢logstash.tar.gzæ–‡ä»¶æ‹·è´åˆ°åˆ°æŒ‡å®šèŠ‚ç‚¹ä¸Š/srv/ä¸‹é¢<br>    å‘½ä»¤ï¼š<code>ansible cluster1:children -m copy -a &quot;src=/opt/logstash.tar.gz dest=/srv/. owner=root group=root mode=644&quot;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">root@salt ~]<span class="comment"># ansible cluster1:children -m copy -a "src=/opt/logstash.tar.gz dest=/srv/. 10.47.59.190 | SUCCESS =&gt; &#123;</span></div><div class="line">    <span class="string">"changed"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="string">"checksum"</span>: <span class="string">"9d15ea324f39d08cb379f59ffee9fa7ad2a62ab8"</span>,</div><div class="line">    <span class="string">"dest"</span>: <span class="string">"/srv/./logstash.tar.gz"</span>,</div><div class="line">    <span class="string">"gid"</span>: 0,</div><div class="line">    <span class="string">"group"</span>: <span class="string">"root"</span>,</div><div class="line">    <span class="string">"md5sum"</span>: <span class="string">"c151602e79a336ca363928dea68d2567"</span>,</div><div class="line">    <span class="string">"mode"</span>: <span class="string">"0644"</span>,</div><div class="line">    <span class="string">"owner"</span>: <span class="string">"root"</span>,</div><div class="line">    <span class="string">"size"</span>: 84431108,</div><div class="line">    <span class="string">"src"</span>: <span class="string">"/root/.ansible/tmp/ansible-tmp-1483939085.93-201327709717575/source"</span>,</div><div class="line">    <span class="string">"state"</span>: <span class="string">"file"</span>,</div><div class="line">    <span class="string">"uid"</span>: 0</div><div class="line">&#125;</div><div class="line">10.47.106.105 | SUCCESS =&gt; &#123;</div><div class="line">    <span class="string">"changed"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="string">"checksum"</span>: <span class="string">"9d15ea324f39d08cb379f59ffee9fa7ad2a62ab8"</span>,</div><div class="line">    <span class="string">"dest"</span>: <span class="string">"/srv/./logstash.tar.gz"</span>,</div><div class="line">    <span class="string">"gid"</span>: 0,</div><div class="line">    <span class="string">"group"</span>: <span class="string">"root"</span>,</div><div class="line">    <span class="string">"md5sum"</span>: <span class="string">"c151602e79a336ca363928dea68d2567"</span>,</div><div class="line">    <span class="string">"mode"</span>: <span class="string">"0644"</span>,</div><div class="line">    <span class="string">"owner"</span>: <span class="string">"root"</span>,</div><div class="line">    <span class="string">"size"</span>: 84431108,</div><div class="line">    <span class="string">"src"</span>: <span class="string">"/root/.ansible/tmp/ansible-tmp-1483939088.11-46151538408374/source"</span>,</div><div class="line">    <span class="string">"state"</span>: <span class="string">"file"</span>,</div><div class="line">    <span class="string">"uid"</span>: 0</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="æ‰¹é‡æ§åˆ¶è§£å‹æ–‡ä»¶"><a href="#æ‰¹é‡æ§åˆ¶è§£å‹æ–‡ä»¶" class="headerlink" title="æ‰¹é‡æ§åˆ¶è§£å‹æ–‡ä»¶"></a>æ‰¹é‡æ§åˆ¶è§£å‹æ–‡ä»¶</h4><p>æ‰¹é‡è§£å‹å‘½ä»¤ï¼š</p>
<p><code>ansible cluster1:children -m shell -a  &quot;tar -zxvf /srv/logstash.tar.gz&quot; -C /srv/.</code></p>
<h3 id="äº”ã€yumæ¨¡å—"><a href="#äº”ã€yumæ¨¡å—" class="headerlink" title="äº”ã€yumæ¨¡å—"></a>äº”ã€yumæ¨¡å—</h3><h5 id="yumå®‰è£…ä½¿ç”¨ï¼š"><a href="#yumå®‰è£…ä½¿ç”¨ï¼š" class="headerlink" title="yumå®‰è£…ä½¿ç”¨ï¼š"></a>yumå®‰è£…ä½¿ç”¨ï¼š</h5><p>ä½¿ç”¨yumåŒ…ç®¡ç†å™¨æ¥ç®¡ç†è½¯ä»¶åŒ…ï¼Œå…¶é€‰é¡¹æœ‰ï¼š </p>
<ul>
<li>config_fileï¼šyumçš„é…ç½®æ–‡ä»¶ </li>
<li>disable_gpg_checkï¼šå…³é—­gpg_check </li>
<li>disablerepoï¼šä¸å¯ç”¨æŸä¸ªæº </li>
<li>enablerepoï¼šå¯ç”¨æŸä¸ªæº</li>
<li>nameï¼šè¦è¿›è¡Œæ“ä½œçš„è½¯ä»¶åŒ…çš„åå­—ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªurlæˆ–è€…ä¸€ä¸ªæœ¬åœ°çš„rpmåŒ…çš„è·¯å¾„<br>stateï¼šçŠ¶æ€ï¼ˆpresentï¼Œabsentï¼Œlatestï¼‰</li>
</ul>
<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ansible tomcat_D1 <span class="_">-s</span> -m yum <span class="_">-a</span> <span class="string">"name=wget state=latest"</span></div></pre></td></tr></table></figure>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/ansible_02.png" alt=""></figure></p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">[root@ansible playbook]# ansible tomcat_D1 -s -<span class="symbol">C</span> -m yum -a <span class="string">"name=kernel state=latest"</span></div><div class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.178</span> | <span class="symbol">SUCCESS</span> =&gt; &#123;</div><div class="line">    <span class="string">"changed"</span>: true,</div><div class="line">    <span class="string">"changes"</span>: &#123;</div><div class="line">        <span class="string">"installed"</span>: [],</div><div class="line">        <span class="string">"updated"</span>: [</div><div class="line">            [</div><div class="line">                <span class="string">"kernel"</span>,</div><div class="line">                <span class="string">"2.6.32-642.4.2.el6.x86_64 from updates"</span></div><div class="line">            ]</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    <span class="string">"msg"</span>: <span class="string">""</span>,</div><div class="line">    <span class="string">"rc"</span>: <span class="number">0</span>,</div><div class="line">    <span class="string">"results"</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å…­-serviceæ¨¡å—"><a href="#å…­-serviceæ¨¡å—" class="headerlink" title="å…­ serviceæ¨¡å—"></a>å…­ serviceæ¨¡å—</h3><p>ç”¨äºç®¡ç†æœåŠ¡ è¯¥æ¨¡å—åŒ…å«å¦‚ä¸‹é€‰é¡¹ï¼š</p>
<ul>
<li>argumentsï¼šç»™å‘½ä»¤è¡Œæä¾›ä¸€äº›é€‰é¡¹ </li>
<li>enabledï¼šæ˜¯å¦å¼€æœºå¯åŠ¨ yes|no nameï¼šå¿…é€‰é¡¹ï¼ŒæœåŠ¡åç§°</li>
<li>patternï¼šå®šä¹‰ä¸€ä¸ªæ¨¡å¼ï¼Œå¦‚æœé€šè¿‡statusæŒ‡ä»¤æ¥æŸ¥çœ‹æœåŠ¡çš„çŠ¶æ€æ—¶ï¼Œæ²¡æœ‰å“åº”ï¼Œå°±ä¼šé€šè¿‡psæŒ‡ä»¤åœ¨è¿›ç¨‹ä¸­æ ¹æ®è¯¥æ¨¡å¼è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœåŒ¹é…åˆ°ï¼Œåˆ™è®¤ä¸ºè¯¥æœåŠ¡ä¾ç„¶åœ¨è¿è¡Œ</li>
<li>runlevelï¼šè¿è¡Œçº§åˆ« </li>
<li>sleepï¼šå¦‚æœæ‰§è¡Œäº†restartedï¼Œåœ¨åˆ™stopå’Œstartä¹‹é—´æ²‰ç¡å‡ ç§’é’Ÿ </li>
<li>stateï¼šå¯¹å½“å‰æœåŠ¡æ‰§è¡Œå¯åŠ¨ï¼Œåœæ­¢ã€é‡å¯ã€é‡æ–°åŠ è½½ç­‰æ“ä½œï¼ˆstarted,stopped,restarted,reloadedï¼‰ </li>
</ul>
<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ansible test -m service -<span class="selector-tag">a</span> <span class="string">"name=httpd state=started enabled=yes"</span> </div><div class="line">ansible test -m service -<span class="selector-tag">a</span> <span class="string">"name=foo pattern=/usr/bin/foo state=started"</span> </div><div class="line">ansible test -m service -<span class="selector-tag">a</span> <span class="string">"name=network state=restarted args=eth0"</span></div><div class="line">ansible cluster2:children -m service -<span class="selector-tag">a</span> <span class="string">"name=logstash pattern=/etc/init.d/logstash state=started"</span></div></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š<a href="http://www.361way.com/ansible-modules/4415.html" target="_blank" rel="external">http://www.361way.com/ansible-modules/4415.html</a></p>
<h3 id="ä¸ƒ-shell-æ¨¡å—"><a href="#ä¸ƒ-shell-æ¨¡å—" class="headerlink" title="ä¸ƒ shell æ¨¡å—"></a>ä¸ƒ shell æ¨¡å—</h3><p>è¿™é‡Œæˆ‘å†™ä¸ªä¾‹å­ï¼š</p>
<p>æ‰¹é‡æ›´æ”¹ç»„çš„æœºå™¨çš„ç”¨æˆ·åå¯†ç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">[root@salt ansible]<span class="comment"># ansible cluster1:children -m shell -a "echo "Ihaozhuo" | passwd --stdin "root" "</span></div><div class="line">10.43.59.190 | SUCCESS | rc=0 &gt;&gt;</div><div class="line">æ›´æ”¹ç”¨æˆ· root çš„å¯†ç  ã€‚</div><div class="line">passwdï¼š æ‰€æœ‰çš„èº«ä»½éªŒè¯ä»¤ç‰Œå·²ç»æˆåŠŸæ›´æ–°ã€‚</div><div class="line"></div><div class="line">10.23.2.106 | SUCCESS | rc=0 &gt;&gt;</div><div class="line">æ›´æ”¹ç”¨æˆ· root çš„å¯†ç  ã€‚</div><div class="line">passwdï¼š æ‰€æœ‰çš„èº«ä»½éªŒè¯ä»¤ç‰Œå·²ç»æˆåŠŸæ›´æ–°ã€‚</div><div class="line"></div><div class="line">10.23.232.85 | SUCCESS | rc=0 &gt;&gt;</div><div class="line">æ›´æ”¹ç”¨æˆ· root çš„å¯†ç  ã€‚</div><div class="line">passwdï¼š æ‰€æœ‰çš„èº«ä»½éªŒè¯ä»¤ç‰Œå·²ç»æˆåŠŸæ›´æ–°ã€‚</div><div class="line"></div><div class="line">10.23.232.131 | SUCCESS | rc=0 &gt;&gt;</div><div class="line">æ›´æ”¹ç”¨æˆ· root çš„å¯†ç  ã€‚</div><div class="line">passwdï¼š æ‰€æœ‰çš„èº«ä»½éªŒè¯ä»¤ç‰Œå·²ç»æˆåŠŸæ›´æ–°ã€‚</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹åˆ†ç»„ä¸Šæœºå™¨æ‰€æœ‰ç«¯å£ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">[root@salt ansible]<span class="comment"># ansible zk1:children -m shell -a "netstat -ntulp"</span></div><div class="line">10.37.238.75 | SUCCESS | rc=0 &gt;&gt;</div><div class="line">Active Internet connections (only servers)</div><div class="line">Proto Recv-Q Send-Q Local Address               Foreign Address             State       PID/Program name</div><div class="line">tcp        0      0 0.0.0.0:2181                0.0.0.0:*                   LISTEN      12497/java</div><div class="line">tcp        0      0 0.0.0.0:56521               0.0.0.0:*                   LISTEN      12497/java</div><div class="line">tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      1251/sshd</div><div class="line">tcp        0      0 0.0.0.0:4888                0.0.0.0:*                   LISTEN      12497/java</div><div class="line">tcp        0      0 127.0.0.1:15770             0.0.0.0:*                   LISTEN      1434/aegis_quartz</div><div class="line">udp        0      0 118.178.240.129:123         0.0.0.0:*                               1262/ntpd</div><div class="line">udp        0      0 10.27.238.75:123            0.0.0.0:*                               1262/ntpd</div><div class="line">udp        0      0 127.0.0.1:123               0.0.0.0:*                               1262/ntpd</div><div class="line">udp        0      0 0.0.0.0:123                 0.0.0.0:*                               1262/ntpd</div><div class="line"></div><div class="line">10.37.100.200 | SUCCESS | rc=0 &gt;&gt;</div><div class="line">Active Internet connections (only servers)</div><div class="line">Proto Recv-Q Send-Q Local Address               Foreign Address             State       PID/Program name</div><div class="line">tcp        0      0 0.0.0.0:58367               0.0.0.0:*                   LISTEN      11232/java</div><div class="line">tcp        0      0 10.47.100.200:10050         0.0.0.0:*                   LISTEN      646/zabbix_agentd</div><div class="line">tcp        0      0 0.0.0.0:2181                0.0.0.0:*                   LISTEN      11232/java</div><div class="line">tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      1243/sshd</div><div class="line">tcp        0      0 0.0.0.0:4888                0.0.0.0:*                   LISTEN      11232/java</div><div class="line">tcp        0      0 127.0.0.1:15770             0.0.0.0:*                   LISTEN      1436/aegis_quartz</div><div class="line">udp        0      0 120.27.152.77:123           0.0.0.0:*                               1254/ntpd</div><div class="line">udp        0      0 10.47.100.200:123           0.0.0.0:*                               1254/ntpd</div><div class="line">udp        0      0 127.0.0.1:123               0.0.0.0:*                               1254/ntpd</div><div class="line">udp        0      0 0.0.0.0:123                 0.0.0.0:*                               1254/ntpd</div></pre></td></tr></table></figure>
<p>shell æ¨¡å— å¯ä»¥ç”¨çš„æœ€å¤šã€‚æŸ¥çœ‹ç›®å½•æ‰§è¡Œæ–‡ä»¶ç­‰ç­‰ã€‚</p>
<p>ansibleä¿®æ”¹çº¿ä¸ŠæœåŠ¡å™¨ä¸Šçš„å¯†ç </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">ansible cluster1:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div><div class="line"></div><div class="line">ansible cluster2:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div><div class="line"></div><div class="line">ansible cluster3:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div><div class="line"></div><div class="line">ansible zk1:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div><div class="line"></div><div class="line">ansible  kafka1:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div><div class="line"></div><div class="line">ansible  es1:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div><div class="line"></div><div class="line">ansible  ihaozhuo1:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div><div class="line"></div><div class="line">ansible  monitor1:children -m shell <span class="_">-a</span> <span class="string">"echo "</span>Ihaozhuo_b3314<span class="string">" | passwd --stdin "</span>root<span class="string">" "</span></div></pre></td></tr></table></figure>
<h2 id="2ã€Ansible-æ€»ç»“ä¸¾ä¾‹å¸¸ç”¨æ¨¡å—å­¦ä¹ "><a href="#2ã€Ansible-æ€»ç»“ä¸¾ä¾‹å¸¸ç”¨æ¨¡å—å­¦ä¹ " class="headerlink" title="2ã€Ansible æ€»ç»“ä¸¾ä¾‹å¸¸ç”¨æ¨¡å—å­¦ä¹ "></a>2ã€Ansible æ€»ç»“ä¸¾ä¾‹å¸¸ç”¨æ¨¡å—å­¦ä¹ </h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible-doc <span class="_">-l</span>    <span class="comment"># åˆ—å‡º Ansible æ”¯æŒçš„æ¨¡å—</span></div><div class="line">shell &gt; ansible-doc ping  <span class="comment"># æŸ¥çœ‹è¯¥æ¨¡å—å¸®åŠ©ä¿¡æ¯</span></div></pre></td></tr></table></figure>
<blockquote>
<p>è¿œç¨‹å‘½ä»¤æ¨¡å—ï¼ˆ command / raw / script / shell ï¼‰</p>
</blockquote>
<p>command ä½œä¸º Ansible çš„é»˜è®¤æ¨¡å—ï¼Œå¯ä»¥è¿è¡Œè¿œç¨‹æƒé™èŒƒå›´æ‰€æœ‰çš„ shell å‘½ä»¤ï¼Œä¸æ”¯æŒç®¡é“ç¬¦ã€‚</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m <span class="built_in">command</span> <span class="_">-a</span> <span class="string">"free -m"</span>               <span class="comment"># æŸ¥çœ‹ Client åˆ†ç»„ä¸»æœºå†…å­˜ä½¿ç”¨æƒ…å†µ</span></div></pre></td></tr></table></figure>
<p>rawæ¨¡å— [ç±»ä¼¼äºcommandæ¨¡å—ã€æ”¯æŒç®¡é“ä¼ é€’]</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ansible Client -m raw -a <span class="string">"ifconfig eth0 |sed -n 2p |awk '&#123;print \<span class="variable">$2</span>&#125;' |awk -F: '&#123;print \<span class="variable">$2</span>&#125;'"</span></div></pre></td></tr></table></figure>
<p>script çš„åŠŸèƒ½æ˜¯åœ¨è¿œç¨‹ä¸»æœºæ‰§è¡Œä¸»æ§ç«¯å­˜å‚¨çš„ shell è„šæœ¬æ–‡ä»¶ï¼Œç›¸å½“äº scp + shell ç»„åˆã€‚</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m script <span class="_">-a</span> <span class="string">"/home/test.sh 12 34"</span>    <span class="comment"># è¿œç¨‹æ‰§è¡Œæœ¬åœ°è„šæœ¬</span></div></pre></td></tr></table></figure>
<p>shell çš„åŠŸèƒ½æ˜¯æ‰§è¡Œè¿œç¨‹ä¸»æœºä¸Šçš„ shell è„šæœ¬æ–‡ä»¶ï¼Œæ”¯æŒç®¡é“ç¬¦ã€‚</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m shell <span class="_">-a</span> <span class="string">"/home/test.sh"</span>           <span class="comment"># æ‰§è¡Œè¿œç¨‹è„šæœ¬</span></div></pre></td></tr></table></figure>
<blockquote>
<p>copy æ¨¡å—ï¼ˆå®ç°ä¸»æ§ç«¯å‘ç›®æ ‡ä¸»æœºæ‹·è´æ–‡ä»¶ï¼Œç±»ä¼¼äº scp åŠŸèƒ½ï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m copy <span class="_">-a</span> <span class="string">"src=/home/test.sh desc=/tmp/ owner=root group=root mode=0755"</span>   </div><div class="line"><span class="comment"># å‘ Client ç»„ä¸­ä¸»æœºæ‹·è´ test.sh åˆ° /tmp ä¸‹ï¼Œå±ä¸»ã€ç»„ä¸º root ï¼Œæƒé™ä¸º 0755</span></div></pre></td></tr></table></figure>
<blockquote>
<p>stat æ¨¡å—ï¼ˆè·å–è¿œç¨‹æ–‡ä»¶çŠ¶æ€ä¿¡æ¯ï¼Œatime/ctime/mtime/md5/uid/gid ç­‰ä¿¡æ¯ï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m <span class="built_in">stat</span> <span class="_">-a</span> <span class="string">"path=/etc/syctl.conf"</span></div></pre></td></tr></table></figure>
<blockquote>
<p>get_url æ¨¡å—ï¼ˆå®ç°åœ¨è¿œç¨‹ä¸»æœºä¸‹è½½æŒ‡å®š URL åˆ°æœ¬åœ°ï¼Œæ”¯æŒ sha256sum æ–‡ä»¶æ ¡éªŒï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">shell</span><span class="bash"> &gt; ansible Client -m get_utl <span class="_">-a</span> <span class="string">"url=http://www.baidu.com dest=/tmp/index.html mode=0440 force=yes"</span></span></div></pre></td></tr></table></figure>
<blockquote>
<p>yum æ¨¡å—ï¼ˆè½¯ä»¶åŒ…ç®¡ç†ï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m yum <span class="_">-a</span> <span class="string">"name=curl state=latest"</span></div></pre></td></tr></table></figure>
<blockquote>
<p>cron æ¨¡å—ï¼ˆè¿œç¨‹ä¸»æœº crontab é…ç½®ï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m cron <span class="_">-a</span> <span class="string">"name='check dirs' hour='5,2' job='ls -alh &gt; /dev/null'"</span></div><div class="line"></div><div class="line">æ•ˆæœï¼š</div><div class="line"></div><div class="line"><span class="comment"># Ansible: check dirs</span></div><div class="line">* 5,2 * * * ls -alh &gt; /dev/null</div></pre></td></tr></table></figure>
<blockquote>
<p>mount æ¨¡å—ï¼ˆè¿œç¨‹ä¸»æœºåˆ†åŒºæŒ‚è½½ï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">shell</span><span class="bash"> &gt; ansible Client -m mount <span class="_">-a</span> <span class="string">"name=/mnt/data src=/dev/sd0 fstype=ext4 opts=ro state=present"</span></span></div></pre></td></tr></table></figure>
<blockquote>
<p>service æ¨¡å—ï¼ˆè¿œç¨‹ä¸»æœºç³»ç»ŸæœåŠ¡ç®¡ç†ï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">shell</span><span class="bash"> &gt; ansible Client -m service <span class="_">-a</span> <span class="string">"name=nginx state=stoped"</span></span></div><div class="line"><span class="keyword">shell</span><span class="bash"> &gt; ansible Client -m service <span class="_">-a</span> <span class="string">"name=nginx state=restarted"</span></span></div><div class="line"><span class="keyword">shell</span><span class="bash"> &gt; ansible Client -m service <span class="_">-a</span> <span class="string">"name=nginx state=reloaded"</span></span></div></pre></td></tr></table></figure>
<blockquote>
<p>user æœåŠ¡æ¨¡å—ï¼ˆè¿œç¨‹ä¸»æœºç”¨æˆ·ç®¡ç†ï¼‰</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shell &gt; ansible Client -m user <span class="_">-a</span> <span class="string">"name=wang comment='user wang'"</span></div><div class="line">shell &gt; ansible Client -m user <span class="_">-a</span> <span class="string">"name=wang state=absent remove=yes"</span>    <span class="comment"># æ·»åŠ åˆ é™¤ç”¨æˆ·</span></div></pre></td></tr></table></figure>

	

	
		<span class="different-posts"><a href="/2016/03/09/è‡ªåŠ¨åŒ–+Jenkins/Ansible/ansibleå°ç»“(äº”)å¸¸ç”¨æ¨¡å—/" onclick="window.history.go(-1); return false;">â¬…ï¸ Go back </a></span>

	

</article>

	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<h5>Hi there,</h5>
	<p style="text-align:justify;">my name is Yancy, they know me as RadiantğŸ‘ğŸ‘. This blog is about Bi-data and my live.<br> I like ğŸŒ³ğŸŒ³ğŸŒ³</p>
</div>


	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>Â© 2017 Yancy | Powered by <a href="http://blog.yancy.cc/">Yancy</a> | Theme <a href="https://github.com/yangcvo">Yancy_GitHub</a></span>
		</div>

	</div>


</footer>



</body>

</html>
