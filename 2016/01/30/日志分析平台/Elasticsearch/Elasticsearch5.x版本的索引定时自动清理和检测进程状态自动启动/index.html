<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Elasticsearch5.xç‰ˆæœ¬çš„ç´¢å¼•å®šæ—¶è‡ªåŠ¨æ¸…ç†å’Œæ£€æµ‹è¿›ç¨‹çŠ¶æ€è‡ªåŠ¨å¯åŠ¨ | Yancy&#39;s blog</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="Yancy&#39;s blog" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link">Home</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/archives" class="header__link">ARCHIVES</a>
			
				<a href="/about/About" class="header__link">ABOUT</a>
			
				<a href="http://weibo.com/yangcvo" class="header__link">Weibo</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Yancy&#39;s blog</a></h1>
		<h2 class="header__subtitle">SIMPLICITY IS PREREQUISITE FOR  RELIABILITY</h2>
	</header>

	<main>
		<article>
	
		<h1>Elasticsearch5.xç‰ˆæœ¬çš„ç´¢å¼•å®šæ—¶è‡ªåŠ¨æ¸…ç†å’Œæ£€æµ‹è¿›ç¨‹çŠ¶æ€è‡ªåŠ¨å¯åŠ¨</h1>
	
	<div class="article__infos">
		<span class="article__date">2016-01-30</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/Log-Analysis-Platform/">Log Analysis Platform</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Elasticsearch/">Elasticsearch</a>
			</span>
		
	</div>

	

	
		<h1 id="elasticsearchçš„ç´¢å¼•å®šæ—¶è‡ªåŠ¨æ¸…ç†"><a href="#elasticsearchçš„ç´¢å¼•å®šæ—¶è‡ªåŠ¨æ¸…ç†" class="headerlink" title="elasticsearchçš„ç´¢å¼•å®šæ—¶è‡ªåŠ¨æ¸…ç†"></a>elasticsearchçš„ç´¢å¼•å®šæ—¶è‡ªåŠ¨æ¸…ç†</h1><p>ä¹‹å‰ç”¨ logstashæ¥åšæ—¥å¿—æ”¶é›† å¹¶ç”¨ elasticsearchæ¥æœç´¢ï¼Œå› ä¸ºæ—¥å¿—æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œæ²¡å‡ å¤©å°±å‘ç°elasticsearchçš„ç´¢å¼•æ–‡ä»¶å¤§çš„å“äººï¼Œä¹‹å‰è¿˜çœŸæ²¡æ¸…ç†è¿‡ã€‚å…¶å®è¦è¯´æ¸…ç†ä¹Ÿç®€å•ï¼Œç›´æ¥åˆ° elasticsearch dataæ–‡ä»¶å¤¹é‡Œåˆ æ‰å°±è¡Œäº†ï¼Œå†™ä¸ªè„šæœ¬å®šæœŸæ¸…ç†é›†ç¾¤esçš„æ—¥å¿—æ•°æ®ã€‚</p>
<p>è¿™é‡Œæˆ‘æ¸…ç†1æœˆ7å·çš„ã€‚</p>
<p>è¿™é‡Œåé¢æ˜¯ç´¢å¼•åç§°ã€‚<br>app_error-2017.01.07</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@es_01 sh]<span class="comment"># curl -XDELETE 'http://10.47.88.206:9200/app_error-2017.01.07'</span></div><div class="line">&#123;<span class="string">"acknowledged"</span>:<span class="literal">true</span>&#125;[root@es_01 sh]<span class="comment">#</span></div></pre></td></tr></table></figure>
<p>shell 7å¤©æ¸…ç†ä¸€æ¬¡æ•°æ®å†™åœ¨è®¡åˆ’ä»»åŠ¡é‡Œé¢ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"></div><div class="line">now=`date +%Y%m%d`</div><div class="line"><span class="built_in">echo</span> <span class="variable">$now</span></div><div class="line">days_07_before=`date <span class="_">-d</span> <span class="string">"<span class="variable">$now</span> 7 days ago"</span> +%Y.%m.%d`</div><div class="line"><span class="built_in">echo</span> <span class="variable">$days_07_before</span></div><div class="line">curl -XDELETE <span class="string">"http://<span class="variable">$(hostname)</span>:9200/log-spm-product-<span class="variable">$days_07_before</span>"</span>  &gt; /dev/null 2&gt;&amp;1</div><div class="line">curl -XDELETE <span class="string">"http://<span class="variable">$(hostname)</span>:9200/log-dataexport-product-<span class="variable">$days_07_before</span>"</span>  &gt; /dev/null 2&gt;&amp;1</div></pre></td></tr></table></figure>
<p>è®¡åˆ’ä»»åŠ¡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">10 0 * * * /opt/sh/logstash-null.sh</div></pre></td></tr></table></figure>
<p>å®˜ç½‘ï¼š<a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/doc-exists.html" target="_blank" rel="external">æ£€æŸ¥çŠ¶æ€æ˜¯å¦å­˜åœ¨</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">æ£€æŸ¥æ–‡æ¡£æ˜¯å¦å­˜åœ¨ç¼–è¾‘</div><div class="line">å¦‚æœåªæƒ³æ£€æŸ¥ä¸€ä¸ªæ–‡æ¡£æ˜¯å¦å­˜åœ¨ --æ ¹æœ¬ä¸æƒ³å…³å¿ƒå†…å®¹--é‚£ä¹ˆç”¨ HEAD æ–¹æ³•æ¥ä»£æ›¿ GET æ–¹æ³•ã€‚ HEAD è¯·æ±‚æ²¡æœ‰è¿”å›ä½“ï¼Œåªè¿”å›ä¸€ä¸ª HTTP è¯·æ±‚æŠ¥å¤´ï¼š</div><div class="line"></div><div class="line">curl -i -XHEAD http://localhost:9200/website/blog/123</div><div class="line">å¦‚æœæ–‡æ¡£å­˜åœ¨ï¼Œ Elasticsearch å°†è¿”å›ä¸€ä¸ª 200 ok çš„çŠ¶æ€ç ï¼š</div><div class="line"></div><div class="line">HTTP/1.1 200 OK</div><div class="line">Content-Type: text/plain; charset=UTF-8</div><div class="line">Content-Length: 0</div><div class="line">è‹¥æ–‡æ¡£ä¸å­˜åœ¨ï¼Œ Elasticsearch å°†è¿”å›ä¸€ä¸ª 404 Not Found çš„çŠ¶æ€ç ï¼š</div><div class="line"></div><div class="line">curl -i -XHEAD http://localhost:9200/website/blog/124</div><div class="line">HTTP/1.1 404 Not Found</div><div class="line">Content-Type: text/plain; charset=UTF-8</div><div class="line">Content-Length: 0</div><div class="line">å½“ç„¶ï¼Œä¸€ä¸ªæ–‡æ¡£ä»…ä»…æ˜¯åœ¨æ£€æŸ¥çš„æ—¶å€™ä¸å­˜åœ¨ï¼Œå¹¶ä¸æ„å‘³ç€ä¸€æ¯«ç§’ä¹‹åå®ƒä¹Ÿä¸å­˜åœ¨ï¼šä¹Ÿè®¸åŒæ—¶æ­£å¥½å¦ä¸€ä¸ªè¿›ç¨‹å°±åˆ›å»ºäº†è¯¥æ–‡æ¡£ã€‚</div></pre></td></tr></table></figure>
<h4 id="è‡ªåŠ¨æ£€æµ‹esç«¯å£çŠ¶æ€å¦‚ä½•ä¸å­˜åœ¨å¯åŠ¨"><a href="#è‡ªåŠ¨æ£€æµ‹esç«¯å£çŠ¶æ€å¦‚ä½•ä¸å­˜åœ¨å¯åŠ¨" class="headerlink" title="è‡ªåŠ¨æ£€æµ‹esç«¯å£çŠ¶æ€å¦‚ä½•ä¸å­˜åœ¨å¯åŠ¨"></a>è‡ªåŠ¨æ£€æµ‹esç«¯å£çŠ¶æ€å¦‚ä½•ä¸å­˜åœ¨å¯åŠ¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">vim /bin/whole51/es_poss.sh</div><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"><span class="built_in">source</span> /etc/profile</div><div class="line">curl -Is <span class="string">"10.11.10.26:9200"</span> | grep -q <span class="string">'HTTP/1.1 200 OK'</span> || su - elasticsearch -c <span class="string">"/usr/local/elasticsearch-5.5.2/bin/elasticsearch -d"</span></div><div class="line">curl -Is <span class="string">"10.11.10.26:5601"</span> | grep -q <span class="string">'HTTP/1.1 200 OK'</span> ||  /usr/<span class="built_in">local</span>/kibana-5.5.2/bin/kibana &amp;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">*/2 * * * * /bin/whole51/es.sh</div></pre></td></tr></table></figure>
<h3 id="Communicative-learning"><a href="#Communicative-learning" class="headerlink" title="Communicative learning:"></a>Communicative learning:</h3><p>ğŸ§  Linux shell_ senior operation and maintenance faction: QQ group <code>459096184</code> circle (system operation and maintenance - application operation and maintenance - automation operation and maintenance - virtualization technology research, welcome to join)<br>ğŸ§  BigData-Exchange School:QQ group <code>521621407</code> circles (big data Yun Wei) (Hadoop developer) (big data research enthusiasts) welcome to join</p>
<p>Bidata have internal WeChat exchange group, learn from each other, join QQ group has links.</p>

	

	
		<span class="different-posts"><a href="/2016/01/30/æ—¥å¿—åˆ†æå¹³å°/Elasticsearch/Elasticsearch5.xç‰ˆæœ¬çš„ç´¢å¼•å®šæ—¶è‡ªåŠ¨æ¸…ç†å’Œæ£€æµ‹è¿›ç¨‹çŠ¶æ€è‡ªåŠ¨å¯åŠ¨/" onclick="window.history.go(-1); return false;">â¬…ï¸ Go back </a></span>

	

</article>

	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<h5>Hi there,</h5>
	<p style="text-align:justify;">my name is Yancy, they know me as RadiantğŸ‘ğŸ‘. This blog is about Bi-data and my live.<br> I like ğŸŒ³ğŸŒ³ğŸŒ³</p>
</div>


	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>Â© 2018 Yancy | Powered by <a href="http://blog.yancy.cc/">Yancy</a> | Theme <a href="https://github.com/yangcvo">Yancy_GitHub</a></span>
		</div>

	</div>


</footer>



</body>

</html>
