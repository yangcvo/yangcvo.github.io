<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Ghost实现网站访问次数统计代码 · Cheng yang's Blog</title><meta name="description" content="Ghost实现网站访问次数统计代码 - yangc"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.yangcvo.me/atom.xml" title="Cheng yang's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/yangcvo" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/yangcvo" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="http://blog.yangcvo.me/2014/05/04/%E4%B8%AA%E4%BA%BA%E8%AE%B0%E5%BD%95/About-me/" target="_blank" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Ghost实现网站访问次数统计代码</h1><div class="post-info">2014年11月24日</div><div class="post-content"><p>去年自己搭建了Ghost博客，更新了没多久发现一个问题，就是界面比WordPress好看多，可是功能就唯一好点还支撑Macdown，最近看了下想让自己的博客做到统计访问次数。</p>
<p>就弄了篇文章，方便后期改进，也可以自己做参考。 </p>
<p>目前 Ghost系统并未在后台提供设置统计代码的功能，也没有提供在主题（theme）中获取统计代码的能力。现在的解决办法是在主题模板中手动添加，这就需要对模板文件做些改动，我们以 Ghost 默认的casper主题为例。</p>
<p>进入你的 Ghost 安装目录，用任何编辑器打开 <code>content/themes/casper/default.hbs</code>文件：</p>
<p>作为一个网站的管理员或者说站长，都希望知道到底有多少人访问了网站，这个时候就需要有一个统计功能来满足需要,当然功能比较单一和简单，如果想要强大的统计效果，那最好还是使用现在比较成熟的统计工具，比如站长统计或者腾讯统计等等。</p>
<h3 id="代码一："><a href="#代码一：" class="headerlink" title="代码一："></a>代码一：</h3><p>代码如下:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">var caution=false</span><br><span class="line">function setCookie(name,value,expires,path,domain,secure) </span><br><span class="line">&#123;</span><br><span class="line"> var curCookie=name+&quot;=&quot;+escape(value) +</span><br><span class="line"> ((expires)?&quot;;expires=&quot;+expires.toGMTString() : &quot;&quot;) +</span><br><span class="line"> ((path)?&quot;; path=&quot; + path : &quot;&quot;) +</span><br><span class="line"> ((domain)? &quot;; domain=&quot; + domain : &quot;&quot;) +</span><br><span class="line"> ((secure)?&quot;;secure&quot; : &quot;&quot;)</span><br><span class="line"> if(!caution||(name + &quot;=&quot; + escape(value)).length &lt;= 4000)</span><br><span class="line"> &#123;</span><br><span class="line"> document.cookie = curCookie</span><br><span class="line"> &#125;</span><br><span class="line"> else if(confirm(&quot;Cookie exceeds 4KB and will be cut!&quot;))</span><br><span class="line"> &#123;</span><br><span class="line"> document.cookie = curCookie</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">function getCookie(name) </span><br><span class="line">&#123;</span><br><span class="line"> var prefix = name + &quot;=&quot;</span><br><span class="line"> var cookieStartIndex = document.cookie.indexOf(prefix)</span><br><span class="line"> if (cookieStartIndex == -1)</span><br><span class="line"> &#123;</span><br><span class="line"> return null</span><br><span class="line"> &#125;    </span><br><span class="line"> var cookieEndIndex=document.cookie.indexOf(&quot;;&quot;,cookieStartIndex+prefix.length)</span><br><span class="line"> if(cookieEndIndex == -1)</span><br><span class="line"> &#123;</span><br><span class="line"> cookieEndIndex = document.cookie.length</span><br><span class="line"> &#125;</span><br><span class="line"> return unescape(document.cookie.substring(cookieStartIndex+prefix.length,cookieEndIndex))</span><br><span class="line">&#125;</span><br><span class="line">function deleteCookie(name, path, domain) </span><br><span class="line">&#123;</span><br><span class="line"> if(getCookie(name)) </span><br><span class="line"> &#123;</span><br><span class="line"> document.cookie = name + &quot;=&quot; + </span><br><span class="line"> ((path) ? &quot;; path=&quot; + path : &quot;&quot;) +</span><br><span class="line"> ((domain) ? &quot;; domain=&quot; + domain : &quot;&quot;) +</span><br><span class="line"> &quot;; expires=Thu, 01-Jan-70 00:00:01 GMT&quot;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">function fixDate(date) </span><br><span class="line">&#123;</span><br><span class="line"> var base=new Date(0)</span><br><span class="line"> var skew=base.getTime()</span><br><span class="line"> if(skew&gt;0)</span><br><span class="line"> &#123;</span><br><span class="line"> date.setTime(date.getTime()-skew)</span><br><span class="line"> &#125;    </span><br><span class="line">&#125;</span><br><span class="line">var now=new Date()</span><br><span class="line">fixDate(now)</span><br><span class="line">now.setTime(now.getTime()+365 * 24 * 60 * 60 * 1000)</span><br><span class="line">var visits = getCookie(&quot;counter&quot;)</span><br><span class="line">if(!visits)</span><br><span class="line">&#123;</span><br><span class="line"> visits=1;</span><br><span class="line">&#125;  </span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line"> visits=parseInt(visits)+1;</span><br><span class="line">&#125;  </span><br><span class="line">setCookie(&quot;counter&quot;, visits, now)</span><br><span class="line">document.write(&quot;您是到访的第&quot; + visits + &quot;位用户！&quot;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>插入到中间部分，设置ID 就可以调整自己首页位置。我之前是直接放到最后的，没有做太多美观调整。可以随意设置。</p>
<h3 id="代码二："><a href="#代码二：" class="headerlink" title="代码二："></a>代码二：</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">代码如下：</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">var caution=false</span><br><span class="line">function setCookie(name,value,expires,path,domain,secure) </span><br><span class="line">&#123;</span><br><span class="line"> var curCookie=name+&quot;=&quot;+escape(value) +</span><br><span class="line"> ((expires)?&quot;;expires=&quot;+expires.toGMTString() : &quot;&quot;) +</span><br><span class="line"> ((path)?&quot;; path=&quot; + path : &quot;&quot;) +</span><br><span class="line"> ((domain)? &quot;; domain=&quot; + domain : &quot;&quot;) +</span><br><span class="line"> ((secure)?&quot;;secure&quot; : &quot;&quot;)</span><br><span class="line"> if(!caution||(name + &quot;=&quot; + escape(value)).length &lt;= 4000)</span><br><span class="line"> &#123;</span><br><span class="line"> document.cookie = curCookie</span><br><span class="line"> &#125;</span><br><span class="line"> else if(confirm(&quot;Cookie exceeds 4KB and will be cut!&quot;))</span><br><span class="line"> &#123;</span><br><span class="line"> document.cookie = curCookie</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">function getCookie(name) </span><br><span class="line">&#123;</span><br><span class="line"> var prefix = name + &quot;=&quot;</span><br><span class="line"> var cookieStartIndex = document.cookie.indexOf(prefix)</span><br><span class="line"> if (cookieStartIndex == -1)</span><br><span class="line"> &#123;</span><br><span class="line"> return null</span><br><span class="line"> &#125;    </span><br><span class="line"> var cookieEndIndex=document.cookie.indexOf(&quot;;&quot;,cookieStartIndex+prefix.length)</span><br><span class="line"> if(cookieEndIndex == -1)</span><br><span class="line"> &#123;</span><br><span class="line"> cookieEndIndex = document.cookie.length</span><br><span class="line"> &#125;</span><br><span class="line"> return unescape(document.cookie.substring(cookieStartIndex+prefix.length,cookieEndIndex))</span><br><span class="line">&#125;</span><br><span class="line">function deleteCookie(name, path, domain) </span><br><span class="line">&#123;</span><br><span class="line"> if(getCookie(name)) </span><br><span class="line"> &#123;</span><br><span class="line"> document.cookie = name + &quot;=&quot; + </span><br><span class="line"> ((path) ? &quot;; path=&quot; + path : &quot;&quot;) +</span><br><span class="line"> ((domain) ? &quot;; domain=&quot; + domain : &quot;&quot;) +</span><br><span class="line"> &quot;; expires=Thu, 01-Jan-70 00:00:01 GMT&quot;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">function fixDate(date) </span><br><span class="line">&#123;</span><br><span class="line"> var base=new Date(0)</span><br><span class="line"> var skew=base.getTime()</span><br><span class="line"> if(skew&gt;0)</span><br><span class="line"> &#123;</span><br><span class="line"> date.setTime(date.getTime()-skew)</span><br><span class="line"> &#125;    </span><br><span class="line">&#125;</span><br><span class="line">var now=new Date()</span><br><span class="line">fixDate(now)</span><br><span class="line">now.setTime(now.getTime()+365 * 24 * 60 * 60 * 1000)</span><br><span class="line">var visits = getCookie(&quot;counter&quot;)</span><br><span class="line">if(!visits)</span><br><span class="line">&#123;</span><br><span class="line"> visits=1;</span><br><span class="line">&#125;  </span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line"> visits=parseInt(visits)+1;</span><br><span class="line">&#125;  </span><br><span class="line">setCookie(&quot;counter&quot;, visits, now)</span><br><span class="line">document.write(&quot;您是到访的第&quot; + visits + &quot;位用户！&quot;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>以上通过两种方式实现JavaScript统计网站访问量的代码，希望对大家有所帮助。</p>
<p>需要的留言给我，现在博客更新了，所以效果图看不到。 </p>
</div></article></div></section><footer><div class="paginator"><a href="/2014/11/24/Zimbra/zimbra邮件系统的环境部署/" class="prev">PREV</a><a href="/2014/11/20/Ghost/Ghost增加Disqus评论组件/" class="next">NEXT</a></div><div data-thread-key="2014/11/24/Ghost/Ghost实现网站访问次数统计代码/" data-title="Ghost实现网站访问次数统计代码" data-url="http://blog.yangcvo.me/2014/11/24/Ghost/Ghost实现网站访问次数统计代码/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"true"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2014 - 2016 <a href="http://blog.yangcvo.me">yangc</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yangcvo" target="_blank">Github-yangcvo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>