<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>zabbixç›‘æ§MySQL-æ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹ | Yancy&#39;s blog</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="Yancy&#39;s blog" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link">Home</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/archives" class="header__link">ARCHIVES</a>
			
				<a href="/about/About" class="header__link">ABOUT</a>
			
				<a href="http://weibo.com/yangcvo" class="header__link">Weibo</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Yancy&#39;s blog</a></h1>
		<h2 class="header__subtitle">SIMPLICITY IS PREREQUISITE FOR  RELIABILITY</h2>
	</header>

	<main>
		<article>
	
		<h1>zabbixç›‘æ§MySQL-æ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹</h1>
	
	<div class="article__infos">
		<span class="article__date">2014-09-29</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/monitoring/">monitoring</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/Zabbix-monitoring/">Zabbix monitoring</a>
			</span>
		
	</div>

	

	
		<h2 id="zabbixç›‘æ§MySQL"><a href="#zabbixç›‘æ§MySQL" class="headerlink" title="zabbixç›‘æ§MySQL"></a>zabbixç›‘æ§MySQL</h2><p>å‰é¢ä¸€äº›ç®€å•çš„å·²åœ¨ä¸Šä¸€ç¯‡æ–‡ç« å¤§æ¦‚è®²äº†zabbixåŸç†å’Œä½¿ç”¨å®‰è£…æ–¹æ³•ç­‰ç­‰ã€‚<br>åœ¨Zabbixçš„ç›‘æ§ç³»ç»Ÿä¸­é€šå¸¸æ˜¯ç”±Zabbix Serverä¸Zabbix Agentä¸€èµ·é…åˆå®ç°ç›‘æ§ã€‚åœ¨Zabbix Agentå†…ç½®äº†å¾ˆå¤šç›‘æ§åŸºç¡€çš„ç›‘æ§é¡¹ã€‚<a href="https://www.zabbix.com/documentation/2.0/manual/config/items/itemtypes/zabbix_agent" target="_blank" rel="external">å‚è§</a></p>
<p>è¿™äº›ç›‘æ§é¡¹éƒ½æ˜¯CPU, æ–‡ä»¶ç³»ç»Ÿ, ç½‘ç»œï¼Œç£ç›˜ç­‰åŸºç¡€çš„ç›‘æ§é¡¹ï¼Œå¯¹äºè‡ªå·±å¼€å‘æœåŠ¡çš„ç›‘æ§ï¼ŒZabbixæä¾›äº†è‰¯å¥½æ¡†æ¶ä¸ºç”¨æˆ·å®ç°ç›‘æ§å’ŒæŠ¥è­¦ï¼Œä¸‹é¢å°†ä»¥ä¸ºMySQLæ·»åŠ ç›‘æ§ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰ç›‘æ§ã€‚</p>
<h3 id="å®éªŒç¯å¢ƒ"><a href="#å®éªŒç¯å¢ƒ" class="headerlink" title="å®éªŒç¯å¢ƒ"></a>å®éªŒç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">MySQL æ˜¯åˆ†å¼€å®‰è£…çš„ ï¼š192.168.1.201</div><div class="line">zabbix server ç«¯ ï¼š192.168.1.220</div></pre></td></tr></table></figure>
<h3 id="è§’è‰²ï¼šZabbix-Agent-Zabbix-Server-MySQL-æ¨¡æ¿"><a href="#è§’è‰²ï¼šZabbix-Agent-Zabbix-Server-MySQL-æ¨¡æ¿" class="headerlink" title="è§’è‰²ï¼šZabbix Agent, Zabbix Server, MySQL, æ¨¡æ¿"></a>è§’è‰²ï¼šZabbix Agent, Zabbix Server, MySQL, æ¨¡æ¿</h3><h3 id="ç¬¬ä¸€æ­¥ï¼Œç›‘æ§è§„åˆ’"><a href="#ç¬¬ä¸€æ­¥ï¼Œç›‘æ§è§„åˆ’" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼Œç›‘æ§è§„åˆ’"></a>ç¬¬ä¸€æ­¥ï¼Œç›‘æ§è§„åˆ’</h3><p>åœ¨åˆ›å»ºç›‘æ§é¡¹ä¹‹å‰è¦å°½é‡è€ƒè™‘æ¸…æ¥šè¦ç›‘æ§ä»€ä¹ˆï¼Œæ€ä¹ˆç›‘æ§ï¼Œç›‘æ§æ•°æ®å¦‚ä½•å­˜å‚¨ï¼Œç›‘æ§æ•°æ®å¦‚ä½•å±•ç°ï¼Œå¦‚ä½•å¤„ç†æŠ¥è­¦ç­‰ã€‚è¦è¿›è¡Œç›‘æ§çš„ç³»ç»Ÿè§„åˆ’éœ€è¦å¯¹Zabbixå¾ˆäº†è§£ï¼Œè¿™é‡Œåªæ˜¯æå‡ºç›‘æ§çš„éœ€æ±‚ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">éœ€æ±‚ä¸€ï¼šç›‘æ§MySQLçš„çŠ¶æ€ï¼Œå½“çŠ¶æ€å‘ç”Ÿå¼‚å¸¸ï¼Œå‘å‡ºæŠ¥è­¦ï¼›</div><div class="line">éœ€æ±‚äºŒï¼šç›‘æ§MySQLçš„æ“ä½œï¼Œå¹¶ç”¨å›¾è¡¨å±•ç°ï¼›</div><div class="line">ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬ç›‘æ§æ‰©å±•Agentã€‚</div></pre></td></tr></table></figure>
<p>Zabbix Serverä¸Agentä¹‹é—´ç›‘æ§æ•°æ®çš„é‡‡é›†ä¸»è¦æ˜¯é€šè¿‡Zabbix Serverä¸»åŠ¨å‘Agentè¯¢é—®æŸä¸ªKeyçš„å€¼ï¼ŒAgentä¼šæ ¹æ®Keyå»è°ƒç”¨ç›¸åº”çš„å‡½æ•°å»è·å–è¿™ä¸ªå€¼å¹¶è¿”å›ç»™Serverç«¯ã€‚Zabbix 2.4.7çš„Agentæœ¬å¹¶æ²¡æœ‰å†…ç½®MySQLçš„ç›‘æ§åŠŸèƒ½ï¼ˆä½†æ˜¯Serverç«¯æä¾›äº†ç›¸åº”çš„Templateé…ç½®ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨Zabbixçš„User ParametersåŠŸèƒ½ï¼Œä¸ºMySQLæ·»åŠ ç›‘æ§è„šæœ¬ã€‚</p>
<h3 id="Trapperå·¥ä½œåŸç†"><a href="#Trapperå·¥ä½œåŸç†" class="headerlink" title="Trapperå·¥ä½œåŸç†:"></a>Trapperå·¥ä½œåŸç†:</h3><p>è¢«ç›‘æ§ä¸»æœºæ ¹æ®ç”¨æˆ·è®¾å®šçš„æ—¶é—´é—´éš”å®šæœŸå°†æ•°æ®pushåˆ°Zabbix Server.è¿™é‡Œä¸»è¦ä»‹ç»Agent.</p>
<h3 id="Agentå·¥ä½œåŸç†"><a href="#Agentå·¥ä½œåŸç†" class="headerlink" title="Agentå·¥ä½œåŸç†:"></a>Agentå·¥ä½œåŸç†:</h3><ul>
<li>Agent å®‰è£…åœ¨è¢«ç›‘æ§ä¸»æœºä¸Šï¼Œå®šæœŸä¸»åŠ¨çš„ç›‘æ§æœ¬æœºçš„èµ„æºå’Œåº”ç”¨,ç„¶åå°†æ•°æ®è¿›è¡Œå¤„ç†å‘é€ç»™ZabbixServer. Agentå·¥ä½œæ–¹å¼åˆåˆ†ä¸ºPassive Check å’Œ Active Checkã€‚</li>
<li>Passive Check: Zabbix Server å‘èµ·æ•°æ®ç´¢å–è¯·æ±‚ï¼ŒAgentå“åº”å¯¹åº”çš„æ•°æ®.</li>
<li>Active Check: Agenté¦–å…ˆä»Zabbix Server æ£€ç´¢ç›‘æ§é¡¹åˆ—è¡¨,ç„¶åå®šæœŸå°†å¯¹åº”çš„æ•°æ®ä¸»åŠ¨çš„å‘é€åˆ°.Zabbix ServerZabbix Agent æœ¬èº«é¢„å®šä¹‰äº†ä¸€äº›ç›‘æ§ç±»å‹,è€Œå¯¹äºæ²¡æœ‰é¢„å®šä¹‰çš„éœ€è¦ç®¡ç†å‘˜è‡ªè¡Œå®šä¹‰.å› æ­¤ï¼ŒZabbixæä¾›äº†â€UserParameterâ€å‚æ•°,ä»¥æ–¹ä¾¿ç”¨æˆ·æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªå®šä¹‰æƒ³è¦è·å–çš„æ•°æ®.</li>
</ul>
<h3 id="â€œUserParameterâ€-è¯­æ³•"><a href="#â€œUserParameterâ€-è¯­æ³•" class="headerlink" title="â€œUserParameterâ€ è¯­æ³•:"></a>â€œUserParameterâ€ è¯­æ³•:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UserParameter=&lt;key&gt;,&lt;<span class="built_in">command</span>&gt;</div></pre></td></tr></table></figure>
<p><key> ç”¨æˆ·è‡ªå®šä¹‰ä¸€ä¸ªkey; <command>ä¸ºå‘½ä»¤ï¼Œè¯¥å‘½ä»¤ç”¨æ¥è·å–ç”¨æˆ·æƒ³è¦ç›‘æ§çš„æ•°æ®,ä¹Ÿå°±æ˜¯keyçš„å€¼;<br>å®šå¥½UserParameterå‚æ•°åï¼Œåœ¨ä¸ºä¸»æœºæˆ–è€…æ¨¡æ¿é…ç½®ç›‘æ§é¡¹çš„æ—¶å€™ï¼Œåœ¨â€keyâ€ä¸­è¾“å…¥ä¸Šé¢è‡ªå®šä¹‰çš„keyçš„<br>åå­—å°±å¯ä»¥äº†.</key></p>
<p>å‡å¦‚æˆ‘è¦è·å–Mysql Serverçš„ç‰ˆæœ¬ï¼Œæˆ‘å¯ä»¥è¿™æ ·å®šä¹‰â€UserParameterâ€:<br>æ‰“å¼€ Zabbix Agentå®‰è£…è·¯å¾„ä¸‹çš„ ../etc/zabbix_agentd.conf é…ç½®æ–‡ä»¶ï¼Œç¿»é¡µåˆ°æœ€åé¡µé¢ï¼Œé”®å…¥å¦‚ä¸‹<br>è¡Œ:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UserParameter=mysql.version,mysql -V</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬è‡ªå®šä¹‰çš„keyåå°±æ˜¯<code>&quot;mysql.version&quot;</code>,å‘½ä»¤<code>&quot;mysql -V&quot;</code>ç”¨æ¥è·å–Mysql ç‰ˆæœ¬å·,å…¶å®å°±æ˜¯keyå¯¹<br>åº”çš„å€¼.</p>
<p>UserParameterå‚æ•°å®ç°çš„åŸç†é€šä¿—æ¥è®²ï¼Œå°±æ˜¯æˆ‘ä»¬å…ˆè¦ç†Ÿæ‚‰Mysqlå‘½ä»¤ï¼Œé€šè¿‡Mysqlçš„å‘½ä»¤è·å–æƒ³è¦çš„<br>æ•°æ®ï¼Œç„¶åèµ‹å€¼ç»™è‡ªå®šä¹‰çš„keyï¼Œæœ€åé€šè¿‡Zabbix Serverè·å–è¿™ä¸ªå€¼é€šè¿‡å›¾åƒç­‰æ–¹å¼å±•ç¤ºå‡ºæ¥.</p>
<p>ä¸‹é¢åˆ©ç”¨Agentæ¥å®ç°å¯¹mysqlæ€§èƒ½çš„ç›‘æ§ã€‚</p>
<h3 id="agentç«¯ï¼š"><a href="#agentç«¯ï¼š" class="headerlink" title="agentç«¯ï¼š"></a>agentç«¯ï¼š</h3><p>1.åˆ©ç”¨UserParameterå‚æ•°è‡ªå®šä¹‰Agent Keyã€‚<br>å¯¹äºéœ€æ±‚ä¸€ ï¼Œæˆ‘ä»¬é‡‡ç”¨mysqladminè¿™ä¸ªå·¥å…·æ¥å®ç°ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@mysql ~]<span class="comment"># mysqladmin -h 192.168.1.201 -uroot -ppassword ping</span></div><div class="line">mysqld is alive</div></pre></td></tr></table></figure>
<p>å¦‚æœMySQLçŠ¶æ€æ­£å¸¸ï¼Œä¼šæ˜¾ç¤ºmysqld is aliveï¼Œå¦åˆ™ä¼šæç¤ºè¿æ¥ä¸ä¸Šã€‚å¯¹äºæœåŠ¡å™¨ç«¯ï¼Œmysqld is aliveè¿™æ ·çš„å¥å­ä¸å¥½ç†è§£ï¼ŒæœåŠ¡å™¨ç«¯æœ€å¥½åªæ¥æ”¶1å’Œ0ï¼Œ1è¡¨ç¤ºæœåŠ¡å¯ç”¨ï¼Œ0è¡¨ç¤ºæœåŠ¡ä¸å¯ç”¨ã€‚é‚£ä¹ˆå†æ”¹è¿›ä¸€ä¸‹è¿™ä¸ªå‘½ä»¤ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@mysql ~]<span class="comment"># mysqladmin -h 192.168.1.201 -uroot -ppassword ping |  grep -c alive</span></div><div class="line">1</div></pre></td></tr></table></figure>
<p>ç”¨æˆ·åå’Œå¯†ç æ”¾åœ¨å‘½ä»¤ä¸­å¯¹äºä»¥åçš„ç»´æŠ¤ä¸å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨/var/lib/zabbix/ä¸‹åˆ›å»ºä¸€ä¸ªåŒ…å«MySQLç”¨æˆ·åå’Œå¯†ç çš„é…ç½®æ–‡ä»¶â€œ.my.cnfâ€ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[client]</div><div class="line">user=root</div><div class="line">host=192.168.1.201</div><div class="line">password=xxxx</div></pre></td></tr></table></figure>
<p>æœ‰äº†è¿™ä¸ªæ–‡ä»¶åçš„å‘½ä»¤å˜æ›´ä¸º</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">HOME=/etc mysqladmin ping | grep -c alive</div><div class="line">[root@mysql ~]<span class="comment">#   HOME=/var/lib/zabbix/ mysqladmin ping | grep -c alive</span></div><div class="line">1</div></pre></td></tr></table></figure>
<p>åšå®Œè¿™ä¸€æ­¥åéœ€è¦åšçš„å°±æ˜¯ï¼Œå°†è¿™ä¸ªç›‘æ§å‘½ä»¤æ·»åŠ åˆ°Zabbix Agentä¸­ï¼Œå¹¶ä¸ä¸€ä¸ªKeyå¯¹åº”ï¼Œè¿™æ ·Zabbox Serverå°±èƒ½é€šè¿‡è¿™ä¸ªKeyè·å–MySQLçš„çŠ¶æ€äº†ã€‚æˆ‘ä»¬ä½¿ç”¨mysql.pingä½œä¸ºMySQLçŠ¶æ€çš„Keyã€‚</p>
<p>é¦–å…ˆåœ¨å»é™¤/etc/zabbix/zabbix_agentd.confä¸­</p>
<p>â€œInclude=/etc/zabbix_agentd.conf.d/â€è¿™ä¸€è¡Œçš„æ³¨é‡Šç¬¦ã€‚</p>
<p>å…¶æ¬¡ï¼Œåœ¨etc/zabbix/zabbix_agentd.conf.d/ç›®å½•ä¸‹åˆ›å»ºuserparameter_mysql.confæ–‡ä»¶ã€‚åœ¨æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<pre><code>UserParameter=mysql.ping,HOME=/var/lib/zabbix mysqladmin ping | grep -c alive
</code></pre><p>è¿™ä¸ªå‘½ä»¤ä¸­â€UserParameterâ€è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„è„šæœ¬ï¼›â€œ=â€å·åæ˜¯è„šæœ¬çš„å†…å®¹ï¼›â€œmysql.pingâ€æ˜¯Keyï¼Œâ€œï¼Œâ€å·åçš„å‘½ä»¤ä¼šåœ¨Zabbix Serverå‘Agentå‘èµ·è·å–â€œmysql.pingâ€è¿™ä¸ªkeyçš„è¯·æ±‚æ—¶è¢«è°ƒç”¨ï¼Œå¹¶å°†è¿”å›å€¼è¿”å›ç»™Serverã€‚<br>ä¿å­˜å¹¶é€€å‡ºåå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æµ‹è¯•æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
<pre><code>[root@mysql ~]# /usr/sbin/zabbix_agentd -t mysql.ping
  mysql.ping                                    [t|1]
</code></pre><p>è¿™é‡Œzabbix_agentdä½¿ç”¨æ–¹æ³•å¯å‚è€ƒï¼š</p>
<pre><code>http://www.ttlsa.com/zabbix/zabbix-command-zabbix_agentd/
</code></pre><p>åŒæ—¶ï¼Œåœ¨Serverç«¯ä¹Ÿå¯ä»¥ä½¿ç”¨ä½¿ç”¨zabbix_getå‘½ä»¤æ¥æµ‹è¯•ä»Serverç«¯è·å–æŒ‡å®šçš„Clientç«¯çš„æ•°æ®ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ zabbix_get <span class="_">-s</span> 192.168.1.201 -p 10050 -k mysql.ping</div><div class="line">1</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¦‚æœæ˜¯è·Ÿæˆ‘ä¸€å¼€å§‹æœ‰é”™è¯¯çš„ã€‚<a href="https://www.zabbix.com/documentation/3.0/manual/config/items/userparameters/extending_agent" target="_blank" rel="external">zabbix</a></p>
<p>å¯èƒ½è·Ÿä½ å®‰è£…ç‰ˆæœ¬ä¸ç»Ÿä¸€æœ‰é—®é¢˜ã€‚</p>
<p>è¿™é‡Œzabbix_getä½¿ç”¨æ–¹æ³•å¯å‚è€ƒ: <a href="http://www.ttlsa.com/zabbix/zabbix-zabbix_get-get-items/" target="_blank" rel="external">zabbix_agent</a></p>
<p>æˆ‘è¿™é‡Œå‚è€ƒå®˜ç½‘æ–¹æ³•ï¼š</p>
<pre><code>https://www.zabbix.com/documentation/3.0/manual/config/items/userparameters/extending_agent
</code></pre><p>æˆ‘åœ¨æˆ‘è¿™é‡ŒæŸ¥çœ‹MySQLçŠ¶æ€zabbix_agentd.conf:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UserParameter=mysql.questions,mysqladmin -uroot status | cut <span class="_">-f</span>4 <span class="_">-d</span><span class="string">":"</span> | cut <span class="_">-f</span>1 <span class="_">-d</span><span class="string">"S"</span></div></pre></td></tr></table></figure>
<h3 id="MySQLæœºå™¨ä¸Šé¢æŸ¥çœ‹æ˜¯æœ‰æ•°æ®çš„ï¼š"><a href="#MySQLæœºå™¨ä¸Šé¢æŸ¥çœ‹æ˜¯æœ‰æ•°æ®çš„ï¼š" class="headerlink" title="MySQLæœºå™¨ä¸Šé¢æŸ¥çœ‹æ˜¯æœ‰æ•°æ®çš„ï¼š"></a>MySQLæœºå™¨ä¸Šé¢æŸ¥çœ‹æ˜¯æœ‰æ•°æ®çš„ï¼š</h3><pre><code>[root@mysql scripts]# zabbix_agentd -t mysql.questions
 mysql.questions                               [t| 22273707]
</code></pre><h3 id="zabbix-serverç«¯ï¼š"><a href="#zabbix-serverç«¯ï¼š" class="headerlink" title="zabbix serverç«¯ï¼š"></a>zabbix serverç«¯ï¼š</h3><pre><code>[root@LAN_zabbix ~]# /usr/local/zabbix/bin/zabbix_get -s 192.168.1.201 -p10050 -k &apos;mysql.questions&apos;
ZBX_NOTSUPPORTED: Unsupported item key.
</code></pre><p>æç¤ºZBX_NOTSUPPORTED: Unsupported item key.</p>
<p>å¦‚æœç›´æ¥æŸ¥çœ‹å®šä¹‰çš„ç³»ç»Ÿcpu</p>
<pre><code>[root@LAN_zabbix ~]# /usr/local/zabbix/bin/zabbix_get -s 192.168.1.201 -p   10050 -k system.cpu.load[all,avg1]
0.350000
</code></pre><p>è¿™æ ·æ˜¯æœ‰æ•°æ®çš„ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥åˆ¤æ–­ä¸Šé¢é‚£ä¸ªæç¤ºZBX_NOTSUPPORTED: Unsupported item key.</p>
<h3 id="æœåŠ¡ç«¯æµ‹è¯•å¯èƒ½æŠ¥å„ç±»é”™è¯¯ï¼š"><a href="#æœåŠ¡ç«¯æµ‹è¯•å¯èƒ½æŠ¥å„ç±»é”™è¯¯ï¼š" class="headerlink" title="æœåŠ¡ç«¯æµ‹è¯•å¯èƒ½æŠ¥å„ç±»é”™è¯¯ï¼š"></a>æœåŠ¡ç«¯æµ‹è¯•å¯èƒ½æŠ¥å„ç±»é”™è¯¯ï¼š</h3><ol>
<li>ZBX_NOTSUPPORTED: Unsupported item key</li>
</ol>
<p>ç¡®è®¤keyåå­—é…å¯¹äº†ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯è¦é‡å¯</p>
<p>2.[root@zabbix zabbix]# zabbix_get -s 192.168.9.251 -k mysql.Innodb_log_buffer_size<br>sh: mysql: command not found<br>åŠ å…¨è·¯å¾„ï¼š/mysql/bin/mysql</p>
<p>æˆ‘è¯•ç€ä¿®æ”¹äº†/etc/zabbix/zabbix_agentd.d/userparameter_mysql.conf è¿™ä¸ªæ–‡ä»¶é‡Œâ€HOME=/var/lib/zabbix mysql -Nâ€ï¼ŒæŠŠmysqlçš„è·¯å¾„è¡¥å…¨ï¼Œå³æ”¹ä¸ºHOME=/etc/zabbix /usr/bin/mysql -Nã€‚æˆ‘æ˜¯æ”¹äº†è¿™ä¸ªå°±å¯ä»¥äº†</p>
<pre><code>serverç«¯ï¼š /usr/local/zabbix/bin/zabbix_get -s 192.168.1.201  /usr/bin/mysqladmin -k  mysql.questions
sh: mysqladmin: æœªæ‰¾åˆ°å‘½ä»¤
</code></pre><p>åŠ äº†ç»å¯¹è·¯å¾„ï¼Œæˆ‘å‡ ä¹è¦ç»æœ›äº†ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆå‘,åæ¥æˆ‘çœ‹äº†ä¸‹ï¼Œæ˜¯æˆ‘seLinuxæ²¡æœ‰å…³é—­ã€‚å…³é—­å°±å¯ä»¥äº†ã€‚</p>
<ul>
<li>æˆ‘å‚è€ƒè¿™ç¯‡æ–‡ç« æ“ä½œçš„ï¼š<a href="http://canghai.coding.io/2015/07/29/monitoring-mysql-with-zabbix/" target="_blank" rel="external">monitoring-mysql-with-zabbix</a></li>
</ul>
<p>å¦‚æœæœ‰ä¸€ä¸‹å›æ˜¾ï¼Œè¡¨ç¤ºå·¥ä½œæ­£å¸¸</p>
<pre><code>[root@zabbix ~]#  /usr/local/bin/zabbix_get -s 192.168.1.201 -k   mysql.status[GlobalStatus,Uptime]
 12364726
</code></pre><p>ç„¶åä¸‹è½½å®‰è£…MySQLç›‘æ§çš„æ¨¡æ¿åœ¨æˆ‘githubä¸Šé¢ï¼š</p>
<p>å¯¼å…¥æ¨¡ç‰ˆï¼š<a href="https://github.com/yangcvo/zabbix.2.4/" target="_blank" rel="external">MySQLç›‘æ§çš„æ¨¡æ¿</a></p>
<p>å¹¶å…³è”åˆ°ä¸»æœº</p>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/zabbix-monitoring.jpg" alt=""></figure></p>
<p>PSï¼šå¯è‡ªè¡Œæ·»åŠ å¯¹åº”keyå¯ç›‘æ§é¡¹ç›®ï¼Œæ¨¡ç‰ˆè‡ªå¸¦äº†å‡ ç§ï¼Œè„šæœ¬åŒ…æ‹¬800å¤šé¡¹ç›®ï¼Œ<br><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/zabbix-mintor.jpg" alt=""></figure><br>ç„¶ååœ¨æ·»åŠ å„è‡ªé¡¹ç›®çš„å›¾è¡Œï¼š</p>
<p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/zabbix-moin1.jpg" alt=""></figure></p>
<p>zabbixç›‘æ§mysqlæ€§èƒ½<br>é€šè¿‡è·å–mysqlçŠ¶æ€å€¼å°†è¿™äº›çŠ¶æ€å€¼ä¼ é€’ç»™æœåŠ¡å™¨å¹¶ç»˜åˆ¶æˆå›¾ç‰‡ï¼Œè¿™æ ·å¯ä»¥è§‚å¯Ÿmysqlçš„å·¥ä½œæƒ…å†µï¼Œé€šå¸¸éœ€è¦è·å¾—çŠ¶æ€å˜é‡æœ‰ä»¥ä¸‹</p>
<pre><code>Com_updateï¼šmysqlæ‰§è¡Œçš„æ›´æ–°ä¸ªæ•°
Com_selectï¼šmysqlæ‰§è¡Œçš„æŸ¥è¯¢ä¸ªæ•°
Com_insertï¼šmysqlæ‰§è¡Œæ’å…¥çš„ä¸ªæ•°
Com_deleteï¼šæ‰§è¡Œåˆ é™¤çš„ä¸ªæ•°
Com_rollbackï¼šæ‰§è¡Œå›æ»šçš„æ“ä½œä¸ªæ•°
Bytes_received:æ¥å—çš„å­—èŠ‚æ•°
Bytes_sentï¼šå‘é€çš„å­—èŠ‚æ•°
Slow_queriesï¼šæ…¢æŸ¥è¯¢è¯­å¥çš„ä¸ªæ•°
</code></pre><p><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/zabbix-mion2.png" alt=""></figure></p>
<p>æŸ¥çœ‹å›¾åƒéƒ½æ˜¯æœ‰æ•°æ®ï¼š<br><figure class="figure"><img src="http://7xrthw.com1.z0.glb.clouddn.com/zabbix-mion3.png" alt=""></figure></p>
<p>   2)æˆ‘è¿™é‡Œæ˜¯æµ‹è¯•ç¯å¢ƒç”¨rootè´¦å·ï¼Œçº¿ä¸ŠæœåŠ¡å™¨å®‰å…¨æœŸé—´å¯ä»¥ç»™mysqlç”¨æˆ·æˆæƒreadonlyæƒé™ã€‚</p>
<p>   3)æ ¹æ®å®é™…çš„éœ€æ±‚ï¼Œé™¤äº†ç›‘æ§ä¸Šè¿°ç›‘æ§é¡¹ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç›‘æ§mysql processlist,Innodbç­‰ã€‚</p>

	

	
		<span class="different-posts"><a href="/2014/09/29/æ€§èƒ½ç›‘æ§/Zabbix/zabbixç›‘æ§MySQL-æ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹/" onclick="window.history.go(-1); return false;">â¬…ï¸ Go back </a></span>

	

</article>

	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<h5>Hi there,</h5>
	<p style="text-align:justify;">my name is Yancy, they know me as RadiantğŸ‘ğŸ‘. This blog is about Bi-data and my live.<br> I like ğŸŒ³ğŸŒ³ğŸŒ³</p>
</div>


	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>Â© 2017 Yancy | Powered by <a href="http://weblog.chengyangyang.com/">Yancy</a> | Theme <a href="https://github.com/yangcvo">Yancy_GitHub</a></span>
		</div>

	</div>


</footer>



</body>

</html>
